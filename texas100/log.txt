federated | INFO flwr 2024-11-02 19:09:04,095 | app.py:219 | Starting Flower simulation, config: num_rounds=10, no round_timeout
federated | INFO flwr 2024-11-02 19:09:06,626 | app.py:242 | Flower VCE: Ray initialized with resources: {'node:__internal_head__': 1.0, 'GPU': 1.0, 'memory': 5875346637.0, 'object_store_memory': 2147483648.0, 'node:127.0.0.1': 1.0, 'CPU': 8.0}
federated | INFO flwr 2024-11-02 19:09:06,626 | app.py:248 | Optimize your simulation with Flower VCE: https://flower.ai/docs/framework/how-to-run-simulations.html
federated | INFO flwr 2024-11-02 19:09:06,626 | app.py:271 | Flower VCE: Resources for each Virtual Client: {'num_cpus': 1, 'num_gpus': 0.2}
federated | INFO flwr 2024-11-02 19:09:06,642 | app.py:317 | Flower VCE: Creating VirtualClientEngineActorPool with 5 actors
federated | INFO flwr 2024-11-02 19:09:06,642 | server.py:92 | [INIT]
federated | INFO flwr 2024-11-02 19:09:06,643 | server.py:281 | Requesting initial parameters from one random client
federated | INFO flwr 2024-11-02 19:09:24,327 | server.py:288 | Received initial parameters from one random client
federated | INFO flwr 2024-11-02 19:09:24,328 | server.py:94 | Starting evaluation of initial global parameters
federated | INFO flwr 2024-11-02 19:09:28,166 | fresh copy.py:181 | Round 0 - Centralized evaluation accuracy: 0.010133333333333333, loss: 4.6051896250406905
federated | INFO flwr 2024-11-02 19:09:28,168 | server.py:97 | initial parameters (loss, other metrics): 4.6051896250406905, {'accuracy': 0.010133333333333333}
federated | INFO flwr 2024-11-02 19:09:28,168 | server.py:112 | 
federated | INFO flwr 2024-11-02 19:09:28,168 | server.py:113 | [ROUND 1]
federated | INFO flwr 2024-11-02 19:09:28,169 | server.py:226 | configure_fit: strategy sampled 5 clients (out of 5)
federated | INFO flwr 2024-11-02 19:43:52,498 | server.py:240 | aggregate_fit: received 5 results and 0 failures
federated | WARNING flwr 2024-11-02 19:43:52,571 | fedavg.py:252 | No fit_metrics_aggregation_fn provided
federated | INFO flwr 2024-11-02 19:43:56,254 | fresh copy.py:181 | Round 1 - Centralized evaluation accuracy: 0.2823333333333333, loss: 4.420942883046468
federated | INFO flwr 2024-11-02 19:43:56,255 | server.py:131 | fit progress: (1, 4.420942883046468, {'accuracy': 0.2823333333333333}, 2068.0800763749867)
federated | INFO flwr 2024-11-02 19:43:56,255 | server.py:178 | configure_evaluate: strategy sampled 5 clients (out of 5)
federated | INFO flwr 2024-11-02 19:45:47,569 | server.py:192 | aggregate_evaluate: received 5 results and 0 failures
federated | WARNING flwr 2024-11-02 19:45:47,570 | fedavg.py:283 | No evaluate_metrics_aggregation_fn provided
federated | INFO flwr 2024-11-02 19:45:47,570 | server.py:112 | 
federated | INFO flwr 2024-11-02 19:45:47,571 | server.py:113 | [ROUND 2]
federated | INFO flwr 2024-11-02 19:45:47,571 | server.py:226 | configure_fit: strategy sampled 5 clients (out of 5)
federated | INFO flwr 2024-11-02 20:18:42,717 | server.py:240 | aggregate_fit: received 5 results and 0 failures
federated | INFO flwr 2024-11-02 20:18:46,840 | fresh copy.py:181 | Round 2 - Centralized evaluation accuracy: 0.5866, loss: 4.0357920331319175
federated | INFO flwr 2024-11-02 20:18:46,842 | server.py:131 | fit progress: (2, 4.0357920331319175, {'accuracy': 0.5866}, 4158.669018624991)
federated | INFO flwr 2024-11-02 20:18:46,842 | server.py:178 | configure_evaluate: strategy sampled 5 clients (out of 5)
federated | INFO flwr 2024-11-02 20:20:34,027 | server.py:192 | aggregate_evaluate: received 5 results and 0 failures
federated | INFO flwr 2024-11-02 20:20:34,028 | server.py:112 | 
federated | INFO flwr 2024-11-02 20:20:34,028 | server.py:113 | [ROUND 3]
federated | INFO flwr 2024-11-02 20:20:34,029 | server.py:226 | configure_fit: strategy sampled 5 clients (out of 5)
federated | INFO flwr 2024-11-02 20:53:49,379 | server.py:240 | aggregate_fit: received 5 results and 0 failures
federated | INFO flwr 2024-11-02 20:53:53,420 | fresh copy.py:181 | Round 3 - Centralized evaluation accuracy: 0.6002, loss: 4.022123151397705
federated | INFO flwr 2024-11-02 20:53:53,421 | server.py:131 | fit progress: (3, 4.022123151397705, {'accuracy': 0.6002}, 6265.251286417013)
federated | INFO flwr 2024-11-02 20:53:53,421 | server.py:178 | configure_evaluate: strategy sampled 5 clients (out of 5)
federated | INFO flwr 2024-11-02 20:55:41,399 | server.py:192 | aggregate_evaluate: received 5 results and 0 failures
federated | INFO flwr 2024-11-02 20:55:41,528 | server.py:112 | 
federated | INFO flwr 2024-11-02 20:55:41,529 | server.py:113 | [ROUND 4]
federated | INFO flwr 2024-11-02 20:55:41,529 | server.py:226 | configure_fit: strategy sampled 5 clients (out of 5)
federated | INFO flwr 2024-11-02 21:29:19,927 | server.py:240 | aggregate_fit: received 5 results and 0 failures
federated | INFO flwr 2024-11-02 21:29:24,341 | fresh copy.py:181 | Round 4 - Centralized evaluation accuracy: 0.5992666666666666, loss: 4.022829320526123
federated | INFO flwr 2024-11-02 21:29:24,343 | server.py:131 | fit progress: (4, 4.022829320526123, {'accuracy': 0.5992666666666666}, 8396.135808375024)
federated | INFO flwr 2024-11-02 21:29:24,343 | server.py:178 | configure_evaluate: strategy sampled 5 clients (out of 5)
federated | INFO flwr 2024-11-02 21:31:35,545 | server.py:192 | aggregate_evaluate: received 5 results and 0 failures
federated | INFO flwr 2024-11-02 21:31:35,546 | server.py:112 | 
federated | INFO flwr 2024-11-02 21:31:35,546 | server.py:113 | [ROUND 5]
federated | INFO flwr 2024-11-02 21:31:35,546 | server.py:226 | configure_fit: strategy sampled 5 clients (out of 5)
federated | INFO flwr 2024-11-02 22:04:12,195 | server.py:240 | aggregate_fit: received 5 results and 0 failures
federated | INFO flwr 2024-11-02 22:04:16,077 | fresh copy.py:181 | Round 5 - Centralized evaluation accuracy: 0.6009666666666666, loss: 4.021168907419841
federated | INFO flwr 2024-11-02 22:04:16,079 | server.py:131 | fit progress: (5, 4.021168907419841, {'accuracy': 0.6009666666666666}, 10487.848388832994)
federated | INFO flwr 2024-11-02 22:04:16,079 | server.py:178 | configure_evaluate: strategy sampled 5 clients (out of 5)
federated | INFO flwr 2024-11-02 22:05:39,967 | server.py:192 | aggregate_evaluate: received 5 results and 0 failures
federated | INFO flwr 2024-11-02 22:05:39,968 | server.py:112 | 
federated | INFO flwr 2024-11-02 22:05:39,968 | server.py:113 | [ROUND 6]
federated | INFO flwr 2024-11-02 22:05:39,969 | server.py:226 | configure_fit: strategy sampled 5 clients (out of 5)
federated | INFO flwr 2024-11-02 22:37:29,008 | server.py:240 | aggregate_fit: received 5 results and 0 failures
federated | INFO flwr 2024-11-02 22:37:33,026 | fresh copy.py:181 | Round 6 - Centralized evaluation accuracy: 0.5983333333333334, loss: 4.023768186442057
federated | INFO flwr 2024-11-02 22:37:33,028 | server.py:131 | fit progress: (6, 4.023768186442057, {'accuracy': 0.5983333333333334}, 12484.789878125011)
federated | INFO flwr 2024-11-02 22:37:33,028 | server.py:178 | configure_evaluate: strategy sampled 5 clients (out of 5)
federated | INFO flwr 2024-11-02 22:38:47,237 | server.py:192 | aggregate_evaluate: received 5 results and 0 failures
federated | INFO flwr 2024-11-02 22:38:47,238 | server.py:112 | 
federated | INFO flwr 2024-11-02 22:38:47,238 | server.py:113 | [ROUND 7]
federated | INFO flwr 2024-11-02 22:38:47,238 | server.py:226 | configure_fit: strategy sampled 5 clients (out of 5)
federated | INFO flwr 2024-11-02 23:10:36,668 | server.py:240 | aggregate_fit: received 5 results and 0 failures
federated | INFO flwr 2024-11-02 23:10:40,501 | fresh copy.py:181 | Round 7 - Centralized evaluation accuracy: 0.5988333333333333, loss: 4.023336876678467
federated | INFO flwr 2024-11-02 23:10:40,503 | server.py:131 | fit progress: (7, 4.023336876678467, {'accuracy': 0.5988333333333333}, 14472.248200125003)
federated | INFO flwr 2024-11-02 23:10:40,504 | server.py:178 | configure_evaluate: strategy sampled 5 clients (out of 5)
federated | INFO flwr 2024-11-02 23:12:18,028 | server.py:192 | aggregate_evaluate: received 5 results and 0 failures
federated | INFO flwr 2024-11-02 23:12:18,029 | server.py:112 | 
federated | INFO flwr 2024-11-02 23:12:18,029 | server.py:113 | [ROUND 8]
federated | INFO flwr 2024-11-02 23:12:18,029 | server.py:226 | configure_fit: strategy sampled 5 clients (out of 5)
federated | INFO flwr 2024-11-02 23:43:58,191 | server.py:240 | aggregate_fit: received 5 results and 0 failures
federated | INFO flwr 2024-11-02 23:44:01,083 | fresh copy.py:181 | Round 8 - Centralized evaluation accuracy: 0.5973333333333334, loss: 4.024856864929199
federated | INFO flwr 2024-11-02 23:44:01,085 | server.py:131 | fit progress: (8, 4.024856864929199, {'accuracy': 0.5973333333333334}, 16472.820838292013)
federated | INFO flwr 2024-11-02 23:44:01,085 | server.py:178 | configure_evaluate: strategy sampled 5 clients (out of 5)
federated | INFO flwr 2024-11-02 23:45:21,160 | server.py:192 | aggregate_evaluate: received 5 results and 0 failures
federated | INFO flwr 2024-11-02 23:45:21,161 | server.py:112 | 
federated | INFO flwr 2024-11-02 23:45:21,161 | server.py:113 | [ROUND 9]
federated | INFO flwr 2024-11-02 23:45:21,161 | server.py:226 | configure_fit: strategy sampled 5 clients (out of 5)
federated | INFO flwr 2024-11-03 00:17:00,771 | server.py:240 | aggregate_fit: received 5 results and 0 failures
federated | INFO flwr 2024-11-03 00:17:04,591 | fresh copy.py:181 | Round 9 - Centralized evaluation accuracy: 0.5961333333333333, loss: 4.026107459259033
federated | INFO flwr 2024-11-03 00:17:04,592 | server.py:131 | fit progress: (9, 4.026107459259033, {'accuracy': 0.5961333333333333}, 18456.36388304201)
federated | INFO flwr 2024-11-03 00:17:04,592 | server.py:178 | configure_evaluate: strategy sampled 5 clients (out of 5)
federated | INFO flwr 2024-11-03 00:18:17,463 | server.py:192 | aggregate_evaluate: received 5 results and 0 failures
federated | INFO flwr 2024-11-03 00:18:17,463 | server.py:112 | 
federated | INFO flwr 2024-11-03 00:18:17,463 | server.py:113 | [ROUND 10]
federated | INFO flwr 2024-11-03 00:18:17,463 | server.py:226 | configure_fit: strategy sampled 5 clients (out of 5)
federated | INFO flwr 2024-11-03 00:49:48,580 | server.py:240 | aggregate_fit: received 5 results and 0 failures
federated | INFO flwr 2024-11-03 00:49:52,286 | fresh copy.py:181 | Round 10 - Centralized evaluation accuracy: 0.5950666666666666, loss: 4.027158771006266
federated | INFO flwr 2024-11-03 00:49:52,288 | server.py:131 | fit progress: (10, 4.027158771006266, {'accuracy': 0.5950666666666666}, 20424.03959662502)
federated | INFO flwr 2024-11-03 00:49:52,288 | server.py:178 | configure_evaluate: strategy sampled 5 clients (out of 5)
federated | INFO flwr 2024-11-03 00:51:21,935 | server.py:192 | aggregate_evaluate: received 5 results and 0 failures
federated | INFO flwr 2024-11-03 00:51:21,953 | server.py:496 | 
federated | INFO flwr 2024-11-03 00:51:21,953 | server.py:497 | [SUMMARY]
federated | INFO flwr 2024-11-03 00:51:21,953 | server.py:498 | Run finished 10 round(s) in 20513.69s
federated | INFO flwr 2024-11-03 00:51:21,954 | server.py:500 | 	History (loss, distributed):
federated | INFO flwr 2024-11-03 00:51:21,954 | server.py:500 | 		round 1: 0.3241
federated | INFO flwr 2024-11-03 00:51:21,954 | server.py:500 | 		round 2: 0.8168666666666666
federated | INFO flwr 2024-11-03 00:51:21,954 | server.py:500 | 		round 3: 0.866
federated | INFO flwr 2024-11-03 00:51:21,954 | server.py:500 | 		round 4: 0.8751
federated | INFO flwr 2024-11-03 00:51:21,954 | server.py:500 | 		round 5: 0.8771
federated | INFO flwr 2024-11-03 00:51:21,954 | server.py:500 | 		round 6: 0.8781333333333333
federated | INFO flwr 2024-11-03 00:51:21,954 | server.py:500 | 		round 7: 0.8784666666666666
federated | INFO flwr 2024-11-03 00:51:21,954 | server.py:500 | 		round 8: 0.8790333333333333
federated | INFO flwr 2024-11-03 00:51:21,954 | server.py:500 | 		round 9: 0.8792666666666666
federated | INFO flwr 2024-11-03 00:51:21,954 | server.py:500 | 		round 10: 0.8793333333333333
federated | INFO flwr 2024-11-03 00:51:21,954 | server.py:500 | 	History (loss, centralized):
federated | INFO flwr 2024-11-03 00:51:21,954 | server.py:500 | 		round 0: 4.6051896250406905
federated | INFO flwr 2024-11-03 00:51:21,954 | server.py:500 | 		round 1: 4.420942883046468
federated | INFO flwr 2024-11-03 00:51:21,954 | server.py:500 | 		round 2: 4.0357920331319175
federated | INFO flwr 2024-11-03 00:51:21,954 | server.py:500 | 		round 3: 4.022123151397705
federated | INFO flwr 2024-11-03 00:51:21,954 | server.py:500 | 		round 4: 4.022829320526123
federated | INFO flwr 2024-11-03 00:51:21,954 | server.py:500 | 		round 5: 4.021168907419841
federated | INFO flwr 2024-11-03 00:51:21,954 | server.py:500 | 		round 6: 4.023768186442057
federated | INFO flwr 2024-11-03 00:51:21,954 | server.py:500 | 		round 7: 4.023336876678467
federated | INFO flwr 2024-11-03 00:51:21,954 | server.py:500 | 		round 8: 4.024856864929199
federated | INFO flwr 2024-11-03 00:51:21,954 | server.py:500 | 		round 9: 4.026107459259033
federated | INFO flwr 2024-11-03 00:51:21,954 | server.py:500 | 		round 10: 4.027158771006266
federated | INFO flwr 2024-11-03 00:51:21,954 | server.py:500 | 	History (metrics, centralized):
federated | INFO flwr 2024-11-03 00:51:21,955 | server.py:500 | 	{'accuracy': [(0, 0.010133333333333333),
federated | INFO flwr 2024-11-03 00:51:21,955 | server.py:500 | 	              (1, 0.2823333333333333),
federated | INFO flwr 2024-11-03 00:51:21,955 | server.py:500 | 	              (2, 0.5866),
federated | INFO flwr 2024-11-03 00:51:21,955 | server.py:500 | 	              (3, 0.6002),
federated | INFO flwr 2024-11-03 00:51:21,955 | server.py:500 | 	              (4, 0.5992666666666666),
federated | INFO flwr 2024-11-03 00:51:21,955 | server.py:500 | 	              (5, 0.6009666666666666),
federated | INFO flwr 2024-11-03 00:51:21,955 | server.py:500 | 	              (6, 0.5983333333333334),
federated | INFO flwr 2024-11-03 00:51:21,955 | server.py:500 | 	              (7, 0.5988333333333333),
federated | INFO flwr 2024-11-03 00:51:21,955 | server.py:500 | 	              (8, 0.5973333333333334),
federated | INFO flwr 2024-11-03 00:51:21,955 | server.py:500 | 	              (9, 0.5961333333333333),
federated | INFO flwr 2024-11-03 00:51:21,955 | server.py:500 | 	              (10, 0.5950666666666666)]}
federated | INFO flwr 2024-11-03 00:51:21,955 | server.py:501 | 
federated | INFO flwr 2024-11-03 13:03:28,132 | app.py:219 | Starting Flower simulation, config: num_rounds=10, no round_timeout
federated | INFO flwr 2024-11-03 13:03:30,463 | app.py:242 | Flower VCE: Ray initialized with resources: {'node:127.0.0.1': 1.0, 'GPU': 1.0, 'memory': 6369973044.0, 'CPU': 8.0, 'node:__internal_head__': 1.0, 'object_store_memory': 2147483648.0}
federated | INFO flwr 2024-11-03 13:03:30,463 | app.py:248 | Optimize your simulation with Flower VCE: https://flower.ai/docs/framework/how-to-run-simulations.html
federated | INFO flwr 2024-11-03 13:03:30,463 | app.py:271 | Flower VCE: Resources for each Virtual Client: {'num_cpus': 1, 'num_gpus': 0.2}
federated | INFO flwr 2024-11-03 13:03:30,474 | app.py:317 | Flower VCE: Creating VirtualClientEngineActorPool with 5 actors
federated | INFO flwr 2024-11-03 13:03:30,474 | server.py:92 | [INIT]
federated | INFO flwr 2024-11-03 13:03:30,474 | server.py:281 | Requesting initial parameters from one random client
federated | ERROR flwr 2024-11-03 13:03:39,456 | ray_client_proxy.py:106 | Traceback (most recent call last):
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 94, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 398, in get_client_result
    return self._fetch_future_result(cid)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 279, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
                                         ^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=39156, ip=127.0.0.1, actor_id=d15ba62081baec973322165301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x165f0a3d0>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/message_handler/message_handler.py", line 95, in handle_legacy_message_from_msgtype
    client = client_fn(context)
             ^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 67, in adaptor_fn
    return client_fn(str(cid))  # type: ignore
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/texas100/target_train.py", line 215, in client_fn
    return MaliciousFlowerClient(model, int(cid)).to_client()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: MaliciousFlowerClient.__init__() missing 5 required positional arguments: 'dataloader', 'optimizer', 'criterion', 'device', and 'non_member_data'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=39156, ip=127.0.0.1, actor_id=d15ba62081baec973322165301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x165f0a3d0>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: MaliciousFlowerClient.__init__() missing 5 required positional arguments: 'dataloader', 'optimizer', 'criterion', 'device', and 'non_member_data'

federated | ERROR flwr 2024-11-03 13:03:39,456 | ray_client_proxy.py:107 | [36mray::ClientAppActor.run()[39m (pid=39156, ip=127.0.0.1, actor_id=d15ba62081baec973322165301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x165f0a3d0>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/message_handler/message_handler.py", line 95, in handle_legacy_message_from_msgtype
    client = client_fn(context)
             ^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 67, in adaptor_fn
    return client_fn(str(cid))  # type: ignore
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/texas100/target_train.py", line 215, in client_fn
    return MaliciousFlowerClient(model, int(cid)).to_client()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: MaliciousFlowerClient.__init__() missing 5 required positional arguments: 'dataloader', 'optimizer', 'criterion', 'device', and 'non_member_data'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=39156, ip=127.0.0.1, actor_id=d15ba62081baec973322165301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x165f0a3d0>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: MaliciousFlowerClient.__init__() missing 5 required positional arguments: 'dataloader', 'optimizer', 'criterion', 'device', and 'non_member_data'
federated | ERROR flwr 2024-11-03 13:03:39,456 | app.py:344 | [36mray::ClientAppActor.run()[39m (pid=39156, ip=127.0.0.1, actor_id=d15ba62081baec973322165301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x165f0a3d0>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/message_handler/message_handler.py", line 95, in handle_legacy_message_from_msgtype
    client = client_fn(context)
             ^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 67, in adaptor_fn
    return client_fn(str(cid))  # type: ignore
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/texas100/target_train.py", line 215, in client_fn
    return MaliciousFlowerClient(model, int(cid)).to_client()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: MaliciousFlowerClient.__init__() missing 5 required positional arguments: 'dataloader', 'optimizer', 'criterion', 'device', and 'non_member_data'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=39156, ip=127.0.0.1, actor_id=d15ba62081baec973322165301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x165f0a3d0>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: MaliciousFlowerClient.__init__() missing 5 required positional arguments: 'dataloader', 'optimizer', 'criterion', 'device', and 'non_member_data'
federated | ERROR flwr 2024-11-03 13:03:39,458 | app.py:345 | Traceback (most recent call last):
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/app.py", line 339, in start_simulation
    hist = run_fl(
           ^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/server/server.py", line 492, in run_fl
    hist, elapsed_time = server.fit(
                         ^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/server/server.py", line 93, in fit
    self.parameters = self._get_initial_parameters(server_round=0, timeout=timeout)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/server/server.py", line 284, in _get_initial_parameters
    get_parameters_res = random_client.get_parameters(
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 168, in get_parameters
    message_out = self._submit_job(message, timeout)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 108, in _submit_job
    raise ex
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 94, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 398, in get_client_result
    return self._fetch_future_result(cid)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 279, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
                                         ^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=39156, ip=127.0.0.1, actor_id=d15ba62081baec973322165301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x165f0a3d0>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/message_handler/message_handler.py", line 95, in handle_legacy_message_from_msgtype
    client = client_fn(context)
             ^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 67, in adaptor_fn
    return client_fn(str(cid))  # type: ignore
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/texas100/target_train.py", line 215, in client_fn
    return MaliciousFlowerClient(model, int(cid)).to_client()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: MaliciousFlowerClient.__init__() missing 5 required positional arguments: 'dataloader', 'optimizer', 'criterion', 'device', and 'non_member_data'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=39156, ip=127.0.0.1, actor_id=d15ba62081baec973322165301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x165f0a3d0>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: MaliciousFlowerClient.__init__() missing 5 required positional arguments: 'dataloader', 'optimizer', 'criterion', 'device', and 'non_member_data'

federated | ERROR flwr 2024-11-03 13:03:39,458 | app.py:346 | Your simulation crashed :(. This could be because of several reasons. The most common are: 
	 > Sometimes, issues in the simulation code itself can cause crashes. It's always a good idea to double-check your code for any potential bugs or inconsistencies that might be contributing to the problem. For example: 
		 - You might be using a class attribute in your clients that hasn't been defined.
		 - There could be an incorrect method call to a 3rd party library (e.g., PyTorch).
		 - The return types of methods in your clients/strategies might be incorrect.
	 > Your system couldn't fit a single VirtualClient: try lowering `client_resources`.
	 > All the actors in your pool crashed. This could be because: 
		 - You clients hit an out-of-memory (OOM) error and actors couldn't recover from it. Try launching your simulation with more generous `client_resources` setting (i.e. it seems {'num_cpus': 1, 'num_gpus': 0.2} is not enough for your run). Use fewer concurrent actors. 
		 - You were running a multi-node simulation and all worker nodes disconnected. The head node might still be alive but cannot accommodate any actor with resources: {'num_cpus': 1, 'num_gpus': 0.2}.
Take a look at the Flower simulation examples for guidance <https://flower.ai/docs/framework/how-to-run-simulations.html>.
federated | INFO flwr 2024-11-03 13:08:01,084 | app.py:219 | Starting Flower simulation, config: num_rounds=10, no round_timeout
federated | INFO flwr 2024-11-03 13:08:03,393 | app.py:242 | Flower VCE: Ray initialized with resources: {'object_store_memory': 2147483648.0, 'memory': 6484251444.0, 'GPU': 1.0, 'node:127.0.0.1': 1.0, 'CPU': 8.0, 'node:__internal_head__': 1.0}
federated | INFO flwr 2024-11-03 13:08:03,393 | app.py:248 | Optimize your simulation with Flower VCE: https://flower.ai/docs/framework/how-to-run-simulations.html
federated | INFO flwr 2024-11-03 13:08:03,393 | app.py:271 | Flower VCE: Resources for each Virtual Client: {'num_cpus': 1, 'num_gpus': 0.2}
federated | INFO flwr 2024-11-03 13:08:03,403 | app.py:317 | Flower VCE: Creating VirtualClientEngineActorPool with 5 actors
federated | INFO flwr 2024-11-03 13:08:03,403 | server.py:92 | [INIT]
federated | INFO flwr 2024-11-03 13:08:03,403 | server.py:281 | Requesting initial parameters from one random client
federated | INFO flwr 2024-11-03 13:08:18,041 | server.py:288 | Received initial parameters from one random client
federated | INFO flwr 2024-11-03 13:08:18,042 | server.py:94 | Starting evaluation of initial global parameters
federated | INFO flwr 2024-11-03 13:08:21,597 | target_train.py:186 | Round 0 - Centralized evaluation accuracy: 0.004633333333333333, loss: 4.605165985870362
federated | INFO flwr 2024-11-03 13:08:21,599 | server.py:97 | initial parameters (loss, other metrics): 4.605165985870362, {'accuracy': 0.004633333333333333}
federated | INFO flwr 2024-11-03 13:08:21,599 | server.py:112 | 
federated | INFO flwr 2024-11-03 13:08:21,599 | server.py:113 | [ROUND 1]
federated | INFO flwr 2024-11-03 13:08:21,600 | server.py:226 | configure_fit: strategy sampled 5 clients (out of 5)
federated | ERROR flwr 2024-11-03 13:10:38,263 | ray_client_proxy.py:106 | Traceback (most recent call last):
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 94, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 398, in get_client_result
    return self._fetch_future_result(cid)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 279, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
                                         ^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=39314, ip=127.0.0.1, actor_id=d33c53381aff6656bf03df1201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x105c43790>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/message_handler/message_handler.py", line 129, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
              ^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client.py", line 255, in maybe_call_fit
    return client.fit(fit_ins)
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 259, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/texas100/target_train.py", line 149, in fit
    if (epoch + 1) in self.selected_epochs:
                      ^^^^^^^^^^^^^^^^^^^^
AttributeError: 'MaliciousFlowerClient' object has no attribute 'selected_epochs'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=39314, ip=127.0.0.1, actor_id=d33c53381aff6656bf03df1201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x105c43790>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'MaliciousFlowerClient' object has no attribute 'selected_epochs'

federated | ERROR flwr 2024-11-03 13:10:38,268 | ray_client_proxy.py:107 | [36mray::ClientAppActor.run()[39m (pid=39314, ip=127.0.0.1, actor_id=d33c53381aff6656bf03df1201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x105c43790>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/message_handler/message_handler.py", line 129, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
              ^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client.py", line 255, in maybe_call_fit
    return client.fit(fit_ins)
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 259, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/texas100/target_train.py", line 149, in fit
    if (epoch + 1) in self.selected_epochs:
                      ^^^^^^^^^^^^^^^^^^^^
AttributeError: 'MaliciousFlowerClient' object has no attribute 'selected_epochs'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=39314, ip=127.0.0.1, actor_id=d33c53381aff6656bf03df1201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x105c43790>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'MaliciousFlowerClient' object has no attribute 'selected_epochs'
federated | INFO flwr 2024-11-03 13:16:20,617 | app.py:219 | Starting Flower simulation, config: num_rounds=10, no round_timeout
federated | INFO flwr 2024-11-03 13:16:22,747 | app.py:242 | Flower VCE: Ray initialized with resources: {'memory': 7283625165.0, 'GPU': 1.0, 'node:127.0.0.1': 1.0, 'CPU': 8.0, 'object_store_memory': 2147483648.0, 'node:__internal_head__': 1.0}
federated | INFO flwr 2024-11-03 13:16:22,747 | app.py:248 | Optimize your simulation with Flower VCE: https://flower.ai/docs/framework/how-to-run-simulations.html
federated | INFO flwr 2024-11-03 13:16:22,747 | app.py:271 | Flower VCE: Resources for each Virtual Client: {'num_cpus': 1, 'num_gpus': 0.2}
federated | INFO flwr 2024-11-03 13:16:22,755 | app.py:317 | Flower VCE: Creating VirtualClientEngineActorPool with 5 actors
federated | INFO flwr 2024-11-03 13:16:22,756 | server.py:92 | [INIT]
federated | INFO flwr 2024-11-03 13:16:22,756 | server.py:281 | Requesting initial parameters from one random client
federated | INFO flwr 2024-11-03 13:16:39,794 | server.py:288 | Received initial parameters from one random client
federated | INFO flwr 2024-11-03 13:16:39,796 | server.py:94 | Starting evaluation of initial global parameters
federated | INFO flwr 2024-11-03 13:16:43,509 | target_train.py:186 | Round 0 - Centralized evaluation accuracy: 0.0069, loss: 4.6052567077636715
federated | INFO flwr 2024-11-03 13:16:43,511 | server.py:97 | initial parameters (loss, other metrics): 4.6052567077636715, {'accuracy': 0.0069}
federated | INFO flwr 2024-11-03 13:16:43,511 | server.py:112 | 
federated | INFO flwr 2024-11-03 13:16:43,511 | server.py:113 | [ROUND 1]
federated | INFO flwr 2024-11-03 13:16:43,512 | server.py:226 | configure_fit: strategy sampled 5 clients (out of 5)
federated | ERROR flwr 2024-11-03 13:19:11,461 | ray_client_proxy.py:106 | Traceback (most recent call last):
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 94, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 398, in get_client_result
    return self._fetch_future_result(cid)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 279, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
                                         ^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=39527, ip=127.0.0.1, actor_id=11c4f395bcb3d0f70d60221d01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x10569cf50>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/message_handler/message_handler.py", line 129, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
              ^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client.py", line 255, in maybe_call_fit
    return client.fit(fit_ins)
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 259, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/texas100/target_train.py", line 150, in fit
    self.global_model_snapshots[f"epoch_{epoch + 1}"] = copy.deepcopy(self.model.state_dict())
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'MaliciousFlowerClient' object has no attribute 'global_model_snapshots'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=39527, ip=127.0.0.1, actor_id=11c4f395bcb3d0f70d60221d01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x10569cf50>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'MaliciousFlowerClient' object has no attribute 'global_model_snapshots'

federated | ERROR flwr 2024-11-03 13:19:11,461 | ray_client_proxy.py:107 | [36mray::ClientAppActor.run()[39m (pid=39527, ip=127.0.0.1, actor_id=11c4f395bcb3d0f70d60221d01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x10569cf50>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/message_handler/message_handler.py", line 129, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
              ^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client.py", line 255, in maybe_call_fit
    return client.fit(fit_ins)
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 259, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/texas100/target_train.py", line 150, in fit
    self.global_model_snapshots[f"epoch_{epoch + 1}"] = copy.deepcopy(self.model.state_dict())
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'MaliciousFlowerClient' object has no attribute 'global_model_snapshots'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=39527, ip=127.0.0.1, actor_id=11c4f395bcb3d0f70d60221d01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x10569cf50>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'MaliciousFlowerClient' object has no attribute 'global_model_snapshots'
federated | INFO flwr 2024-11-03 13:20:28,284 | app.py:219 | Starting Flower simulation, config: num_rounds=10, no round_timeout
federated | INFO flwr 2024-11-03 13:20:30,374 | app.py:242 | Flower VCE: Ray initialized with resources: {'object_store_memory': 2147483648.0, 'GPU': 1.0, 'memory': 7026594612.0, 'node:127.0.0.1': 1.0, 'node:__internal_head__': 1.0, 'CPU': 8.0}
federated | INFO flwr 2024-11-03 13:20:30,375 | app.py:248 | Optimize your simulation with Flower VCE: https://flower.ai/docs/framework/how-to-run-simulations.html
federated | INFO flwr 2024-11-03 13:20:30,375 | app.py:271 | Flower VCE: Resources for each Virtual Client: {'num_cpus': 1, 'num_gpus': 0.2}
federated | INFO flwr 2024-11-03 13:20:30,383 | app.py:317 | Flower VCE: Creating VirtualClientEngineActorPool with 5 actors
federated | INFO flwr 2024-11-03 13:20:30,383 | server.py:92 | [INIT]
federated | INFO flwr 2024-11-03 13:20:30,383 | server.py:281 | Requesting initial parameters from one random client
federated | INFO flwr 2024-11-03 13:20:40,112 | server.py:288 | Received initial parameters from one random client
federated | INFO flwr 2024-11-03 13:20:40,112 | server.py:94 | Starting evaluation of initial global parameters
federated | INFO flwr 2024-11-03 13:20:44,205 | target_train.py:187 | Round 0 - Centralized evaluation accuracy: 0.017466666666666665, loss: 4.605174554697673
federated | INFO flwr 2024-11-03 13:20:44,207 | server.py:97 | initial parameters (loss, other metrics): 4.605174554697673, {'accuracy': 0.017466666666666665}
federated | INFO flwr 2024-11-03 13:20:44,207 | server.py:112 | 
federated | INFO flwr 2024-11-03 13:20:44,207 | server.py:113 | [ROUND 1]
federated | INFO flwr 2024-11-03 13:20:44,207 | server.py:226 | configure_fit: strategy sampled 5 clients (out of 5)
federated | INFO flwr 2024-11-03 13:30:02,204 | app.py:219 | Starting Flower simulation, config: num_rounds=10, no round_timeout
federated | INFO flwr 2024-11-03 13:30:04,656 | app.py:242 | Flower VCE: Ray initialized with resources: {'node:127.0.0.1': 1.0, 'object_store_memory': 2147483648.0, 'CPU': 8.0, 'node:__internal_head__': 1.0, 'memory': 5194129408.0, 'GPU': 1.0}
federated | INFO flwr 2024-11-03 13:30:04,656 | app.py:248 | Optimize your simulation with Flower VCE: https://flower.ai/docs/framework/how-to-run-simulations.html
federated | INFO flwr 2024-11-03 13:30:04,656 | app.py:271 | Flower VCE: Resources for each Virtual Client: {'num_cpus': 1, 'num_gpus': 0.2}
federated | INFO flwr 2024-11-03 13:30:04,666 | app.py:317 | Flower VCE: Creating VirtualClientEngineActorPool with 5 actors
federated | INFO flwr 2024-11-03 13:30:04,666 | server.py:92 | [INIT]
federated | INFO flwr 2024-11-03 13:30:04,666 | server.py:281 | Requesting initial parameters from one random client
federated | INFO flwr 2024-11-03 13:30:25,518 | server.py:288 | Received initial parameters from one random client
federated | INFO flwr 2024-11-03 13:30:25,519 | server.py:94 | Starting evaluation of initial global parameters
federated | INFO flwr 2024-11-03 13:30:28,892 | target_train.py:199 | Round 0 - Centralized evaluation accuracy: 0.005033333333333333, loss: 4.605094202423095
federated | INFO flwr 2024-11-03 13:30:28,894 | server.py:97 | initial parameters (loss, other metrics): 4.605094202423095, {'accuracy': 0.005033333333333333}
federated | INFO flwr 2024-11-03 13:30:28,894 | server.py:112 | 
federated | INFO flwr 2024-11-03 13:30:28,894 | server.py:113 | [ROUND 1]
federated | INFO flwr 2024-11-03 13:30:28,894 | server.py:226 | configure_fit: strategy sampled 5 clients (out of 5)
federated | INFO flwr 2024-11-03 14:19:09,801 | server.py:240 | aggregate_fit: received 5 results and 0 failures
federated | WARNING flwr 2024-11-03 14:19:09,883 | fedavg.py:252 | No fit_metrics_aggregation_fn provided
federated | INFO flwr 2024-11-03 14:19:13,209 | target_train.py:199 | Round 1 - Centralized evaluation accuracy: 0.3103666666666667, loss: 4.418853138478597
federated | INFO flwr 2024-11-03 14:19:13,209 | server.py:131 | fit progress: (1, 4.418853138478597, {'accuracy': 0.3103666666666667}, 1938.0149303749786)
federated | INFO flwr 2024-11-03 14:19:13,209 | server.py:178 | configure_evaluate: strategy sampled 5 clients (out of 5)
federated | INFO flwr 2024-11-03 14:21:00,526 | server.py:192 | aggregate_evaluate: received 5 results and 0 failures
federated | WARNING flwr 2024-11-03 14:21:00,528 | fedavg.py:283 | No evaluate_metrics_aggregation_fn provided
federated | INFO flwr 2024-11-03 14:21:00,528 | server.py:112 | 
federated | INFO flwr 2024-11-03 14:21:00,528 | server.py:113 | [ROUND 2]
federated | INFO flwr 2024-11-03 14:21:00,528 | server.py:226 | configure_fit: strategy sampled 5 clients (out of 5)
federated | INFO flwr 2024-11-03 14:53:23,069 | server.py:240 | aggregate_fit: received 5 results and 0 failures
federated | INFO flwr 2024-11-03 14:53:27,256 | target_train.py:199 | Round 2 - Centralized evaluation accuracy: 0.5843, loss: 4.038166910044352
federated | INFO flwr 2024-11-03 14:53:27,257 | server.py:131 | fit progress: (2, 4.038166910044352, {'accuracy': 0.5843}, 3992.02844920801)
federated | INFO flwr 2024-11-03 14:53:27,258 | server.py:178 | configure_evaluate: strategy sampled 5 clients (out of 5)
federated | INFO flwr 2024-11-03 14:54:57,297 | server.py:192 | aggregate_evaluate: received 5 results and 0 failures
federated | INFO flwr 2024-11-03 14:54:57,299 | server.py:112 | 
federated | INFO flwr 2024-11-03 14:54:57,299 | server.py:113 | [ROUND 3]
federated | INFO flwr 2024-11-03 14:54:57,299 | server.py:226 | configure_fit: strategy sampled 5 clients (out of 5)
federated | INFO flwr 2024-11-03 15:27:22,833 | server.py:240 | aggregate_fit: received 5 results and 0 failures
federated | INFO flwr 2024-11-03 15:27:26,842 | target_train.py:199 | Round 3 - Centralized evaluation accuracy: 0.6053333333333333, loss: 4.016816580454509
federated | INFO flwr 2024-11-03 15:27:26,844 | server.py:131 | fit progress: (3, 4.016816580454509, {'accuracy': 0.6053333333333333}, 6031.600400207972)
federated | INFO flwr 2024-11-03 15:27:26,844 | server.py:178 | configure_evaluate: strategy sampled 5 clients (out of 5)
federated | INFO flwr 2024-11-03 15:28:39,472 | server.py:192 | aggregate_evaluate: received 5 results and 0 failures
federated | INFO flwr 2024-11-03 15:28:39,473 | server.py:112 | 
federated | INFO flwr 2024-11-03 15:28:39,473 | server.py:113 | [ROUND 4]
federated | INFO flwr 2024-11-03 15:28:39,474 | server.py:226 | configure_fit: strategy sampled 5 clients (out of 5)
federated | INFO flwr 2024-11-03 16:01:28,243 | server.py:240 | aggregate_fit: received 5 results and 0 failures
federated | INFO flwr 2024-11-03 16:01:32,439 | target_train.py:199 | Round 4 - Centralized evaluation accuracy: 0.6047333333333333, loss: 4.017259477233886
federated | INFO flwr 2024-11-03 16:01:32,441 | server.py:131 | fit progress: (4, 4.017259477233886, {'accuracy': 0.6047333333333333}, 8077.160536999989)
federated | INFO flwr 2024-11-03 16:01:32,442 | server.py:178 | configure_evaluate: strategy sampled 5 clients (out of 5)
federated | INFO flwr 2024-11-03 16:02:59,738 | server.py:192 | aggregate_evaluate: received 5 results and 0 failures
federated | INFO flwr 2024-11-03 16:02:59,740 | server.py:112 | 
federated | INFO flwr 2024-11-03 16:02:59,740 | server.py:113 | [ROUND 5]
federated | INFO flwr 2024-11-03 16:02:59,740 | server.py:226 | configure_fit: strategy sampled 5 clients (out of 5)
federated | INFO flwr 2024-11-03 16:36:21,869 | server.py:240 | aggregate_fit: received 5 results and 0 failures
federated | INFO flwr 2024-11-03 16:36:25,907 | target_train.py:199 | Round 5 - Centralized evaluation accuracy: 0.6070333333333333, loss: 4.015218212381999
federated | INFO flwr 2024-11-03 16:36:25,909 | server.py:131 | fit progress: (5, 4.015218212381999, {'accuracy': 0.6070333333333333}, 10170.606448333012)
federated | INFO flwr 2024-11-03 16:36:25,909 | server.py:178 | configure_evaluate: strategy sampled 5 clients (out of 5)
federated | INFO flwr 2024-11-03 16:37:51,000 | server.py:192 | aggregate_evaluate: received 5 results and 0 failures
federated | INFO flwr 2024-11-03 16:37:51,001 | server.py:112 | 
federated | INFO flwr 2024-11-03 16:37:51,002 | server.py:113 | [ROUND 6]
federated | INFO flwr 2024-11-03 16:37:51,002 | server.py:226 | configure_fit: strategy sampled 5 clients (out of 5)
federated | INFO flwr 2024-11-03 17:12:55,169 | server.py:240 | aggregate_fit: received 5 results and 0 failures
federated | INFO flwr 2024-11-03 17:12:59,142 | target_train.py:199 | Round 6 - Centralized evaluation accuracy: 0.6058666666666667, loss: 4.016372686513265
federated | INFO flwr 2024-11-03 17:12:59,143 | server.py:131 | fit progress: (6, 4.016372686513265, {'accuracy': 0.6058666666666667}, 12310.62936320802)
federated | INFO flwr 2024-11-03 17:12:59,143 | server.py:178 | configure_evaluate: strategy sampled 5 clients (out of 5)
federated | INFO flwr 2024-11-03 17:15:03,776 | server.py:192 | aggregate_evaluate: received 5 results and 0 failures
federated | INFO flwr 2024-11-03 17:15:03,777 | server.py:112 | 
federated | INFO flwr 2024-11-03 17:15:03,777 | server.py:113 | [ROUND 7]
federated | INFO flwr 2024-11-03 17:15:03,777 | server.py:226 | configure_fit: strategy sampled 5 clients (out of 5)
federated | INFO flwr 2024-11-03 18:07:01,406 | server.py:240 | aggregate_fit: received 5 results and 0 failures
federated | INFO flwr 2024-11-03 18:07:06,023 | target_train.py:199 | Round 7 - Centralized evaluation accuracy: 0.6039333333333333, loss: 4.018283280944824
federated | INFO flwr 2024-11-03 18:07:06,024 | server.py:131 | fit progress: (7, 4.018283280944824, {'accuracy': 0.6039333333333333}, 14665.733317375008)
federated | INFO flwr 2024-11-03 18:07:06,025 | server.py:178 | configure_evaluate: strategy sampled 5 clients (out of 5)
federated | INFO flwr 2024-11-03 18:09:09,489 | server.py:192 | aggregate_evaluate: received 5 results and 0 failures
federated | INFO flwr 2024-11-03 18:09:09,489 | server.py:112 | 
federated | INFO flwr 2024-11-03 18:09:09,490 | server.py:113 | [ROUND 8]
federated | INFO flwr 2024-11-03 18:09:09,490 | server.py:226 | configure_fit: strategy sampled 5 clients (out of 5)
federated | INFO flwr 2024-11-03 19:04:38,979 | server.py:240 | aggregate_fit: received 5 results and 0 failures
federated | INFO flwr 2024-11-03 19:04:43,435 | target_train.py:199 | Round 8 - Centralized evaluation accuracy: 0.6063666666666667, loss: 4.015779072316487
federated | INFO flwr 2024-11-03 19:04:43,436 | server.py:131 | fit progress: (8, 4.015779072316487, {'accuracy': 0.6063666666666667}, 17383.157630749978)
federated | INFO flwr 2024-11-03 19:04:43,437 | server.py:178 | configure_evaluate: strategy sampled 5 clients (out of 5)
federated | INFO flwr 2024-11-03 19:06:12,509 | server.py:192 | aggregate_evaluate: received 5 results and 0 failures
federated | INFO flwr 2024-11-03 19:06:12,511 | server.py:112 | 
federated | INFO flwr 2024-11-03 19:06:12,511 | server.py:113 | [ROUND 9]
federated | INFO flwr 2024-11-03 19:06:12,511 | server.py:226 | configure_fit: strategy sampled 5 clients (out of 5)
federated | INFO flwr 2024-11-03 19:42:34,837 | server.py:240 | aggregate_fit: received 5 results and 0 failures
federated | INFO flwr 2024-11-03 19:42:38,249 | target_train.py:199 | Round 9 - Centralized evaluation accuracy: 0.6054333333333334, loss: 4.016793073527018
federated | INFO flwr 2024-11-03 19:42:38,250 | server.py:131 | fit progress: (9, 4.016793073527018, {'accuracy': 0.6054333333333334}, 19657.940595707973)
federated | INFO flwr 2024-11-03 19:42:38,250 | server.py:178 | configure_evaluate: strategy sampled 5 clients (out of 5)
federated | INFO flwr 2024-11-03 19:44:08,819 | server.py:192 | aggregate_evaluate: received 5 results and 0 failures
federated | INFO flwr 2024-11-03 19:44:08,820 | server.py:112 | 
federated | INFO flwr 2024-11-03 19:44:08,820 | server.py:113 | [ROUND 10]
federated | INFO flwr 2024-11-03 19:44:08,821 | server.py:226 | configure_fit: strategy sampled 5 clients (out of 5)
federated | INFO flwr 2024-11-03 20:18:16,618 | server.py:240 | aggregate_fit: received 5 results and 0 failures
federated | INFO flwr 2024-11-03 20:18:20,936 | target_train.py:199 | Round 10 - Centralized evaluation accuracy: 0.6046, loss: 4.017618744150798
federated | INFO flwr 2024-11-03 20:18:20,938 | server.py:131 | fit progress: (10, 4.017618744150798, {'accuracy': 0.6046}, 21800.63925191702)
federated | INFO flwr 2024-11-03 20:18:20,938 | server.py:178 | configure_evaluate: strategy sampled 5 clients (out of 5)
federated | INFO flwr 2024-11-03 20:20:06,030 | server.py:192 | aggregate_evaluate: received 5 results and 0 failures
federated | INFO flwr 2024-11-03 20:20:06,040 | server.py:496 | 
federated | INFO flwr 2024-11-03 20:20:06,040 | server.py:497 | [SUMMARY]
federated | INFO flwr 2024-11-03 20:20:06,040 | server.py:498 | Run finished 10 round(s) in 21905.73s
federated | INFO flwr 2024-11-03 20:20:06,040 | server.py:500 | 	History (loss, distributed):
federated | INFO flwr 2024-11-03 20:20:06,040 | server.py:500 | 		round 1: 0.34396666666666664
federated | INFO flwr 2024-11-03 20:20:06,041 | server.py:500 | 		round 2: 0.8198333333333333
federated | INFO flwr 2024-11-03 20:20:06,041 | server.py:500 | 		round 3: 0.8791333333333333
federated | INFO flwr 2024-11-03 20:20:06,041 | server.py:500 | 		round 4: 0.8856333333333334
federated | INFO flwr 2024-11-03 20:20:06,041 | server.py:500 | 		round 5: 0.8872666666666666
federated | INFO flwr 2024-11-03 20:20:06,041 | server.py:500 | 		round 6: 0.8883
federated | INFO flwr 2024-11-03 20:20:06,041 | server.py:500 | 		round 7: 0.8892666666666666
federated | INFO flwr 2024-11-03 20:20:06,041 | server.py:500 | 		round 8: 0.8897333333333334
federated | INFO flwr 2024-11-03 20:20:06,041 | server.py:500 | 		round 9: 0.8901333333333333
federated | INFO flwr 2024-11-03 20:20:06,041 | server.py:500 | 		round 10: 0.8905666666666666
federated | INFO flwr 2024-11-03 20:20:06,041 | server.py:500 | 	History (loss, centralized):
federated | INFO flwr 2024-11-03 20:20:06,041 | server.py:500 | 		round 0: 4.605094202423095
federated | INFO flwr 2024-11-03 20:20:06,041 | server.py:500 | 		round 1: 4.418853138478597
federated | INFO flwr 2024-11-03 20:20:06,041 | server.py:500 | 		round 2: 4.038166910044352
federated | INFO flwr 2024-11-03 20:20:06,041 | server.py:500 | 		round 3: 4.016816580454509
federated | INFO flwr 2024-11-03 20:20:06,041 | server.py:500 | 		round 4: 4.017259477233886
federated | INFO flwr 2024-11-03 20:20:06,041 | server.py:500 | 		round 5: 4.015218212381999
federated | INFO flwr 2024-11-03 20:20:06,041 | server.py:500 | 		round 6: 4.016372686513265
federated | INFO flwr 2024-11-03 20:20:06,041 | server.py:500 | 		round 7: 4.018283280944824
federated | INFO flwr 2024-11-03 20:20:06,041 | server.py:500 | 		round 8: 4.015779072316487
federated | INFO flwr 2024-11-03 20:20:06,041 | server.py:500 | 		round 9: 4.016793073527018
federated | INFO flwr 2024-11-03 20:20:06,041 | server.py:500 | 		round 10: 4.017618744150798
federated | INFO flwr 2024-11-03 20:20:06,041 | server.py:500 | 	History (metrics, centralized):
federated | INFO flwr 2024-11-03 20:20:06,041 | server.py:500 | 	{'accuracy': [(0, 0.005033333333333333),
federated | INFO flwr 2024-11-03 20:20:06,041 | server.py:500 | 	              (1, 0.3103666666666667),
federated | INFO flwr 2024-11-03 20:20:06,041 | server.py:500 | 	              (2, 0.5843),
federated | INFO flwr 2024-11-03 20:20:06,041 | server.py:500 | 	              (3, 0.6053333333333333),
federated | INFO flwr 2024-11-03 20:20:06,041 | server.py:500 | 	              (4, 0.6047333333333333),
federated | INFO flwr 2024-11-03 20:20:06,041 | server.py:500 | 	              (5, 0.6070333333333333),
federated | INFO flwr 2024-11-03 20:20:06,041 | server.py:500 | 	              (6, 0.6058666666666667),
federated | INFO flwr 2024-11-03 20:20:06,041 | server.py:500 | 	              (7, 0.6039333333333333),
federated | INFO flwr 2024-11-03 20:20:06,041 | server.py:500 | 	              (8, 0.6063666666666667),
federated | INFO flwr 2024-11-03 20:20:06,041 | server.py:500 | 	              (9, 0.6054333333333334),
federated | INFO flwr 2024-11-03 20:20:06,041 | server.py:500 | 	              (10, 0.6046)]}
federated | INFO flwr 2024-11-03 20:20:06,041 | server.py:501 | 
federated | INFO flwr 2024-11-04 16:29:34,270 | app.py:219 | Starting Flower simulation, config: num_rounds=10, no round_timeout
federated | INFO flwr 2024-11-04 16:29:36,598 | app.py:242 | Flower VCE: Ray initialized with resources: {'object_store_memory': 2147483648.0, 'CPU': 8.0, 'node:127.0.0.1': 1.0, 'node:__internal_head__': 1.0, 'GPU': 1.0, 'memory': 8094058087.0}
federated | INFO flwr 2024-11-04 16:29:36,598 | app.py:248 | Optimize your simulation with Flower VCE: https://flower.ai/docs/framework/how-to-run-simulations.html
federated | INFO flwr 2024-11-04 16:29:36,598 | app.py:271 | Flower VCE: Resources for each Virtual Client: {'num_cpus': 1, 'num_gpus': 0.2}
federated | INFO flwr 2024-11-04 16:29:36,608 | app.py:317 | Flower VCE: Creating VirtualClientEngineActorPool with 5 actors
federated | INFO flwr 2024-11-04 16:29:36,608 | server.py:92 | [INIT]
federated | INFO flwr 2024-11-04 16:29:36,608 | server.py:281 | Requesting initial parameters from one random client
federated | INFO flwr 2024-11-04 16:30:05,032 | server.py:288 | Received initial parameters from one random client
federated | INFO flwr 2024-11-04 16:30:05,033 | server.py:94 | Starting evaluation of initial global parameters
federated | INFO flwr 2024-11-04 16:30:08,758 | target_train.py:200 | Round 0 - Centralized evaluation accuracy: 0.0061, loss: 4.60519246190389
federated | INFO flwr 2024-11-04 16:30:08,760 | server.py:97 | initial parameters (loss, other metrics): 4.60519246190389, {'accuracy': 0.0061}
federated | INFO flwr 2024-11-04 16:30:08,760 | server.py:112 | 
federated | INFO flwr 2024-11-04 16:30:08,760 | server.py:113 | [ROUND 1]
federated | INFO flwr 2024-11-04 16:30:08,760 | server.py:226 | configure_fit: strategy sampled 5 clients (out of 5)
federated | INFO flwr 2024-11-04 16:31:00,522 | app.py:219 | Starting Flower simulation, config: num_rounds=10, no round_timeout
federated | INFO flwr 2024-11-04 16:31:02,661 | app.py:242 | Flower VCE: Ray initialized with resources: {'node:__internal_head__': 1.0, 'GPU': 1.0, 'memory': 6771952845.0, 'object_store_memory': 2147483648.0, 'CPU': 8.0, 'node:127.0.0.1': 1.0}
federated | INFO flwr 2024-11-04 16:31:02,662 | app.py:248 | Optimize your simulation with Flower VCE: https://flower.ai/docs/framework/how-to-run-simulations.html
federated | INFO flwr 2024-11-04 16:31:02,662 | app.py:271 | Flower VCE: Resources for each Virtual Client: {'num_cpus': 1, 'num_gpus': 0.2}
federated | INFO flwr 2024-11-04 16:31:02,669 | app.py:317 | Flower VCE: Creating VirtualClientEngineActorPool with 5 actors
federated | INFO flwr 2024-11-04 16:31:02,669 | server.py:92 | [INIT]
federated | INFO flwr 2024-11-04 16:31:02,669 | server.py:281 | Requesting initial parameters from one random client
federated | INFO flwr 2024-11-04 16:31:17,596 | server.py:288 | Received initial parameters from one random client
federated | INFO flwr 2024-11-04 16:31:17,597 | server.py:94 | Starting evaluation of initial global parameters
federated | INFO flwr 2024-11-04 16:31:22,076 | target_train.py:202 | Round 0 - Centralized evaluation accuracy: 0.0059, loss: 4.6050691937764485
federated | INFO flwr 2024-11-04 16:31:22,078 | server.py:97 | initial parameters (loss, other metrics): 4.6050691937764485, {'accuracy': 0.0059}
federated | INFO flwr 2024-11-04 16:31:22,079 | server.py:112 | 
federated | INFO flwr 2024-11-04 16:31:22,079 | server.py:113 | [ROUND 1]
federated | INFO flwr 2024-11-04 16:31:22,079 | server.py:226 | configure_fit: strategy sampled 5 clients (out of 5)
federated | INFO flwr 2024-11-04 16:41:10,964 | app.py:219 | Starting Flower simulation, config: num_rounds=10, no round_timeout
federated | INFO flwr 2024-11-04 16:41:13,090 | app.py:242 | Flower VCE: Ray initialized with resources: {'GPU': 1.0, 'memory': 7695853159.0, 'object_store_memory': 2147483648.0, 'node:127.0.0.1': 1.0, 'node:__internal_head__': 1.0, 'CPU': 8.0}
federated | INFO flwr 2024-11-04 16:41:13,091 | app.py:248 | Optimize your simulation with Flower VCE: https://flower.ai/docs/framework/how-to-run-simulations.html
federated | INFO flwr 2024-11-04 16:41:13,091 | app.py:271 | Flower VCE: Resources for each Virtual Client: {'num_cpus': 1, 'num_gpus': 0.2}
federated | INFO flwr 2024-11-04 16:41:13,099 | app.py:317 | Flower VCE: Creating VirtualClientEngineActorPool with 5 actors
federated | INFO flwr 2024-11-04 16:41:13,099 | server.py:92 | [INIT]
federated | INFO flwr 2024-11-04 16:41:13,100 | server.py:281 | Requesting initial parameters from one random client
federated | INFO flwr 2024-11-04 16:41:34,651 | server.py:288 | Received initial parameters from one random client
federated | INFO flwr 2024-11-04 16:41:34,651 | server.py:94 | Starting evaluation of initial global parameters
federated | INFO flwr 2024-11-04 16:41:38,250 | target_train.py:203 | Round 0 - Centralized evaluation accuracy: 0.0201, loss: 4.605147296396892
federated | INFO flwr 2024-11-04 16:41:38,252 | server.py:97 | initial parameters (loss, other metrics): 4.605147296396892, {'accuracy': 0.0201}
federated | INFO flwr 2024-11-04 16:41:38,252 | server.py:112 | 
federated | INFO flwr 2024-11-04 16:41:38,252 | server.py:113 | [ROUND 1]
federated | INFO flwr 2024-11-04 16:41:38,252 | server.py:226 | configure_fit: strategy sampled 5 clients (out of 5)
federated | INFO flwr 2024-11-04 18:17:48,954 | app.py:219 | Starting Flower simulation, config: num_rounds=10, no round_timeout
federated | INFO flwr 2024-11-04 18:17:51,249 | app.py:242 | Flower VCE: Ray initialized with resources: {'node:127.0.0.1': 1.0, 'CPU': 8.0, 'object_store_memory': 2147483648.0, 'node:__internal_head__': 1.0, 'memory': 5635892839.0, 'GPU': 1.0}
federated | INFO flwr 2024-11-04 18:17:51,249 | app.py:248 | Optimize your simulation with Flower VCE: https://flower.ai/docs/framework/how-to-run-simulations.html
federated | INFO flwr 2024-11-04 18:17:51,249 | app.py:271 | Flower VCE: Resources for each Virtual Client: {'num_cpus': 1, 'num_gpus': 0.2}
federated | INFO flwr 2024-11-04 18:17:51,258 | app.py:317 | Flower VCE: Creating VirtualClientEngineActorPool with 5 actors
federated | INFO flwr 2024-11-04 18:17:51,259 | server.py:92 | [INIT]
federated | INFO flwr 2024-11-04 18:17:51,259 | server.py:281 | Requesting initial parameters from one random client
federated | INFO flwr 2024-11-04 18:18:18,718 | server.py:288 | Received initial parameters from one random client
federated | INFO flwr 2024-11-04 18:18:18,719 | server.py:94 | Starting evaluation of initial global parameters
federated | INFO flwr 2024-11-04 18:18:22,385 | target_train.py:222 | Round 0 - Centralized evaluation accuracy: 0.044366666666666665, loss: 4.605122903442383
federated | INFO flwr 2024-11-04 18:18:22,387 | server.py:97 | initial parameters (loss, other metrics): 4.605122903442383, {'accuracy': 0.044366666666666665}
federated | INFO flwr 2024-11-04 18:18:22,387 | server.py:112 | 
federated | INFO flwr 2024-11-04 18:18:22,387 | server.py:113 | [ROUND 1]
federated | INFO flwr 2024-11-04 18:18:22,387 | server.py:226 | configure_fit: strategy sampled 5 clients (out of 5)
federated | ERROR flwr 2024-11-04 18:20:41,803 | ray_client_proxy.py:106 | Traceback (most recent call last):
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 94, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 398, in get_client_result
    return self._fetch_future_result(cid)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 279, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
                                         ^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=66379, ip=127.0.0.1, actor_id=7ceea438ef3df61081bd044e01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x10514f1d0>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/message_handler/message_handler.py", line 129, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
              ^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client.py", line 255, in maybe_call_fit
    return client.fit(fit_ins)
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 259, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/texas100/target_train.py", line 182, in fit
    self.bias_log.append(self.extract_bias())
                         ^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/texas100/target_train.py", line 161, in extract_bias
    return biases[0]  # Return the actual bias values as a 1D list (100 values for last layer)
           ~~~~~~^^^
IndexError: list index out of range

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=66379, ip=127.0.0.1, actor_id=7ceea438ef3df61081bd044e01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x10514f1d0>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: list index out of range

federated | ERROR flwr 2024-11-04 18:20:41,815 | ray_client_proxy.py:107 | [36mray::ClientAppActor.run()[39m (pid=66379, ip=127.0.0.1, actor_id=7ceea438ef3df61081bd044e01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x10514f1d0>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/message_handler/message_handler.py", line 129, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
              ^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client.py", line 255, in maybe_call_fit
    return client.fit(fit_ins)
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 259, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/texas100/target_train.py", line 182, in fit
    self.bias_log.append(self.extract_bias())
                         ^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/texas100/target_train.py", line 161, in extract_bias
    return biases[0]  # Return the actual bias values as a 1D list (100 values for last layer)
           ~~~~~~^^^
IndexError: list index out of range

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=66379, ip=127.0.0.1, actor_id=7ceea438ef3df61081bd044e01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x10514f1d0>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: list index out of range
federated | INFO flwr 2024-11-04 18:23:00,765 | app.py:219 | Starting Flower simulation, config: num_rounds=10, no round_timeout
federated | INFO flwr 2024-11-04 18:23:02,849 | app.py:242 | Flower VCE: Ray initialized with resources: {'object_store_memory': 2147483648.0, 'node:127.0.0.1': 1.0, 'node:__internal_head__': 1.0, 'CPU': 8.0, 'GPU': 1.0, 'memory': 7563363943.0}
federated | INFO flwr 2024-11-04 18:23:02,849 | app.py:248 | Optimize your simulation with Flower VCE: https://flower.ai/docs/framework/how-to-run-simulations.html
federated | INFO flwr 2024-11-04 18:23:02,849 | app.py:271 | Flower VCE: Resources for each Virtual Client: {'num_cpus': 1, 'num_gpus': 0.2}
federated | INFO flwr 2024-11-04 18:23:02,858 | app.py:317 | Flower VCE: Creating VirtualClientEngineActorPool with 5 actors
federated | INFO flwr 2024-11-04 18:23:02,858 | server.py:92 | [INIT]
federated | INFO flwr 2024-11-04 18:23:02,858 | server.py:281 | Requesting initial parameters from one random client
federated | INFO flwr 2024-11-04 18:23:17,001 | server.py:288 | Received initial parameters from one random client
federated | INFO flwr 2024-11-04 18:23:17,001 | server.py:94 | Starting evaluation of initial global parameters
federated | INFO flwr 2024-11-04 18:23:20,662 | target_train.py:231 | Round 0 - Centralized evaluation accuracy: 0.005333333333333333, loss: 4.605083084869385
federated | INFO flwr 2024-11-04 18:23:20,664 | server.py:97 | initial parameters (loss, other metrics): 4.605083084869385, {'accuracy': 0.005333333333333333}
federated | INFO flwr 2024-11-04 18:23:20,664 | server.py:112 | 
federated | INFO flwr 2024-11-04 18:23:20,664 | server.py:113 | [ROUND 1]
federated | INFO flwr 2024-11-04 18:23:20,664 | server.py:226 | configure_fit: strategy sampled 5 clients (out of 5)
federated | INFO flwr 2024-11-04 18:27:04,537 | app.py:219 | Starting Flower simulation, config: num_rounds=10, no round_timeout
federated | INFO flwr 2024-11-04 18:27:06,605 | app.py:242 | Flower VCE: Ray initialized with resources: {'memory': 6852979917.0, 'GPU': 1.0, 'node:127.0.0.1': 1.0, 'CPU': 8.0, 'object_store_memory': 2147483648.0, 'node:__internal_head__': 1.0}
federated | INFO flwr 2024-11-04 18:27:06,605 | app.py:248 | Optimize your simulation with Flower VCE: https://flower.ai/docs/framework/how-to-run-simulations.html
federated | INFO flwr 2024-11-04 18:27:06,605 | app.py:271 | Flower VCE: Resources for each Virtual Client: {'num_cpus': 1, 'num_gpus': 0.2}
federated | INFO flwr 2024-11-04 18:27:06,613 | app.py:317 | Flower VCE: Creating VirtualClientEngineActorPool with 5 actors
federated | INFO flwr 2024-11-04 18:27:06,613 | server.py:92 | [INIT]
federated | INFO flwr 2024-11-04 18:27:06,613 | server.py:281 | Requesting initial parameters from one random client
federated | INFO flwr 2024-11-04 18:27:16,386 | server.py:288 | Received initial parameters from one random client
federated | INFO flwr 2024-11-04 18:27:16,386 | server.py:94 | Starting evaluation of initial global parameters
federated | INFO flwr 2024-11-04 18:27:20,373 | target_train.py:231 | Round 0 - Centralized evaluation accuracy: 0.0038, loss: 4.6051258290608725
federated | INFO flwr 2024-11-04 18:27:20,375 | server.py:97 | initial parameters (loss, other metrics): 4.6051258290608725, {'accuracy': 0.0038}
federated | INFO flwr 2024-11-04 18:27:20,375 | server.py:112 | 
federated | INFO flwr 2024-11-04 18:27:20,375 | server.py:113 | [ROUND 1]
federated | INFO flwr 2024-11-04 18:27:20,375 | server.py:226 | configure_fit: strategy sampled 5 clients (out of 5)
federated | INFO flwr 2024-11-04 19:01:11,568 | server.py:240 | aggregate_fit: received 5 results and 0 failures
federated | WARNING flwr 2024-11-04 19:01:11,644 | fedavg.py:252 | No fit_metrics_aggregation_fn provided
federated | INFO flwr 2024-11-04 19:01:15,813 | target_train.py:231 | Round 1 - Centralized evaluation accuracy: 0.26193333333333335, loss: 4.51189949874878
federated | INFO flwr 2024-11-04 19:01:15,814 | server.py:131 | fit progress: (1, 4.51189949874878, {'accuracy': 0.26193333333333335}, 2035.4244313340168)
federated | INFO flwr 2024-11-04 19:01:15,814 | server.py:178 | configure_evaluate: strategy sampled 5 clients (out of 5)
federated | INFO flwr 2024-11-04 19:03:14,035 | server.py:192 | aggregate_evaluate: received 5 results and 0 failures
federated | WARNING flwr 2024-11-04 19:03:14,037 | fedavg.py:283 | No evaluate_metrics_aggregation_fn provided
federated | INFO flwr 2024-11-04 19:03:14,037 | server.py:112 | 
federated | INFO flwr 2024-11-04 19:03:14,037 | server.py:113 | [ROUND 2]
federated | INFO flwr 2024-11-04 19:03:14,038 | server.py:226 | configure_fit: strategy sampled 5 clients (out of 5)
federated | INFO flwr 2024-11-04 19:37:26,362 | server.py:240 | aggregate_fit: received 5 results and 0 failures
federated | INFO flwr 2024-11-04 19:37:31,046 | target_train.py:231 | Round 2 - Centralized evaluation accuracy: 0.5833666666666667, loss: 4.038991187286377
federated | INFO flwr 2024-11-04 19:37:31,047 | server.py:131 | fit progress: (2, 4.038991187286377, {'accuracy': 0.5833666666666667}, 4210.629421584017)
federated | INFO flwr 2024-11-04 19:37:31,048 | server.py:178 | configure_evaluate: strategy sampled 5 clients (out of 5)
federated | INFO flwr 2024-11-04 20:01:10,427 | server.py:192 | aggregate_evaluate: received 5 results and 0 failures
federated | INFO flwr 2024-11-04 20:01:10,429 | server.py:112 | 
federated | INFO flwr 2024-11-04 20:01:10,429 | server.py:113 | [ROUND 3]
federated | INFO flwr 2024-11-04 20:01:10,429 | server.py:226 | configure_fit: strategy sampled 5 clients (out of 5)
federated | INFO flwr 2024-11-04 20:57:53,970 | server.py:240 | aggregate_fit: received 5 results and 0 failures
federated | INFO flwr 2024-11-04 20:57:58,029 | target_train.py:231 | Round 3 - Centralized evaluation accuracy: 0.5921666666666666, loss: 4.029981453831991
federated | INFO flwr 2024-11-04 20:57:58,030 | server.py:131 | fit progress: (3, 4.029981453831991, {'accuracy': 0.5921666666666666}, 7442.423573667009)
federated | INFO flwr 2024-11-04 20:57:58,030 | server.py:178 | configure_evaluate: strategy sampled 5 clients (out of 5)
federated | INFO flwr 2024-11-04 20:59:36,185 | server.py:192 | aggregate_evaluate: received 5 results and 0 failures
federated | INFO flwr 2024-11-04 20:59:36,189 | server.py:112 | 
federated | INFO flwr 2024-11-04 20:59:36,190 | server.py:113 | [ROUND 4]
federated | INFO flwr 2024-11-04 20:59:36,190 | server.py:226 | configure_fit: strategy sampled 5 clients (out of 5)
federated | INFO flwr 2024-11-04 21:32:20,375 | server.py:240 | aggregate_fit: received 5 results and 0 failures
federated | INFO flwr 2024-11-04 21:32:24,694 | target_train.py:231 | Round 4 - Centralized evaluation accuracy: 0.5924, loss: 4.029886232248942
federated | INFO flwr 2024-11-04 21:32:24,696 | server.py:131 | fit progress: (4, 4.029886232248942, {'accuracy': 0.5924}, 9509.078764959006)
federated | INFO flwr 2024-11-04 21:32:24,697 | server.py:178 | configure_evaluate: strategy sampled 5 clients (out of 5)
federated | INFO flwr 2024-11-04 21:33:52,783 | server.py:192 | aggregate_evaluate: received 5 results and 0 failures
federated | INFO flwr 2024-11-04 21:33:52,785 | server.py:112 | 
federated | INFO flwr 2024-11-04 21:33:52,785 | server.py:113 | [ROUND 5]
federated | INFO flwr 2024-11-04 21:33:52,785 | server.py:226 | configure_fit: strategy sampled 5 clients (out of 5)
federated | INFO flwr 2024-11-04 22:07:16,530 | server.py:240 | aggregate_fit: received 5 results and 0 failures
federated | INFO flwr 2024-11-04 22:07:20,665 | target_train.py:231 | Round 5 - Centralized evaluation accuracy: 0.5908333333333333, loss: 4.031276916122437
federated | INFO flwr 2024-11-04 22:07:20,667 | server.py:131 | fit progress: (5, 4.031276916122437, {'accuracy': 0.5908333333333333}, 11605.033809375018)
federated | INFO flwr 2024-11-04 22:07:20,667 | server.py:178 | configure_evaluate: strategy sampled 5 clients (out of 5)
federated | INFO flwr 2024-11-04 22:08:43,799 | server.py:192 | aggregate_evaluate: received 5 results and 0 failures
federated | INFO flwr 2024-11-04 22:08:43,801 | server.py:112 | 
federated | INFO flwr 2024-11-04 22:08:43,801 | server.py:113 | [ROUND 6]
federated | INFO flwr 2024-11-04 22:08:43,801 | server.py:226 | configure_fit: strategy sampled 5 clients (out of 5)
federated | INFO flwr 2024-11-04 22:41:39,492 | server.py:240 | aggregate_fit: received 5 results and 0 failures
federated | INFO flwr 2024-11-04 22:41:43,350 | target_train.py:231 | Round 6 - Centralized evaluation accuracy: 0.5944333333333334, loss: 4.027829882685343
federated | INFO flwr 2024-11-04 22:41:43,350 | server.py:131 | fit progress: (6, 4.027829882685343, {'accuracy': 0.5944333333333334}, 13667.70884524996)
federated | INFO flwr 2024-11-04 22:41:43,350 | server.py:178 | configure_evaluate: strategy sampled 5 clients (out of 5)
federated | INFO flwr 2024-11-04 22:43:15,591 | server.py:192 | aggregate_evaluate: received 5 results and 0 failures
federated | INFO flwr 2024-11-04 22:43:15,592 | server.py:112 | 
federated | INFO flwr 2024-11-04 22:43:15,592 | server.py:113 | [ROUND 7]
federated | INFO flwr 2024-11-04 22:43:15,593 | server.py:226 | configure_fit: strategy sampled 5 clients (out of 5)
federated | INFO flwr 2024-11-04 23:18:56,623 | server.py:240 | aggregate_fit: received 5 results and 0 failures
federated | INFO flwr 2024-11-04 23:19:00,854 | target_train.py:231 | Round 7 - Centralized evaluation accuracy: 0.5904333333333334, loss: 4.0318502414703365
federated | INFO flwr 2024-11-04 23:19:00,856 | server.py:131 | fit progress: (7, 4.0318502414703365, {'accuracy': 0.5904333333333334}, 15905.235805958975)
federated | INFO flwr 2024-11-04 23:19:00,856 | server.py:178 | configure_evaluate: strategy sampled 5 clients (out of 5)
federated | INFO flwr 2024-11-04 23:20:46,279 | server.py:192 | aggregate_evaluate: received 5 results and 0 failures
federated | INFO flwr 2024-11-04 23:20:46,280 | server.py:112 | 
federated | INFO flwr 2024-11-04 23:20:46,280 | server.py:113 | [ROUND 8]
federated | INFO flwr 2024-11-04 23:20:46,280 | server.py:226 | configure_fit: strategy sampled 5 clients (out of 5)
federated | INFO flwr 2024-11-04 23:55:34,809 | server.py:240 | aggregate_fit: received 5 results and 0 failures
federated | INFO flwr 2024-11-04 23:55:38,873 | target_train.py:231 | Round 8 - Centralized evaluation accuracy: 0.5906666666666667, loss: 4.031540450541178
federated | INFO flwr 2024-11-04 23:55:38,875 | server.py:131 | fit progress: (8, 4.031540450541178, {'accuracy': 0.5906666666666667}, 18103.229919167003)
federated | INFO flwr 2024-11-04 23:55:38,918 | server.py:178 | configure_evaluate: strategy sampled 5 clients (out of 5)
federated | INFO flwr 2024-11-04 23:57:14,689 | server.py:192 | aggregate_evaluate: received 5 results and 0 failures
federated | INFO flwr 2024-11-04 23:57:14,690 | server.py:112 | 
federated | INFO flwr 2024-11-04 23:57:14,690 | server.py:113 | [ROUND 9]
federated | INFO flwr 2024-11-04 23:57:14,690 | server.py:226 | configure_fit: strategy sampled 5 clients (out of 5)
federated | INFO flwr 2024-11-05 00:30:30,891 | server.py:240 | aggregate_fit: received 5 results and 0 failures
federated | INFO flwr 2024-11-05 00:30:34,833 | target_train.py:231 | Round 9 - Centralized evaluation accuracy: 0.594, loss: 4.028115375137329
federated | INFO flwr 2024-11-05 00:30:34,835 | server.py:131 | fit progress: (9, 4.028115375137329, {'accuracy': 0.594}, 20199.151616459014)
federated | INFO flwr 2024-11-05 00:30:34,835 | server.py:178 | configure_evaluate: strategy sampled 5 clients (out of 5)
federated | INFO flwr 2024-11-05 00:32:14,539 | server.py:192 | aggregate_evaluate: received 5 results and 0 failures
federated | INFO flwr 2024-11-05 00:32:14,540 | server.py:112 | 
federated | INFO flwr 2024-11-05 00:32:14,540 | server.py:113 | [ROUND 10]
federated | INFO flwr 2024-11-05 00:32:14,540 | server.py:226 | configure_fit: strategy sampled 5 clients (out of 5)
federated | INFO flwr 2024-11-05 05:09:08,044 | server.py:240 | aggregate_fit: received 5 results and 0 failures
federated | INFO flwr 2024-11-05 05:09:12,081 | target_train.py:231 | Round 10 - Centralized evaluation accuracy: 0.5914666666666667, loss: 4.030714644241333
federated | INFO flwr 2024-11-05 05:09:12,083 | server.py:131 | fit progress: (10, 4.030714644241333, {'accuracy': 0.5914666666666667}, 36916.35958591697)
federated | INFO flwr 2024-11-05 05:09:12,083 | server.py:178 | configure_evaluate: strategy sampled 5 clients (out of 5)
federated | INFO flwr 2024-11-05 05:10:46,813 | server.py:192 | aggregate_evaluate: received 5 results and 0 failures
federated | INFO flwr 2024-11-05 05:10:46,831 | server.py:496 | 
federated | INFO flwr 2024-11-05 05:10:46,831 | server.py:497 | [SUMMARY]
federated | INFO flwr 2024-11-05 05:10:46,832 | server.py:498 | Run finished 10 round(s) in 37011.09s
federated | INFO flwr 2024-11-05 05:10:46,832 | server.py:500 | 	History (loss, distributed):
federated | INFO flwr 2024-11-05 05:10:46,832 | server.py:500 | 		round 1: 0.3096
federated | INFO flwr 2024-11-05 05:10:46,832 | server.py:500 | 		round 2: 0.8134666666666667
federated | INFO flwr 2024-11-05 05:10:46,832 | server.py:500 | 		round 3: 0.8541333333333333
federated | INFO flwr 2024-11-05 05:10:46,832 | server.py:500 | 		round 4: 0.8656
federated | INFO flwr 2024-11-05 05:10:46,832 | server.py:500 | 		round 5: 0.8674666666666667
federated | INFO flwr 2024-11-05 05:10:46,832 | server.py:500 | 		round 6: 0.8683666666666666
federated | INFO flwr 2024-11-05 05:10:46,832 | server.py:500 | 		round 7: 0.869
federated | INFO flwr 2024-11-05 05:10:46,832 | server.py:500 | 		round 8: 0.8695333333333334
federated | INFO flwr 2024-11-05 05:10:46,832 | server.py:500 | 		round 9: 0.8699333333333333
federated | INFO flwr 2024-11-05 05:10:46,832 | server.py:500 | 		round 10: 0.8702666666666666
federated | INFO flwr 2024-11-05 05:10:46,832 | server.py:500 | 	History (loss, centralized):
federated | INFO flwr 2024-11-05 05:10:46,832 | server.py:500 | 		round 0: 4.6051258290608725
federated | INFO flwr 2024-11-05 05:10:46,832 | server.py:500 | 		round 1: 4.51189949874878
federated | INFO flwr 2024-11-05 05:10:46,832 | server.py:500 | 		round 2: 4.038991187286377
federated | INFO flwr 2024-11-05 05:10:46,833 | server.py:500 | 		round 3: 4.029981453831991
federated | INFO flwr 2024-11-05 05:10:46,833 | server.py:500 | 		round 4: 4.029886232248942
federated | INFO flwr 2024-11-05 05:10:46,833 | server.py:500 | 		round 5: 4.031276916122437
federated | INFO flwr 2024-11-05 05:10:46,833 | server.py:500 | 		round 6: 4.027829882685343
federated | INFO flwr 2024-11-05 05:10:46,833 | server.py:500 | 		round 7: 4.0318502414703365
federated | INFO flwr 2024-11-05 05:10:46,833 | server.py:500 | 		round 8: 4.031540450541178
federated | INFO flwr 2024-11-05 05:10:46,833 | server.py:500 | 		round 9: 4.028115375137329
federated | INFO flwr 2024-11-05 05:10:46,833 | server.py:500 | 		round 10: 4.030714644241333
federated | INFO flwr 2024-11-05 05:10:46,833 | server.py:500 | 	History (metrics, centralized):
federated | INFO flwr 2024-11-05 05:10:46,833 | server.py:500 | 	{'accuracy': [(0, 0.0038),
federated | INFO flwr 2024-11-05 05:10:46,833 | server.py:500 | 	              (1, 0.26193333333333335),
federated | INFO flwr 2024-11-05 05:10:46,833 | server.py:500 | 	              (2, 0.5833666666666667),
federated | INFO flwr 2024-11-05 05:10:46,833 | server.py:500 | 	              (3, 0.5921666666666666),
federated | INFO flwr 2024-11-05 05:10:46,833 | server.py:500 | 	              (4, 0.5924),
federated | INFO flwr 2024-11-05 05:10:46,833 | server.py:500 | 	              (5, 0.5908333333333333),
federated | INFO flwr 2024-11-05 05:10:46,833 | server.py:500 | 	              (6, 0.5944333333333334),
federated | INFO flwr 2024-11-05 05:10:46,833 | server.py:500 | 	              (7, 0.5904333333333334),
federated | INFO flwr 2024-11-05 05:10:46,833 | server.py:500 | 	              (8, 0.5906666666666667),
federated | INFO flwr 2024-11-05 05:10:46,834 | server.py:500 | 	              (9, 0.594),
federated | INFO flwr 2024-11-05 05:10:46,834 | server.py:500 | 	              (10, 0.5914666666666667)]}
federated | INFO flwr 2024-11-05 05:10:46,834 | server.py:501 | 
federated | INFO flwr 2024-11-08 16:41:35,378 | app.py:219 | Starting Flower simulation, config: num_rounds=10, no round_timeout
federated | INFO flwr 2024-11-08 16:41:37,748 | app.py:242 | Flower VCE: Ray initialized with resources: {'CPU': 8.0, 'node:127.0.0.1': 1.0, 'object_store_memory': 2147483648.0, 'node:__internal_head__': 1.0, 'memory': 7508982170.0}
federated | INFO flwr 2024-11-08 16:41:37,748 | app.py:248 | Optimize your simulation with Flower VCE: https://flower.ai/docs/framework/how-to-run-simulations.html
federated | INFO flwr 2024-11-08 16:41:37,748 | app.py:256 | No `client_resources` specified. Using minimal resources for clients.
federated | INFO flwr 2024-11-08 16:41:37,748 | app.py:271 | Flower VCE: Resources for each Virtual Client: {'num_cpus': 1, 'num_gpus': 0.0}
federated | INFO flwr 2024-11-08 16:41:37,761 | app.py:317 | Flower VCE: Creating VirtualClientEngineActorPool with 8 actors
federated | INFO flwr 2024-11-08 16:41:37,761 | server.py:92 | [INIT]
federated | INFO flwr 2024-11-08 16:41:37,761 | server.py:281 | Requesting initial parameters from one random client
federated | INFO flwr 2024-11-08 16:41:44,888 | server.py:288 | Received initial parameters from one random client
federated | INFO flwr 2024-11-08 16:41:44,889 | server.py:94 | Starting evaluation of initial global parameters
federated | INFO flwr 2024-11-08 16:41:44,889 | server.py:106 | Evaluation returned no results (`None`)
federated | INFO flwr 2024-11-08 16:41:44,889 | server.py:112 | 
federated | INFO flwr 2024-11-08 16:41:44,889 | server.py:113 | [ROUND 1]
federated | INFO flwr 2024-11-08 16:41:44,890 | server.py:226 | configure_fit: strategy sampled 5 clients (out of 5)
federated | ERROR flwr 2024-11-08 16:42:02,807 | ray_client_proxy.py:106 | Traceback (most recent call last):
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 94, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 398, in get_client_result
    return self._fetch_future_result(cid)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 279, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
                                         ^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=7456, ip=127.0.0.1, actor_id=bea7c9a2f8df3a5d3039161001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x100c53850>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/message_handler/message_handler.py", line 129, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
              ^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client.py", line 255, in maybe_call_fit
    return client.fit(fit_ins)
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 259, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/texas100/globalattack.py", line 115, in fit
    loss = self.criterion(outputs, y)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/loss.py", line 1188, in forward
    return F.cross_entropy(input, target, weight=self.weight,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/functional.py", line 3104, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected floating point type for target with class probabilities, got Long

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=7456, ip=127.0.0.1, actor_id=bea7c9a2f8df3a5d3039161001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x100c53850>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Expected floating point type for target with class probabilities, got Long

federated | ERROR flwr 2024-11-08 16:42:02,808 | ray_client_proxy.py:106 | Traceback (most recent call last):
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 94, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 398, in get_client_result
    return self._fetch_future_result(cid)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 279, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
                                         ^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=7457, ip=127.0.0.1, actor_id=d8cd0c8a6770c4a59324b50101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x16ee1dc90>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/message_handler/message_handler.py", line 129, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
              ^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client.py", line 255, in maybe_call_fit
    return client.fit(fit_ins)
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 259, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/texas100/globalattack.py", line 115, in fit
    loss = self.criterion(outputs, y)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/loss.py", line 1188, in forward
    return F.cross_entropy(input, target, weight=self.weight,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/functional.py", line 3104, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected floating point type for target with class probabilities, got Long

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=7457, ip=127.0.0.1, actor_id=d8cd0c8a6770c4a59324b50101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x16ee1dc90>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Expected floating point type for target with class probabilities, got Long

federated | ERROR flwr 2024-11-08 16:42:02,808 | ray_client_proxy.py:106 | Traceback (most recent call last):
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 94, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 398, in get_client_result
    return self._fetch_future_result(cid)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 279, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
                                         ^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=7459, ip=127.0.0.1, actor_id=d5f5709c7c2075c1494c0cd101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x104d41d10>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/message_handler/message_handler.py", line 129, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
              ^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client.py", line 255, in maybe_call_fit
    return client.fit(fit_ins)
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 259, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/texas100/globalattack.py", line 115, in fit
    loss = self.criterion(outputs, y)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/loss.py", line 1188, in forward
    return F.cross_entropy(input, target, weight=self.weight,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/functional.py", line 3104, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected floating point type for target with class probabilities, got Long

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=7459, ip=127.0.0.1, actor_id=d5f5709c7c2075c1494c0cd101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x104d41d10>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Expected floating point type for target with class probabilities, got Long

federated | ERROR flwr 2024-11-08 16:42:02,809 | ray_client_proxy.py:106 | Traceback (most recent call last):
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 94, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 398, in get_client_result
    return self._fetch_future_result(cid)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 279, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
                                         ^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=7458, ip=127.0.0.1, actor_id=267f550c66ad5dc367d35d5601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x104fa1190>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/message_handler/message_handler.py", line 129, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
              ^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client.py", line 255, in maybe_call_fit
    return client.fit(fit_ins)
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 259, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/texas100/globalattack.py", line 115, in fit
    loss = self.criterion(outputs, y)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/loss.py", line 1188, in forward
    return F.cross_entropy(input, target, weight=self.weight,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/functional.py", line 3104, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected floating point type for target with class probabilities, got Long

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=7458, ip=127.0.0.1, actor_id=267f550c66ad5dc367d35d5601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x104fa1190>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Expected floating point type for target with class probabilities, got Long

federated | ERROR flwr 2024-11-08 16:42:02,812 | ray_client_proxy.py:107 | [36mray::ClientAppActor.run()[39m (pid=7456, ip=127.0.0.1, actor_id=bea7c9a2f8df3a5d3039161001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x100c53850>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/message_handler/message_handler.py", line 129, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
              ^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client.py", line 255, in maybe_call_fit
    return client.fit(fit_ins)
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 259, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/texas100/globalattack.py", line 115, in fit
    loss = self.criterion(outputs, y)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/loss.py", line 1188, in forward
    return F.cross_entropy(input, target, weight=self.weight,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/functional.py", line 3104, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected floating point type for target with class probabilities, got Long

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=7456, ip=127.0.0.1, actor_id=bea7c9a2f8df3a5d3039161001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x100c53850>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Expected floating point type for target with class probabilities, got Long
federated | ERROR flwr 2024-11-08 16:42:02,812 | ray_client_proxy.py:107 | [36mray::ClientAppActor.run()[39m (pid=7457, ip=127.0.0.1, actor_id=d8cd0c8a6770c4a59324b50101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x16ee1dc90>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/message_handler/message_handler.py", line 129, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
              ^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client.py", line 255, in maybe_call_fit
    return client.fit(fit_ins)
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 259, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/texas100/globalattack.py", line 115, in fit
    loss = self.criterion(outputs, y)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/loss.py", line 1188, in forward
    return F.cross_entropy(input, target, weight=self.weight,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/functional.py", line 3104, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected floating point type for target with class probabilities, got Long

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=7457, ip=127.0.0.1, actor_id=d8cd0c8a6770c4a59324b50101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x16ee1dc90>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Expected floating point type for target with class probabilities, got Long
federated | ERROR flwr 2024-11-08 16:42:02,812 | ray_client_proxy.py:107 | [36mray::ClientAppActor.run()[39m (pid=7459, ip=127.0.0.1, actor_id=d5f5709c7c2075c1494c0cd101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x104d41d10>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/message_handler/message_handler.py", line 129, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
              ^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client.py", line 255, in maybe_call_fit
    return client.fit(fit_ins)
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 259, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/texas100/globalattack.py", line 115, in fit
    loss = self.criterion(outputs, y)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/loss.py", line 1188, in forward
    return F.cross_entropy(input, target, weight=self.weight,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/functional.py", line 3104, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected floating point type for target with class probabilities, got Long

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=7459, ip=127.0.0.1, actor_id=d5f5709c7c2075c1494c0cd101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x104d41d10>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Expected floating point type for target with class probabilities, got Long
federated | ERROR flwr 2024-11-08 16:42:02,812 | ray_client_proxy.py:107 | [36mray::ClientAppActor.run()[39m (pid=7458, ip=127.0.0.1, actor_id=267f550c66ad5dc367d35d5601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x104fa1190>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/message_handler/message_handler.py", line 129, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
              ^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client.py", line 255, in maybe_call_fit
    return client.fit(fit_ins)
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 259, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/texas100/globalattack.py", line 115, in fit
    loss = self.criterion(outputs, y)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/loss.py", line 1188, in forward
    return F.cross_entropy(input, target, weight=self.weight,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/functional.py", line 3104, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected floating point type for target with class probabilities, got Long

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=7458, ip=127.0.0.1, actor_id=267f550c66ad5dc367d35d5601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x104fa1190>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Expected floating point type for target with class probabilities, got Long
federated | ERROR flwr 2024-11-08 16:42:04,444 | ray_client_proxy.py:106 | Traceback (most recent call last):
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 94, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 398, in get_client_result
    return self._fetch_future_result(cid)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 279, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
                                         ^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=7455, ip=127.0.0.1, actor_id=2e691067daf42eaca771f11601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x103453710>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/message_handler/message_handler.py", line 129, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
              ^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client.py", line 255, in maybe_call_fit
    return client.fit(fit_ins)
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 259, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/texas100/globalattack.py", line 115, in fit
    loss = self.criterion(outputs, y)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/loss.py", line 1188, in forward
    return F.cross_entropy(input, target, weight=self.weight,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/functional.py", line 3104, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected floating point type for target with class probabilities, got Long

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=7455, ip=127.0.0.1, actor_id=2e691067daf42eaca771f11601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x103453710>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Expected floating point type for target with class probabilities, got Long

federated | ERROR flwr 2024-11-08 16:42:04,444 | ray_client_proxy.py:107 | [36mray::ClientAppActor.run()[39m (pid=7455, ip=127.0.0.1, actor_id=2e691067daf42eaca771f11601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x103453710>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/message_handler/message_handler.py", line 129, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
              ^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client.py", line 255, in maybe_call_fit
    return client.fit(fit_ins)
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 259, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/texas100/globalattack.py", line 115, in fit
    loss = self.criterion(outputs, y)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/loss.py", line 1188, in forward
    return F.cross_entropy(input, target, weight=self.weight,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/functional.py", line 3104, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected floating point type for target with class probabilities, got Long

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=7455, ip=127.0.0.1, actor_id=2e691067daf42eaca771f11601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x103453710>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Expected floating point type for target with class probabilities, got Long
federated | INFO flwr 2024-11-08 16:42:04,444 | server.py:240 | aggregate_fit: received 0 results and 5 failures
federated | INFO flwr 2024-11-08 16:42:04,445 | server.py:178 | configure_evaluate: strategy sampled 5 clients (out of 5)
federated | ERROR flwr 2024-11-08 16:42:21,865 | ray_client_proxy.py:106 | Traceback (most recent call last):
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 94, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 398, in get_client_result
    return self._fetch_future_result(cid)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 279, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
                                         ^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=7455, ip=127.0.0.1, actor_id=2e691067daf42eaca771f11601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x103453710>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/message_handler/message_handler.py", line 136, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
                   ^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client.py", line 275, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 283, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/texas100/globalattack.py", line 129, in evaluate
    correct += (predicted == y).sum().item()
                ^^^^^^^^^^^^^^
RuntimeError: The size of tensor a (64) must match the size of tensor b (100) at non-singleton dimension 1

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=7455, ip=127.0.0.1, actor_id=2e691067daf42eaca771f11601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x103453710>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: The size of tensor a (64) must match the size of tensor b (100) at non-singleton dimension 1

federated | ERROR flwr 2024-11-08 16:42:21,867 | ray_client_proxy.py:106 | Traceback (most recent call last):
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 94, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 398, in get_client_result
    return self._fetch_future_result(cid)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 279, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
                                         ^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=7457, ip=127.0.0.1, actor_id=d8cd0c8a6770c4a59324b50101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x16ee1dc90>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/message_handler/message_handler.py", line 136, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
                   ^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client.py", line 275, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 283, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/texas100/globalattack.py", line 129, in evaluate
    correct += (predicted == y).sum().item()
                ^^^^^^^^^^^^^^
RuntimeError: The size of tensor a (64) must match the size of tensor b (100) at non-singleton dimension 1

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=7457, ip=127.0.0.1, actor_id=d8cd0c8a6770c4a59324b50101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x16ee1dc90>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: The size of tensor a (64) must match the size of tensor b (100) at non-singleton dimension 1

federated | ERROR flwr 2024-11-08 16:42:21,867 | ray_client_proxy.py:106 | Traceback (most recent call last):
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 94, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 398, in get_client_result
    return self._fetch_future_result(cid)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 279, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
                                         ^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=7458, ip=127.0.0.1, actor_id=267f550c66ad5dc367d35d5601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x104fa1190>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/message_handler/message_handler.py", line 136, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
                   ^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client.py", line 275, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 283, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/texas100/globalattack.py", line 129, in evaluate
    correct += (predicted == y).sum().item()
                ^^^^^^^^^^^^^^
RuntimeError: The size of tensor a (64) must match the size of tensor b (100) at non-singleton dimension 1

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=7458, ip=127.0.0.1, actor_id=267f550c66ad5dc367d35d5601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x104fa1190>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: The size of tensor a (64) must match the size of tensor b (100) at non-singleton dimension 1

federated | ERROR flwr 2024-11-08 16:42:21,867 | ray_client_proxy.py:106 | Traceback (most recent call last):
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 94, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 398, in get_client_result
    return self._fetch_future_result(cid)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 279, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
                                         ^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=7456, ip=127.0.0.1, actor_id=bea7c9a2f8df3a5d3039161001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x100c53850>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/message_handler/message_handler.py", line 136, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
                   ^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client.py", line 275, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 283, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/texas100/globalattack.py", line 129, in evaluate
    correct += (predicted == y).sum().item()
                ^^^^^^^^^^^^^^
RuntimeError: The size of tensor a (64) must match the size of tensor b (100) at non-singleton dimension 1

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=7456, ip=127.0.0.1, actor_id=bea7c9a2f8df3a5d3039161001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x100c53850>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: The size of tensor a (64) must match the size of tensor b (100) at non-singleton dimension 1

federated | ERROR flwr 2024-11-08 16:42:21,867 | ray_client_proxy.py:107 | [36mray::ClientAppActor.run()[39m (pid=7455, ip=127.0.0.1, actor_id=2e691067daf42eaca771f11601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x103453710>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/message_handler/message_handler.py", line 136, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
                   ^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client.py", line 275, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 283, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/texas100/globalattack.py", line 129, in evaluate
    correct += (predicted == y).sum().item()
                ^^^^^^^^^^^^^^
RuntimeError: The size of tensor a (64) must match the size of tensor b (100) at non-singleton dimension 1

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=7455, ip=127.0.0.1, actor_id=2e691067daf42eaca771f11601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x103453710>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: The size of tensor a (64) must match the size of tensor b (100) at non-singleton dimension 1
federated | ERROR flwr 2024-11-08 16:42:21,867 | ray_client_proxy.py:107 | [36mray::ClientAppActor.run()[39m (pid=7457, ip=127.0.0.1, actor_id=d8cd0c8a6770c4a59324b50101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x16ee1dc90>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/message_handler/message_handler.py", line 136, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
                   ^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client.py", line 275, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 283, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/texas100/globalattack.py", line 129, in evaluate
    correct += (predicted == y).sum().item()
                ^^^^^^^^^^^^^^
RuntimeError: The size of tensor a (64) must match the size of tensor b (100) at non-singleton dimension 1

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=7457, ip=127.0.0.1, actor_id=d8cd0c8a6770c4a59324b50101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x16ee1dc90>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: The size of tensor a (64) must match the size of tensor b (100) at non-singleton dimension 1
federated | ERROR flwr 2024-11-08 16:42:21,867 | ray_client_proxy.py:107 | [36mray::ClientAppActor.run()[39m (pid=7458, ip=127.0.0.1, actor_id=267f550c66ad5dc367d35d5601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x104fa1190>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/message_handler/message_handler.py", line 136, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
                   ^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client.py", line 275, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 283, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/texas100/globalattack.py", line 129, in evaluate
    correct += (predicted == y).sum().item()
                ^^^^^^^^^^^^^^
RuntimeError: The size of tensor a (64) must match the size of tensor b (100) at non-singleton dimension 1

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=7458, ip=127.0.0.1, actor_id=267f550c66ad5dc367d35d5601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x104fa1190>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: The size of tensor a (64) must match the size of tensor b (100) at non-singleton dimension 1
federated | ERROR flwr 2024-11-08 16:42:21,867 | ray_client_proxy.py:107 | [36mray::ClientAppActor.run()[39m (pid=7456, ip=127.0.0.1, actor_id=bea7c9a2f8df3a5d3039161001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x100c53850>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/message_handler/message_handler.py", line 136, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
                   ^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client.py", line 275, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 283, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/texas100/globalattack.py", line 129, in evaluate
    correct += (predicted == y).sum().item()
                ^^^^^^^^^^^^^^
RuntimeError: The size of tensor a (64) must match the size of tensor b (100) at non-singleton dimension 1

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=7456, ip=127.0.0.1, actor_id=bea7c9a2f8df3a5d3039161001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x100c53850>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: The size of tensor a (64) must match the size of tensor b (100) at non-singleton dimension 1
federated | ERROR flwr 2024-11-08 16:42:22,578 | ray_client_proxy.py:106 | Traceback (most recent call last):
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 94, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 398, in get_client_result
    return self._fetch_future_result(cid)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 279, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
                                         ^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=7459, ip=127.0.0.1, actor_id=d5f5709c7c2075c1494c0cd101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x104d41d10>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/message_handler/message_handler.py", line 136, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
                   ^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client.py", line 275, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 283, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/texas100/globalattack.py", line 129, in evaluate
    correct += (predicted == y).sum().item()
                ^^^^^^^^^^^^^^
RuntimeError: The size of tensor a (64) must match the size of tensor b (100) at non-singleton dimension 1

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=7459, ip=127.0.0.1, actor_id=d5f5709c7c2075c1494c0cd101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x104d41d10>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: The size of tensor a (64) must match the size of tensor b (100) at non-singleton dimension 1

federated | ERROR flwr 2024-11-08 16:42:22,578 | ray_client_proxy.py:107 | [36mray::ClientAppActor.run()[39m (pid=7459, ip=127.0.0.1, actor_id=d5f5709c7c2075c1494c0cd101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x104d41d10>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/message_handler/message_handler.py", line 136, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
                   ^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client.py", line 275, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 283, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/texas100/globalattack.py", line 129, in evaluate
    correct += (predicted == y).sum().item()
                ^^^^^^^^^^^^^^
RuntimeError: The size of tensor a (64) must match the size of tensor b (100) at non-singleton dimension 1

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=7459, ip=127.0.0.1, actor_id=d5f5709c7c2075c1494c0cd101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x104d41d10>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: The size of tensor a (64) must match the size of tensor b (100) at non-singleton dimension 1
federated | INFO flwr 2024-11-08 16:42:22,579 | server.py:192 | aggregate_evaluate: received 0 results and 5 failures
federated | INFO flwr 2024-11-08 16:42:22,579 | server.py:112 | 
federated | INFO flwr 2024-11-08 16:42:22,579 | server.py:113 | [ROUND 2]
federated | INFO flwr 2024-11-08 16:42:22,579 | server.py:226 | configure_fit: strategy sampled 5 clients (out of 5)
federated | ERROR flwr 2024-11-08 16:42:36,785 | ray_client_proxy.py:106 | Traceback (most recent call last):
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 94, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 398, in get_client_result
    return self._fetch_future_result(cid)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 279, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
                                         ^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=7459, ip=127.0.0.1, actor_id=d5f5709c7c2075c1494c0cd101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x104d41d10>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/message_handler/message_handler.py", line 129, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
              ^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client.py", line 255, in maybe_call_fit
    return client.fit(fit_ins)
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 259, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/texas100/globalattack.py", line 115, in fit
    loss = self.criterion(outputs, y)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/loss.py", line 1188, in forward
    return F.cross_entropy(input, target, weight=self.weight,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/functional.py", line 3104, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected floating point type for target with class probabilities, got Long

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=7459, ip=127.0.0.1, actor_id=d5f5709c7c2075c1494c0cd101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x104d41d10>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Expected floating point type for target with class probabilities, got Long

federated | ERROR flwr 2024-11-08 16:42:36,787 | ray_client_proxy.py:106 | Traceback (most recent call last):
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 94, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 398, in get_client_result
    return self._fetch_future_result(cid)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 279, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
                                         ^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=7458, ip=127.0.0.1, actor_id=267f550c66ad5dc367d35d5601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x104fa1190>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/message_handler/message_handler.py", line 129, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
              ^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client.py", line 255, in maybe_call_fit
    return client.fit(fit_ins)
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 259, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/texas100/globalattack.py", line 115, in fit
    loss = self.criterion(outputs, y)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/loss.py", line 1188, in forward
    return F.cross_entropy(input, target, weight=self.weight,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/functional.py", line 3104, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected floating point type for target with class probabilities, got Long

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=7458, ip=127.0.0.1, actor_id=267f550c66ad5dc367d35d5601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x104fa1190>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Expected floating point type for target with class probabilities, got Long

federated | ERROR flwr 2024-11-08 16:42:36,788 | ray_client_proxy.py:106 | Traceback (most recent call last):
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 94, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 398, in get_client_result
    return self._fetch_future_result(cid)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 279, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
                                         ^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=7457, ip=127.0.0.1, actor_id=d8cd0c8a6770c4a59324b50101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x16ee1dc90>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/message_handler/message_handler.py", line 129, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
              ^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client.py", line 255, in maybe_call_fit
    return client.fit(fit_ins)
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 259, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/texas100/globalattack.py", line 115, in fit
    loss = self.criterion(outputs, y)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/loss.py", line 1188, in forward
    return F.cross_entropy(input, target, weight=self.weight,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/functional.py", line 3104, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected floating point type for target with class probabilities, got Long

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=7457, ip=127.0.0.1, actor_id=d8cd0c8a6770c4a59324b50101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x16ee1dc90>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Expected floating point type for target with class probabilities, got Long

federated | ERROR flwr 2024-11-08 16:42:36,788 | ray_client_proxy.py:107 | [36mray::ClientAppActor.run()[39m (pid=7459, ip=127.0.0.1, actor_id=d5f5709c7c2075c1494c0cd101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x104d41d10>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/message_handler/message_handler.py", line 129, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
              ^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client.py", line 255, in maybe_call_fit
    return client.fit(fit_ins)
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 259, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/texas100/globalattack.py", line 115, in fit
    loss = self.criterion(outputs, y)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/loss.py", line 1188, in forward
    return F.cross_entropy(input, target, weight=self.weight,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/functional.py", line 3104, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected floating point type for target with class probabilities, got Long

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=7459, ip=127.0.0.1, actor_id=d5f5709c7c2075c1494c0cd101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x104d41d10>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Expected floating point type for target with class probabilities, got Long
federated | ERROR flwr 2024-11-08 16:42:36,788 | ray_client_proxy.py:107 | [36mray::ClientAppActor.run()[39m (pid=7458, ip=127.0.0.1, actor_id=267f550c66ad5dc367d35d5601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x104fa1190>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/message_handler/message_handler.py", line 129, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
              ^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client.py", line 255, in maybe_call_fit
    return client.fit(fit_ins)
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 259, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/texas100/globalattack.py", line 115, in fit
    loss = self.criterion(outputs, y)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/loss.py", line 1188, in forward
    return F.cross_entropy(input, target, weight=self.weight,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/functional.py", line 3104, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected floating point type for target with class probabilities, got Long

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=7458, ip=127.0.0.1, actor_id=267f550c66ad5dc367d35d5601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x104fa1190>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Expected floating point type for target with class probabilities, got Long
federated | ERROR flwr 2024-11-08 16:42:36,788 | ray_client_proxy.py:107 | [36mray::ClientAppActor.run()[39m (pid=7457, ip=127.0.0.1, actor_id=d8cd0c8a6770c4a59324b50101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x16ee1dc90>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/message_handler/message_handler.py", line 129, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
              ^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client.py", line 255, in maybe_call_fit
    return client.fit(fit_ins)
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 259, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/texas100/globalattack.py", line 115, in fit
    loss = self.criterion(outputs, y)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/loss.py", line 1188, in forward
    return F.cross_entropy(input, target, weight=self.weight,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/functional.py", line 3104, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected floating point type for target with class probabilities, got Long

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=7457, ip=127.0.0.1, actor_id=d8cd0c8a6770c4a59324b50101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x16ee1dc90>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Expected floating point type for target with class probabilities, got Long
federated | ERROR flwr 2024-11-08 16:42:38,306 | ray_client_proxy.py:106 | Traceback (most recent call last):
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 94, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 398, in get_client_result
    return self._fetch_future_result(cid)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 279, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
                                         ^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=7456, ip=127.0.0.1, actor_id=bea7c9a2f8df3a5d3039161001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x100c53850>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/message_handler/message_handler.py", line 129, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
              ^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client.py", line 255, in maybe_call_fit
    return client.fit(fit_ins)
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 259, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/texas100/globalattack.py", line 115, in fit
    loss = self.criterion(outputs, y)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/loss.py", line 1188, in forward
    return F.cross_entropy(input, target, weight=self.weight,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/functional.py", line 3104, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected floating point type for target with class probabilities, got Long

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=7456, ip=127.0.0.1, actor_id=bea7c9a2f8df3a5d3039161001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x100c53850>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Expected floating point type for target with class probabilities, got Long

federated | ERROR flwr 2024-11-08 16:42:38,308 | ray_client_proxy.py:106 | Traceback (most recent call last):
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 94, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 398, in get_client_result
    return self._fetch_future_result(cid)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 279, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
                                         ^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=7455, ip=127.0.0.1, actor_id=2e691067daf42eaca771f11601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x103453710>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/message_handler/message_handler.py", line 129, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
              ^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client.py", line 255, in maybe_call_fit
    return client.fit(fit_ins)
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 259, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/texas100/globalattack.py", line 115, in fit
    loss = self.criterion(outputs, y)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/loss.py", line 1188, in forward
    return F.cross_entropy(input, target, weight=self.weight,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/functional.py", line 3104, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected floating point type for target with class probabilities, got Long

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=7455, ip=127.0.0.1, actor_id=2e691067daf42eaca771f11601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x103453710>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Expected floating point type for target with class probabilities, got Long

federated | ERROR flwr 2024-11-08 16:42:38,310 | ray_client_proxy.py:107 | [36mray::ClientAppActor.run()[39m (pid=7456, ip=127.0.0.1, actor_id=bea7c9a2f8df3a5d3039161001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x100c53850>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/message_handler/message_handler.py", line 129, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
              ^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client.py", line 255, in maybe_call_fit
    return client.fit(fit_ins)
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 259, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/texas100/globalattack.py", line 115, in fit
    loss = self.criterion(outputs, y)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/loss.py", line 1188, in forward
    return F.cross_entropy(input, target, weight=self.weight,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/functional.py", line 3104, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected floating point type for target with class probabilities, got Long

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=7456, ip=127.0.0.1, actor_id=bea7c9a2f8df3a5d3039161001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x100c53850>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Expected floating point type for target with class probabilities, got Long
federated | ERROR flwr 2024-11-08 16:42:38,311 | ray_client_proxy.py:107 | [36mray::ClientAppActor.run()[39m (pid=7455, ip=127.0.0.1, actor_id=2e691067daf42eaca771f11601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x103453710>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/message_handler/message_handler.py", line 129, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
              ^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client.py", line 255, in maybe_call_fit
    return client.fit(fit_ins)
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 259, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/texas100/globalattack.py", line 115, in fit
    loss = self.criterion(outputs, y)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/loss.py", line 1188, in forward
    return F.cross_entropy(input, target, weight=self.weight,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/functional.py", line 3104, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected floating point type for target with class probabilities, got Long

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=7455, ip=127.0.0.1, actor_id=2e691067daf42eaca771f11601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x103453710>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Expected floating point type for target with class probabilities, got Long
federated | INFO flwr 2024-11-08 16:42:38,315 | server.py:240 | aggregate_fit: received 0 results and 5 failures
federated | INFO flwr 2024-11-08 16:42:38,318 | server.py:178 | configure_evaluate: strategy sampled 5 clients (out of 5)
federated | ERROR flwr 2024-11-08 16:42:53,639 | ray_client_proxy.py:106 | Traceback (most recent call last):
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 94, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 398, in get_client_result
    return self._fetch_future_result(cid)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 279, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
                                         ^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=7455, ip=127.0.0.1, actor_id=2e691067daf42eaca771f11601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x103453710>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/message_handler/message_handler.py", line 136, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
                   ^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client.py", line 275, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 283, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/texas100/globalattack.py", line 129, in evaluate
    correct += (predicted == y).sum().item()
                ^^^^^^^^^^^^^^
RuntimeError: The size of tensor a (64) must match the size of tensor b (100) at non-singleton dimension 1

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=7455, ip=127.0.0.1, actor_id=2e691067daf42eaca771f11601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x103453710>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: The size of tensor a (64) must match the size of tensor b (100) at non-singleton dimension 1

federated | ERROR flwr 2024-11-08 16:42:53,640 | ray_client_proxy.py:106 | Traceback (most recent call last):
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 94, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 398, in get_client_result
    return self._fetch_future_result(cid)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 279, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
                                         ^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=7456, ip=127.0.0.1, actor_id=bea7c9a2f8df3a5d3039161001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x100c53850>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/message_handler/message_handler.py", line 136, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
                   ^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client.py", line 275, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 283, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/texas100/globalattack.py", line 129, in evaluate
    correct += (predicted == y).sum().item()
                ^^^^^^^^^^^^^^
RuntimeError: The size of tensor a (64) must match the size of tensor b (100) at non-singleton dimension 1

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=7456, ip=127.0.0.1, actor_id=bea7c9a2f8df3a5d3039161001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x100c53850>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: The size of tensor a (64) must match the size of tensor b (100) at non-singleton dimension 1

federated | ERROR flwr 2024-11-08 16:42:53,641 | ray_client_proxy.py:106 | Traceback (most recent call last):
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 94, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 398, in get_client_result
    return self._fetch_future_result(cid)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 279, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
                                         ^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=7457, ip=127.0.0.1, actor_id=d8cd0c8a6770c4a59324b50101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x16ee1dc90>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/message_handler/message_handler.py", line 136, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
                   ^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client.py", line 275, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 283, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/texas100/globalattack.py", line 129, in evaluate
    correct += (predicted == y).sum().item()
                ^^^^^^^^^^^^^^
RuntimeError: The size of tensor a (64) must match the size of tensor b (100) at non-singleton dimension 1

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=7457, ip=127.0.0.1, actor_id=d8cd0c8a6770c4a59324b50101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x16ee1dc90>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: The size of tensor a (64) must match the size of tensor b (100) at non-singleton dimension 1

federated | ERROR flwr 2024-11-08 16:42:53,641 | ray_client_proxy.py:106 | Traceback (most recent call last):
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 94, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 398, in get_client_result
    return self._fetch_future_result(cid)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 279, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
                                         ^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=7458, ip=127.0.0.1, actor_id=267f550c66ad5dc367d35d5601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x104fa1190>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/message_handler/message_handler.py", line 136, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
                   ^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client.py", line 275, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 283, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/texas100/globalattack.py", line 129, in evaluate
    correct += (predicted == y).sum().item()
                ^^^^^^^^^^^^^^
RuntimeError: The size of tensor a (64) must match the size of tensor b (100) at non-singleton dimension 1

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=7458, ip=127.0.0.1, actor_id=267f550c66ad5dc367d35d5601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x104fa1190>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: The size of tensor a (64) must match the size of tensor b (100) at non-singleton dimension 1

federated | ERROR flwr 2024-11-08 16:42:53,642 | ray_client_proxy.py:107 | [36mray::ClientAppActor.run()[39m (pid=7455, ip=127.0.0.1, actor_id=2e691067daf42eaca771f11601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x103453710>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/message_handler/message_handler.py", line 136, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
                   ^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client.py", line 275, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 283, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/texas100/globalattack.py", line 129, in evaluate
    correct += (predicted == y).sum().item()
                ^^^^^^^^^^^^^^
RuntimeError: The size of tensor a (64) must match the size of tensor b (100) at non-singleton dimension 1

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=7455, ip=127.0.0.1, actor_id=2e691067daf42eaca771f11601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x103453710>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: The size of tensor a (64) must match the size of tensor b (100) at non-singleton dimension 1
federated | ERROR flwr 2024-11-08 16:42:53,643 | ray_client_proxy.py:107 | [36mray::ClientAppActor.run()[39m (pid=7456, ip=127.0.0.1, actor_id=bea7c9a2f8df3a5d3039161001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x100c53850>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/message_handler/message_handler.py", line 136, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
                   ^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client.py", line 275, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 283, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/texas100/globalattack.py", line 129, in evaluate
    correct += (predicted == y).sum().item()
                ^^^^^^^^^^^^^^
RuntimeError: The size of tensor a (64) must match the size of tensor b (100) at non-singleton dimension 1

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=7456, ip=127.0.0.1, actor_id=bea7c9a2f8df3a5d3039161001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x100c53850>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: The size of tensor a (64) must match the size of tensor b (100) at non-singleton dimension 1
federated | ERROR flwr 2024-11-08 16:42:53,644 | ray_client_proxy.py:107 | [36mray::ClientAppActor.run()[39m (pid=7457, ip=127.0.0.1, actor_id=d8cd0c8a6770c4a59324b50101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x16ee1dc90>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/message_handler/message_handler.py", line 136, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
                   ^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client.py", line 275, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 283, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/texas100/globalattack.py", line 129, in evaluate
    correct += (predicted == y).sum().item()
                ^^^^^^^^^^^^^^
RuntimeError: The size of tensor a (64) must match the size of tensor b (100) at non-singleton dimension 1

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=7457, ip=127.0.0.1, actor_id=d8cd0c8a6770c4a59324b50101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x16ee1dc90>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: The size of tensor a (64) must match the size of tensor b (100) at non-singleton dimension 1
federated | ERROR flwr 2024-11-08 16:42:53,646 | ray_client_proxy.py:107 | [36mray::ClientAppActor.run()[39m (pid=7458, ip=127.0.0.1, actor_id=267f550c66ad5dc367d35d5601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x104fa1190>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/message_handler/message_handler.py", line 136, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
                   ^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client.py", line 275, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 283, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/texas100/globalattack.py", line 129, in evaluate
    correct += (predicted == y).sum().item()
                ^^^^^^^^^^^^^^
RuntimeError: The size of tensor a (64) must match the size of tensor b (100) at non-singleton dimension 1

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=7458, ip=127.0.0.1, actor_id=267f550c66ad5dc367d35d5601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x104fa1190>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: The size of tensor a (64) must match the size of tensor b (100) at non-singleton dimension 1
federated | ERROR flwr 2024-11-08 16:42:54,323 | ray_client_proxy.py:106 | Traceback (most recent call last):
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 94, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 398, in get_client_result
    return self._fetch_future_result(cid)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 279, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
                                         ^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=7459, ip=127.0.0.1, actor_id=d5f5709c7c2075c1494c0cd101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x104d41d10>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/message_handler/message_handler.py", line 136, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
                   ^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client.py", line 275, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 283, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/texas100/globalattack.py", line 129, in evaluate
    correct += (predicted == y).sum().item()
                ^^^^^^^^^^^^^^
RuntimeError: The size of tensor a (64) must match the size of tensor b (100) at non-singleton dimension 1

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=7459, ip=127.0.0.1, actor_id=d5f5709c7c2075c1494c0cd101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x104d41d10>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: The size of tensor a (64) must match the size of tensor b (100) at non-singleton dimension 1

federated | ERROR flwr 2024-11-08 16:42:54,326 | ray_client_proxy.py:107 | [36mray::ClientAppActor.run()[39m (pid=7459, ip=127.0.0.1, actor_id=d5f5709c7c2075c1494c0cd101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x104d41d10>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/message_handler/message_handler.py", line 136, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
                   ^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client.py", line 275, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 283, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/texas100/globalattack.py", line 129, in evaluate
    correct += (predicted == y).sum().item()
                ^^^^^^^^^^^^^^
RuntimeError: The size of tensor a (64) must match the size of tensor b (100) at non-singleton dimension 1

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=7459, ip=127.0.0.1, actor_id=d5f5709c7c2075c1494c0cd101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x104d41d10>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: The size of tensor a (64) must match the size of tensor b (100) at non-singleton dimension 1
federated | INFO flwr 2024-11-08 16:42:54,330 | server.py:192 | aggregate_evaluate: received 0 results and 5 failures
federated | INFO flwr 2024-11-08 16:42:54,332 | server.py:112 | 
federated | INFO flwr 2024-11-08 16:42:54,333 | server.py:113 | [ROUND 3]
federated | INFO flwr 2024-11-08 16:42:54,335 | server.py:226 | configure_fit: strategy sampled 5 clients (out of 5)
federated | ERROR flwr 2024-11-08 16:43:06,985 | ray_client_proxy.py:106 | Traceback (most recent call last):
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 94, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 398, in get_client_result
    return self._fetch_future_result(cid)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 279, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
                                         ^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=7457, ip=127.0.0.1, actor_id=d8cd0c8a6770c4a59324b50101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x16ee1dc90>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/message_handler/message_handler.py", line 129, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
              ^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client.py", line 255, in maybe_call_fit
    return client.fit(fit_ins)
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 259, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/texas100/globalattack.py", line 115, in fit
    loss = self.criterion(outputs, y)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/loss.py", line 1188, in forward
    return F.cross_entropy(input, target, weight=self.weight,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/functional.py", line 3104, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected floating point type for target with class probabilities, got Long

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=7457, ip=127.0.0.1, actor_id=d8cd0c8a6770c4a59324b50101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x16ee1dc90>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Expected floating point type for target with class probabilities, got Long

federated | ERROR flwr 2024-11-08 16:43:06,985 | ray_client_proxy.py:106 | Traceback (most recent call last):
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 94, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 398, in get_client_result
    return self._fetch_future_result(cid)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 279, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
                                         ^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=7459, ip=127.0.0.1, actor_id=d5f5709c7c2075c1494c0cd101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x104d41d10>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/message_handler/message_handler.py", line 129, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
              ^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client.py", line 255, in maybe_call_fit
    return client.fit(fit_ins)
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 259, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/texas100/globalattack.py", line 115, in fit
    loss = self.criterion(outputs, y)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/loss.py", line 1188, in forward
    return F.cross_entropy(input, target, weight=self.weight,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/functional.py", line 3104, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected floating point type for target with class probabilities, got Long

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=7459, ip=127.0.0.1, actor_id=d5f5709c7c2075c1494c0cd101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x104d41d10>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Expected floating point type for target with class probabilities, got Long

federated | ERROR flwr 2024-11-08 16:43:06,986 | ray_client_proxy.py:107 | [36mray::ClientAppActor.run()[39m (pid=7457, ip=127.0.0.1, actor_id=d8cd0c8a6770c4a59324b50101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x16ee1dc90>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/message_handler/message_handler.py", line 129, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
              ^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client.py", line 255, in maybe_call_fit
    return client.fit(fit_ins)
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 259, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/texas100/globalattack.py", line 115, in fit
    loss = self.criterion(outputs, y)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/loss.py", line 1188, in forward
    return F.cross_entropy(input, target, weight=self.weight,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/functional.py", line 3104, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected floating point type for target with class probabilities, got Long

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=7457, ip=127.0.0.1, actor_id=d8cd0c8a6770c4a59324b50101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x16ee1dc90>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Expected floating point type for target with class probabilities, got Long
federated | ERROR flwr 2024-11-08 16:43:06,986 | ray_client_proxy.py:106 | Traceback (most recent call last):
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 94, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 398, in get_client_result
    return self._fetch_future_result(cid)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 279, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
                                         ^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=7458, ip=127.0.0.1, actor_id=267f550c66ad5dc367d35d5601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x104fa1190>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/message_handler/message_handler.py", line 129, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
              ^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client.py", line 255, in maybe_call_fit
    return client.fit(fit_ins)
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 259, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/texas100/globalattack.py", line 115, in fit
    loss = self.criterion(outputs, y)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/loss.py", line 1188, in forward
    return F.cross_entropy(input, target, weight=self.weight,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/functional.py", line 3104, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected floating point type for target with class probabilities, got Long

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=7458, ip=127.0.0.1, actor_id=267f550c66ad5dc367d35d5601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x104fa1190>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Expected floating point type for target with class probabilities, got Long

federated | ERROR flwr 2024-11-08 16:43:06,986 | ray_client_proxy.py:107 | [36mray::ClientAppActor.run()[39m (pid=7459, ip=127.0.0.1, actor_id=d5f5709c7c2075c1494c0cd101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x104d41d10>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/message_handler/message_handler.py", line 129, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
              ^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client.py", line 255, in maybe_call_fit
    return client.fit(fit_ins)
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 259, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/texas100/globalattack.py", line 115, in fit
    loss = self.criterion(outputs, y)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/loss.py", line 1188, in forward
    return F.cross_entropy(input, target, weight=self.weight,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/functional.py", line 3104, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected floating point type for target with class probabilities, got Long

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=7459, ip=127.0.0.1, actor_id=d5f5709c7c2075c1494c0cd101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x104d41d10>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Expected floating point type for target with class probabilities, got Long
federated | ERROR flwr 2024-11-08 16:43:06,987 | ray_client_proxy.py:107 | [36mray::ClientAppActor.run()[39m (pid=7458, ip=127.0.0.1, actor_id=267f550c66ad5dc367d35d5601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x104fa1190>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/message_handler/message_handler.py", line 129, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
              ^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client.py", line 255, in maybe_call_fit
    return client.fit(fit_ins)
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 259, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/texas100/globalattack.py", line 115, in fit
    loss = self.criterion(outputs, y)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/loss.py", line 1188, in forward
    return F.cross_entropy(input, target, weight=self.weight,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/functional.py", line 3104, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected floating point type for target with class probabilities, got Long

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=7458, ip=127.0.0.1, actor_id=267f550c66ad5dc367d35d5601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x104fa1190>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Expected floating point type for target with class probabilities, got Long
federated | ERROR flwr 2024-11-08 16:43:07,166 | ray_client_proxy.py:106 | Traceback (most recent call last):
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 94, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 398, in get_client_result
    return self._fetch_future_result(cid)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 279, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
                                         ^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=7456, ip=127.0.0.1, actor_id=bea7c9a2f8df3a5d3039161001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x100c53850>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/message_handler/message_handler.py", line 129, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
              ^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client.py", line 255, in maybe_call_fit
    return client.fit(fit_ins)
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 259, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/texas100/globalattack.py", line 115, in fit
    loss = self.criterion(outputs, y)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/loss.py", line 1188, in forward
    return F.cross_entropy(input, target, weight=self.weight,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/functional.py", line 3104, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected floating point type for target with class probabilities, got Long

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=7456, ip=127.0.0.1, actor_id=bea7c9a2f8df3a5d3039161001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x100c53850>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Expected floating point type for target with class probabilities, got Long

federated | ERROR flwr 2024-11-08 16:43:07,166 | ray_client_proxy.py:107 | [36mray::ClientAppActor.run()[39m (pid=7456, ip=127.0.0.1, actor_id=bea7c9a2f8df3a5d3039161001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x100c53850>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/message_handler/message_handler.py", line 129, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
              ^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client.py", line 255, in maybe_call_fit
    return client.fit(fit_ins)
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 259, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/texas100/globalattack.py", line 115, in fit
    loss = self.criterion(outputs, y)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/loss.py", line 1188, in forward
    return F.cross_entropy(input, target, weight=self.weight,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/functional.py", line 3104, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected floating point type for target with class probabilities, got Long

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=7456, ip=127.0.0.1, actor_id=bea7c9a2f8df3a5d3039161001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x100c53850>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Expected floating point type for target with class probabilities, got Long
federated | ERROR flwr 2024-11-08 16:43:07,799 | ray_client_proxy.py:106 | Traceback (most recent call last):
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 94, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 398, in get_client_result
    return self._fetch_future_result(cid)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 279, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
                                         ^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=7455, ip=127.0.0.1, actor_id=2e691067daf42eaca771f11601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x103453710>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/message_handler/message_handler.py", line 129, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
              ^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client.py", line 255, in maybe_call_fit
    return client.fit(fit_ins)
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 259, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/texas100/globalattack.py", line 115, in fit
    loss = self.criterion(outputs, y)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/loss.py", line 1188, in forward
    return F.cross_entropy(input, target, weight=self.weight,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/functional.py", line 3104, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected floating point type for target with class probabilities, got Long

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=7455, ip=127.0.0.1, actor_id=2e691067daf42eaca771f11601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x103453710>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Expected floating point type for target with class probabilities, got Long

federated | ERROR flwr 2024-11-08 16:43:07,799 | ray_client_proxy.py:107 | [36mray::ClientAppActor.run()[39m (pid=7455, ip=127.0.0.1, actor_id=2e691067daf42eaca771f11601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x103453710>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/message_handler/message_handler.py", line 129, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
              ^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client.py", line 255, in maybe_call_fit
    return client.fit(fit_ins)
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 259, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/texas100/globalattack.py", line 115, in fit
    loss = self.criterion(outputs, y)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/loss.py", line 1188, in forward
    return F.cross_entropy(input, target, weight=self.weight,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/functional.py", line 3104, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected floating point type for target with class probabilities, got Long

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=7455, ip=127.0.0.1, actor_id=2e691067daf42eaca771f11601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x103453710>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Expected floating point type for target with class probabilities, got Long
federated | INFO flwr 2024-11-08 16:43:07,799 | server.py:240 | aggregate_fit: received 0 results and 5 failures
federated | INFO flwr 2024-11-08 16:43:07,800 | server.py:178 | configure_evaluate: strategy sampled 5 clients (out of 5)
federated | ERROR flwr 2024-11-08 16:43:21,441 | ray_client_proxy.py:106 | Traceback (most recent call last):
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 94, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 398, in get_client_result
    return self._fetch_future_result(cid)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 279, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
                                         ^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=7455, ip=127.0.0.1, actor_id=2e691067daf42eaca771f11601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x103453710>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/message_handler/message_handler.py", line 136, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
                   ^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client.py", line 275, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 283, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/texas100/globalattack.py", line 129, in evaluate
    correct += (predicted == y).sum().item()
                ^^^^^^^^^^^^^^
RuntimeError: The size of tensor a (64) must match the size of tensor b (100) at non-singleton dimension 1

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=7455, ip=127.0.0.1, actor_id=2e691067daf42eaca771f11601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x103453710>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: The size of tensor a (64) must match the size of tensor b (100) at non-singleton dimension 1

federated | ERROR flwr 2024-11-08 16:43:21,442 | ray_client_proxy.py:107 | [36mray::ClientAppActor.run()[39m (pid=7455, ip=127.0.0.1, actor_id=2e691067daf42eaca771f11601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x103453710>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/message_handler/message_handler.py", line 136, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
                   ^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client.py", line 275, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 283, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/texas100/globalattack.py", line 129, in evaluate
    correct += (predicted == y).sum().item()
                ^^^^^^^^^^^^^^
RuntimeError: The size of tensor a (64) must match the size of tensor b (100) at non-singleton dimension 1

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=7455, ip=127.0.0.1, actor_id=2e691067daf42eaca771f11601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x103453710>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: The size of tensor a (64) must match the size of tensor b (100) at non-singleton dimension 1
federated | ERROR flwr 2024-11-08 16:43:21,442 | ray_client_proxy.py:106 | Traceback (most recent call last):
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 94, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 398, in get_client_result
    return self._fetch_future_result(cid)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 279, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
                                         ^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=7456, ip=127.0.0.1, actor_id=bea7c9a2f8df3a5d3039161001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x100c53850>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/message_handler/message_handler.py", line 136, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
                   ^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client.py", line 275, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 283, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/texas100/globalattack.py", line 129, in evaluate
    correct += (predicted == y).sum().item()
                ^^^^^^^^^^^^^^
RuntimeError: The size of tensor a (64) must match the size of tensor b (100) at non-singleton dimension 1

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=7456, ip=127.0.0.1, actor_id=bea7c9a2f8df3a5d3039161001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x100c53850>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: The size of tensor a (64) must match the size of tensor b (100) at non-singleton dimension 1

federated | ERROR flwr 2024-11-08 16:43:21,443 | ray_client_proxy.py:106 | Traceback (most recent call last):
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 94, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 398, in get_client_result
    return self._fetch_future_result(cid)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 279, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
                                         ^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=7458, ip=127.0.0.1, actor_id=267f550c66ad5dc367d35d5601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x104fa1190>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/message_handler/message_handler.py", line 136, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
                   ^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client.py", line 275, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 283, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/texas100/globalattack.py", line 129, in evaluate
    correct += (predicted == y).sum().item()
                ^^^^^^^^^^^^^^
RuntimeError: The size of tensor a (64) must match the size of tensor b (100) at non-singleton dimension 1

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=7458, ip=127.0.0.1, actor_id=267f550c66ad5dc367d35d5601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x104fa1190>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: The size of tensor a (64) must match the size of tensor b (100) at non-singleton dimension 1

federated | ERROR flwr 2024-11-08 16:43:21,443 | ray_client_proxy.py:107 | [36mray::ClientAppActor.run()[39m (pid=7456, ip=127.0.0.1, actor_id=bea7c9a2f8df3a5d3039161001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x100c53850>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/message_handler/message_handler.py", line 136, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
                   ^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client.py", line 275, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 283, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/texas100/globalattack.py", line 129, in evaluate
    correct += (predicted == y).sum().item()
                ^^^^^^^^^^^^^^
RuntimeError: The size of tensor a (64) must match the size of tensor b (100) at non-singleton dimension 1

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=7456, ip=127.0.0.1, actor_id=bea7c9a2f8df3a5d3039161001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x100c53850>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: The size of tensor a (64) must match the size of tensor b (100) at non-singleton dimension 1
federated | ERROR flwr 2024-11-08 16:43:21,443 | ray_client_proxy.py:106 | Traceback (most recent call last):
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 94, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 398, in get_client_result
    return self._fetch_future_result(cid)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 279, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
                                         ^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=7459, ip=127.0.0.1, actor_id=d5f5709c7c2075c1494c0cd101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x104d41d10>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/message_handler/message_handler.py", line 136, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
                   ^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client.py", line 275, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 283, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/texas100/globalattack.py", line 129, in evaluate
    correct += (predicted == y).sum().item()
                ^^^^^^^^^^^^^^
RuntimeError: The size of tensor a (64) must match the size of tensor b (100) at non-singleton dimension 1

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=7459, ip=127.0.0.1, actor_id=d5f5709c7c2075c1494c0cd101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x104d41d10>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: The size of tensor a (64) must match the size of tensor b (100) at non-singleton dimension 1

federated | ERROR flwr 2024-11-08 16:43:21,443 | ray_client_proxy.py:107 | [36mray::ClientAppActor.run()[39m (pid=7458, ip=127.0.0.1, actor_id=267f550c66ad5dc367d35d5601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x104fa1190>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/message_handler/message_handler.py", line 136, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
                   ^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client.py", line 275, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 283, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/texas100/globalattack.py", line 129, in evaluate
    correct += (predicted == y).sum().item()
                ^^^^^^^^^^^^^^
RuntimeError: The size of tensor a (64) must match the size of tensor b (100) at non-singleton dimension 1

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=7458, ip=127.0.0.1, actor_id=267f550c66ad5dc367d35d5601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x104fa1190>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: The size of tensor a (64) must match the size of tensor b (100) at non-singleton dimension 1
federated | ERROR flwr 2024-11-08 16:43:21,443 | ray_client_proxy.py:107 | [36mray::ClientAppActor.run()[39m (pid=7459, ip=127.0.0.1, actor_id=d5f5709c7c2075c1494c0cd101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x104d41d10>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/message_handler/message_handler.py", line 136, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
                   ^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client.py", line 275, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 283, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/texas100/globalattack.py", line 129, in evaluate
    correct += (predicted == y).sum().item()
                ^^^^^^^^^^^^^^
RuntimeError: The size of tensor a (64) must match the size of tensor b (100) at non-singleton dimension 1

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=7459, ip=127.0.0.1, actor_id=d5f5709c7c2075c1494c0cd101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x104d41d10>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: The size of tensor a (64) must match the size of tensor b (100) at non-singleton dimension 1
federated | ERROR flwr 2024-11-08 16:43:21,995 | ray_client_proxy.py:106 | Traceback (most recent call last):
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 94, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 398, in get_client_result
    return self._fetch_future_result(cid)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 279, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
                                         ^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=7457, ip=127.0.0.1, actor_id=d8cd0c8a6770c4a59324b50101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x16ee1dc90>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/message_handler/message_handler.py", line 136, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
                   ^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client.py", line 275, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 283, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/texas100/globalattack.py", line 129, in evaluate
    correct += (predicted == y).sum().item()
                ^^^^^^^^^^^^^^
RuntimeError: The size of tensor a (64) must match the size of tensor b (100) at non-singleton dimension 1

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=7457, ip=127.0.0.1, actor_id=d8cd0c8a6770c4a59324b50101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x16ee1dc90>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: The size of tensor a (64) must match the size of tensor b (100) at non-singleton dimension 1

federated | ERROR flwr 2024-11-08 16:43:21,995 | ray_client_proxy.py:107 | [36mray::ClientAppActor.run()[39m (pid=7457, ip=127.0.0.1, actor_id=d8cd0c8a6770c4a59324b50101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x16ee1dc90>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/message_handler/message_handler.py", line 136, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
                   ^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client.py", line 275, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 283, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/texas100/globalattack.py", line 129, in evaluate
    correct += (predicted == y).sum().item()
                ^^^^^^^^^^^^^^
RuntimeError: The size of tensor a (64) must match the size of tensor b (100) at non-singleton dimension 1

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=7457, ip=127.0.0.1, actor_id=d8cd0c8a6770c4a59324b50101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x16ee1dc90>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: The size of tensor a (64) must match the size of tensor b (100) at non-singleton dimension 1
federated | INFO flwr 2024-11-08 16:43:21,995 | server.py:192 | aggregate_evaluate: received 0 results and 5 failures
federated | INFO flwr 2024-11-08 16:43:21,995 | server.py:112 | 
federated | INFO flwr 2024-11-08 16:43:21,995 | server.py:113 | [ROUND 4]
federated | INFO flwr 2024-11-08 16:43:21,996 | server.py:226 | configure_fit: strategy sampled 5 clients (out of 5)
federated | ERROR flwr 2024-11-08 16:43:36,846 | ray_client_proxy.py:106 | Traceback (most recent call last):
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 94, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 398, in get_client_result
    return self._fetch_future_result(cid)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 279, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
                                         ^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=7457, ip=127.0.0.1, actor_id=d8cd0c8a6770c4a59324b50101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x16ee1dc90>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/message_handler/message_handler.py", line 129, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
              ^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client.py", line 255, in maybe_call_fit
    return client.fit(fit_ins)
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 259, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/texas100/globalattack.py", line 115, in fit
    loss = self.criterion(outputs, y)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/loss.py", line 1188, in forward
    return F.cross_entropy(input, target, weight=self.weight,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/functional.py", line 3104, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected floating point type for target with class probabilities, got Long

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=7457, ip=127.0.0.1, actor_id=d8cd0c8a6770c4a59324b50101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x16ee1dc90>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Expected floating point type for target with class probabilities, got Long

federated | ERROR flwr 2024-11-08 16:43:36,848 | ray_client_proxy.py:106 | Traceback (most recent call last):
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 94, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 398, in get_client_result
    return self._fetch_future_result(cid)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 279, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
                                         ^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=7458, ip=127.0.0.1, actor_id=267f550c66ad5dc367d35d5601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x104fa1190>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/message_handler/message_handler.py", line 129, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
              ^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client.py", line 255, in maybe_call_fit
    return client.fit(fit_ins)
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 259, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/texas100/globalattack.py", line 115, in fit
    loss = self.criterion(outputs, y)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/loss.py", line 1188, in forward
    return F.cross_entropy(input, target, weight=self.weight,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/functional.py", line 3104, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected floating point type for target with class probabilities, got Long

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=7458, ip=127.0.0.1, actor_id=267f550c66ad5dc367d35d5601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x104fa1190>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Expected floating point type for target with class probabilities, got Long

federated | ERROR flwr 2024-11-08 16:43:36,848 | ray_client_proxy.py:106 | Traceback (most recent call last):
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 94, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 398, in get_client_result
    return self._fetch_future_result(cid)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 279, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
                                         ^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=7459, ip=127.0.0.1, actor_id=d5f5709c7c2075c1494c0cd101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x104d41d10>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/message_handler/message_handler.py", line 129, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
              ^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client.py", line 255, in maybe_call_fit
    return client.fit(fit_ins)
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 259, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/texas100/globalattack.py", line 115, in fit
    loss = self.criterion(outputs, y)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/loss.py", line 1188, in forward
    return F.cross_entropy(input, target, weight=self.weight,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/functional.py", line 3104, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected floating point type for target with class probabilities, got Long

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=7459, ip=127.0.0.1, actor_id=d5f5709c7c2075c1494c0cd101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x104d41d10>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Expected floating point type for target with class probabilities, got Long

federated | ERROR flwr 2024-11-08 16:43:36,848 | ray_client_proxy.py:106 | Traceback (most recent call last):
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 94, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 398, in get_client_result
    return self._fetch_future_result(cid)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 279, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
                                         ^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=7456, ip=127.0.0.1, actor_id=bea7c9a2f8df3a5d3039161001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x100c53850>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/message_handler/message_handler.py", line 129, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
              ^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client.py", line 255, in maybe_call_fit
    return client.fit(fit_ins)
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 259, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/texas100/globalattack.py", line 115, in fit
    loss = self.criterion(outputs, y)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/loss.py", line 1188, in forward
    return F.cross_entropy(input, target, weight=self.weight,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/functional.py", line 3104, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected floating point type for target with class probabilities, got Long

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=7456, ip=127.0.0.1, actor_id=bea7c9a2f8df3a5d3039161001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x100c53850>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Expected floating point type for target with class probabilities, got Long

federated | ERROR flwr 2024-11-08 16:43:36,848 | ray_client_proxy.py:107 | [36mray::ClientAppActor.run()[39m (pid=7457, ip=127.0.0.1, actor_id=d8cd0c8a6770c4a59324b50101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x16ee1dc90>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/message_handler/message_handler.py", line 129, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
              ^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client.py", line 255, in maybe_call_fit
    return client.fit(fit_ins)
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 259, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/texas100/globalattack.py", line 115, in fit
    loss = self.criterion(outputs, y)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/loss.py", line 1188, in forward
    return F.cross_entropy(input, target, weight=self.weight,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/functional.py", line 3104, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected floating point type for target with class probabilities, got Long

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=7457, ip=127.0.0.1, actor_id=d8cd0c8a6770c4a59324b50101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x16ee1dc90>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Expected floating point type for target with class probabilities, got Long
federated | ERROR flwr 2024-11-08 16:43:36,854 | ray_client_proxy.py:107 | [36mray::ClientAppActor.run()[39m (pid=7458, ip=127.0.0.1, actor_id=267f550c66ad5dc367d35d5601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x104fa1190>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/message_handler/message_handler.py", line 129, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
              ^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client.py", line 255, in maybe_call_fit
    return client.fit(fit_ins)
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 259, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/texas100/globalattack.py", line 115, in fit
    loss = self.criterion(outputs, y)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/loss.py", line 1188, in forward
    return F.cross_entropy(input, target, weight=self.weight,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/functional.py", line 3104, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected floating point type for target with class probabilities, got Long

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=7458, ip=127.0.0.1, actor_id=267f550c66ad5dc367d35d5601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x104fa1190>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Expected floating point type for target with class probabilities, got Long
federated | ERROR flwr 2024-11-08 16:43:36,855 | ray_client_proxy.py:107 | [36mray::ClientAppActor.run()[39m (pid=7459, ip=127.0.0.1, actor_id=d5f5709c7c2075c1494c0cd101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x104d41d10>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/message_handler/message_handler.py", line 129, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
              ^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client.py", line 255, in maybe_call_fit
    return client.fit(fit_ins)
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 259, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/texas100/globalattack.py", line 115, in fit
    loss = self.criterion(outputs, y)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/loss.py", line 1188, in forward
    return F.cross_entropy(input, target, weight=self.weight,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/functional.py", line 3104, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected floating point type for target with class probabilities, got Long

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=7459, ip=127.0.0.1, actor_id=d5f5709c7c2075c1494c0cd101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x104d41d10>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Expected floating point type for target with class probabilities, got Long
federated | ERROR flwr 2024-11-08 16:43:36,855 | ray_client_proxy.py:107 | [36mray::ClientAppActor.run()[39m (pid=7456, ip=127.0.0.1, actor_id=bea7c9a2f8df3a5d3039161001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x100c53850>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/message_handler/message_handler.py", line 129, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
              ^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client.py", line 255, in maybe_call_fit
    return client.fit(fit_ins)
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 259, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/texas100/globalattack.py", line 115, in fit
    loss = self.criterion(outputs, y)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/loss.py", line 1188, in forward
    return F.cross_entropy(input, target, weight=self.weight,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/functional.py", line 3104, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected floating point type for target with class probabilities, got Long

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=7456, ip=127.0.0.1, actor_id=bea7c9a2f8df3a5d3039161001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x100c53850>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Expected floating point type for target with class probabilities, got Long
federated | ERROR flwr 2024-11-08 16:43:37,273 | ray_client_proxy.py:106 | Traceback (most recent call last):
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 94, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 398, in get_client_result
    return self._fetch_future_result(cid)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 279, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
                                         ^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=7455, ip=127.0.0.1, actor_id=2e691067daf42eaca771f11601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x103453710>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/message_handler/message_handler.py", line 129, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
              ^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client.py", line 255, in maybe_call_fit
    return client.fit(fit_ins)
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 259, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/texas100/globalattack.py", line 115, in fit
    loss = self.criterion(outputs, y)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/loss.py", line 1188, in forward
    return F.cross_entropy(input, target, weight=self.weight,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/functional.py", line 3104, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected floating point type for target with class probabilities, got Long

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=7455, ip=127.0.0.1, actor_id=2e691067daf42eaca771f11601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x103453710>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Expected floating point type for target with class probabilities, got Long

federated | ERROR flwr 2024-11-08 16:43:37,273 | ray_client_proxy.py:107 | [36mray::ClientAppActor.run()[39m (pid=7455, ip=127.0.0.1, actor_id=2e691067daf42eaca771f11601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x103453710>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/message_handler/message_handler.py", line 129, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
              ^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client.py", line 255, in maybe_call_fit
    return client.fit(fit_ins)
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 259, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/texas100/globalattack.py", line 115, in fit
    loss = self.criterion(outputs, y)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/loss.py", line 1188, in forward
    return F.cross_entropy(input, target, weight=self.weight,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/functional.py", line 3104, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected floating point type for target with class probabilities, got Long

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=7455, ip=127.0.0.1, actor_id=2e691067daf42eaca771f11601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x103453710>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Expected floating point type for target with class probabilities, got Long
federated | INFO flwr 2024-11-08 16:43:37,273 | server.py:240 | aggregate_fit: received 0 results and 5 failures
federated | INFO flwr 2024-11-08 16:43:37,273 | server.py:178 | configure_evaluate: strategy sampled 5 clients (out of 5)
federated | ERROR flwr 2024-11-08 16:43:47,534 | ray_client_proxy.py:106 | Traceback (most recent call last):
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 94, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 398, in get_client_result
    return self._fetch_future_result(cid)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 279, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
                                         ^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=7455, ip=127.0.0.1, actor_id=2e691067daf42eaca771f11601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x103453710>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/message_handler/message_handler.py", line 136, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
                   ^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client.py", line 275, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 283, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/texas100/globalattack.py", line 129, in evaluate
    correct += (predicted == y).sum().item()
                ^^^^^^^^^^^^^^
RuntimeError: The size of tensor a (64) must match the size of tensor b (100) at non-singleton dimension 1

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=7455, ip=127.0.0.1, actor_id=2e691067daf42eaca771f11601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x103453710>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: The size of tensor a (64) must match the size of tensor b (100) at non-singleton dimension 1

federated | ERROR flwr 2024-11-08 16:43:47,535 | ray_client_proxy.py:107 | [36mray::ClientAppActor.run()[39m (pid=7455, ip=127.0.0.1, actor_id=2e691067daf42eaca771f11601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x103453710>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/message_handler/message_handler.py", line 136, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
                   ^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client.py", line 275, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 283, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/texas100/globalattack.py", line 129, in evaluate
    correct += (predicted == y).sum().item()
                ^^^^^^^^^^^^^^
RuntimeError: The size of tensor a (64) must match the size of tensor b (100) at non-singleton dimension 1

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=7455, ip=127.0.0.1, actor_id=2e691067daf42eaca771f11601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x103453710>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: The size of tensor a (64) must match the size of tensor b (100) at non-singleton dimension 1
federated | ERROR flwr 2024-11-08 16:43:47,536 | ray_client_proxy.py:106 | Traceback (most recent call last):
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 94, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 398, in get_client_result
    return self._fetch_future_result(cid)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 279, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
                                         ^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=7458, ip=127.0.0.1, actor_id=267f550c66ad5dc367d35d5601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x104fa1190>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/message_handler/message_handler.py", line 136, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
                   ^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client.py", line 275, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 283, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/texas100/globalattack.py", line 129, in evaluate
    correct += (predicted == y).sum().item()
                ^^^^^^^^^^^^^^
RuntimeError: The size of tensor a (64) must match the size of tensor b (100) at non-singleton dimension 1

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=7458, ip=127.0.0.1, actor_id=267f550c66ad5dc367d35d5601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x104fa1190>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: The size of tensor a (64) must match the size of tensor b (100) at non-singleton dimension 1

federated | ERROR flwr 2024-11-08 16:43:47,536 | ray_client_proxy.py:106 | Traceback (most recent call last):
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 94, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 398, in get_client_result
    return self._fetch_future_result(cid)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 279, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
                                         ^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=7456, ip=127.0.0.1, actor_id=bea7c9a2f8df3a5d3039161001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x100c53850>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/message_handler/message_handler.py", line 136, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
                   ^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client.py", line 275, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 283, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/texas100/globalattack.py", line 129, in evaluate
    correct += (predicted == y).sum().item()
                ^^^^^^^^^^^^^^
RuntimeError: The size of tensor a (64) must match the size of tensor b (100) at non-singleton dimension 1

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=7456, ip=127.0.0.1, actor_id=bea7c9a2f8df3a5d3039161001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x100c53850>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: The size of tensor a (64) must match the size of tensor b (100) at non-singleton dimension 1

federated | ERROR flwr 2024-11-08 16:43:47,536 | ray_client_proxy.py:107 | [36mray::ClientAppActor.run()[39m (pid=7458, ip=127.0.0.1, actor_id=267f550c66ad5dc367d35d5601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x104fa1190>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/message_handler/message_handler.py", line 136, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
                   ^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client.py", line 275, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 283, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/texas100/globalattack.py", line 129, in evaluate
    correct += (predicted == y).sum().item()
                ^^^^^^^^^^^^^^
RuntimeError: The size of tensor a (64) must match the size of tensor b (100) at non-singleton dimension 1

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=7458, ip=127.0.0.1, actor_id=267f550c66ad5dc367d35d5601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x104fa1190>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: The size of tensor a (64) must match the size of tensor b (100) at non-singleton dimension 1
federated | ERROR flwr 2024-11-08 16:43:47,536 | ray_client_proxy.py:106 | Traceback (most recent call last):
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 94, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 398, in get_client_result
    return self._fetch_future_result(cid)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 279, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
                                         ^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=7459, ip=127.0.0.1, actor_id=d5f5709c7c2075c1494c0cd101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x104d41d10>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/message_handler/message_handler.py", line 136, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
                   ^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client.py", line 275, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 283, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/texas100/globalattack.py", line 129, in evaluate
    correct += (predicted == y).sum().item()
                ^^^^^^^^^^^^^^
RuntimeError: The size of tensor a (64) must match the size of tensor b (100) at non-singleton dimension 1

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=7459, ip=127.0.0.1, actor_id=d5f5709c7c2075c1494c0cd101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x104d41d10>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: The size of tensor a (64) must match the size of tensor b (100) at non-singleton dimension 1

federated | ERROR flwr 2024-11-08 16:43:47,537 | ray_client_proxy.py:107 | [36mray::ClientAppActor.run()[39m (pid=7456, ip=127.0.0.1, actor_id=bea7c9a2f8df3a5d3039161001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x100c53850>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/message_handler/message_handler.py", line 136, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
                   ^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client.py", line 275, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 283, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/texas100/globalattack.py", line 129, in evaluate
    correct += (predicted == y).sum().item()
                ^^^^^^^^^^^^^^
RuntimeError: The size of tensor a (64) must match the size of tensor b (100) at non-singleton dimension 1

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=7456, ip=127.0.0.1, actor_id=bea7c9a2f8df3a5d3039161001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x100c53850>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: The size of tensor a (64) must match the size of tensor b (100) at non-singleton dimension 1
federated | ERROR flwr 2024-11-08 16:43:47,537 | ray_client_proxy.py:107 | [36mray::ClientAppActor.run()[39m (pid=7459, ip=127.0.0.1, actor_id=d5f5709c7c2075c1494c0cd101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x104d41d10>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/message_handler/message_handler.py", line 136, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
                   ^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client.py", line 275, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 283, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/texas100/globalattack.py", line 129, in evaluate
    correct += (predicted == y).sum().item()
                ^^^^^^^^^^^^^^
RuntimeError: The size of tensor a (64) must match the size of tensor b (100) at non-singleton dimension 1

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=7459, ip=127.0.0.1, actor_id=d5f5709c7c2075c1494c0cd101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x104d41d10>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: The size of tensor a (64) must match the size of tensor b (100) at non-singleton dimension 1
federated | ERROR flwr 2024-11-08 16:43:48,000 | ray_client_proxy.py:106 | Traceback (most recent call last):
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 94, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 398, in get_client_result
    return self._fetch_future_result(cid)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 279, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
                                         ^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=7457, ip=127.0.0.1, actor_id=d8cd0c8a6770c4a59324b50101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x16ee1dc90>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/message_handler/message_handler.py", line 136, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
                   ^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client.py", line 275, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 283, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/texas100/globalattack.py", line 129, in evaluate
    correct += (predicted == y).sum().item()
                ^^^^^^^^^^^^^^
RuntimeError: The size of tensor a (64) must match the size of tensor b (100) at non-singleton dimension 1

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=7457, ip=127.0.0.1, actor_id=d8cd0c8a6770c4a59324b50101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x16ee1dc90>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: The size of tensor a (64) must match the size of tensor b (100) at non-singleton dimension 1

federated | ERROR flwr 2024-11-08 16:43:48,000 | ray_client_proxy.py:107 | [36mray::ClientAppActor.run()[39m (pid=7457, ip=127.0.0.1, actor_id=d8cd0c8a6770c4a59324b50101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x16ee1dc90>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/message_handler/message_handler.py", line 136, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
                   ^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client.py", line 275, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 283, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/texas100/globalattack.py", line 129, in evaluate
    correct += (predicted == y).sum().item()
                ^^^^^^^^^^^^^^
RuntimeError: The size of tensor a (64) must match the size of tensor b (100) at non-singleton dimension 1

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=7457, ip=127.0.0.1, actor_id=d8cd0c8a6770c4a59324b50101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x16ee1dc90>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: The size of tensor a (64) must match the size of tensor b (100) at non-singleton dimension 1
federated | INFO flwr 2024-11-08 16:43:48,001 | server.py:192 | aggregate_evaluate: received 0 results and 5 failures
federated | INFO flwr 2024-11-08 16:43:48,001 | server.py:112 | 
federated | INFO flwr 2024-11-08 16:43:48,001 | server.py:113 | [ROUND 5]
federated | INFO flwr 2024-11-08 16:43:48,001 | server.py:226 | configure_fit: strategy sampled 5 clients (out of 5)
federated | ERROR flwr 2024-11-08 16:44:01,032 | ray_client_proxy.py:106 | Traceback (most recent call last):
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 94, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 398, in get_client_result
    return self._fetch_future_result(cid)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 279, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
                                         ^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=7457, ip=127.0.0.1, actor_id=d8cd0c8a6770c4a59324b50101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x16ee1dc90>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/message_handler/message_handler.py", line 129, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
              ^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client.py", line 255, in maybe_call_fit
    return client.fit(fit_ins)
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 259, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/texas100/globalattack.py", line 115, in fit
    loss = self.criterion(outputs, y)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/loss.py", line 1188, in forward
    return F.cross_entropy(input, target, weight=self.weight,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/functional.py", line 3104, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected floating point type for target with class probabilities, got Long

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=7457, ip=127.0.0.1, actor_id=d8cd0c8a6770c4a59324b50101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x16ee1dc90>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Expected floating point type for target with class probabilities, got Long

federated | ERROR flwr 2024-11-08 16:44:01,033 | ray_client_proxy.py:106 | Traceback (most recent call last):
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 94, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 398, in get_client_result
    return self._fetch_future_result(cid)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 279, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
                                         ^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=7456, ip=127.0.0.1, actor_id=bea7c9a2f8df3a5d3039161001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x100c53850>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/message_handler/message_handler.py", line 129, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
              ^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client.py", line 255, in maybe_call_fit
    return client.fit(fit_ins)
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 259, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/texas100/globalattack.py", line 115, in fit
    loss = self.criterion(outputs, y)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/loss.py", line 1188, in forward
    return F.cross_entropy(input, target, weight=self.weight,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/functional.py", line 3104, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected floating point type for target with class probabilities, got Long

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=7456, ip=127.0.0.1, actor_id=bea7c9a2f8df3a5d3039161001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x100c53850>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Expected floating point type for target with class probabilities, got Long

federated | ERROR flwr 2024-11-08 16:44:01,033 | ray_client_proxy.py:107 | [36mray::ClientAppActor.run()[39m (pid=7457, ip=127.0.0.1, actor_id=d8cd0c8a6770c4a59324b50101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x16ee1dc90>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/message_handler/message_handler.py", line 129, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
              ^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client.py", line 255, in maybe_call_fit
    return client.fit(fit_ins)
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 259, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/texas100/globalattack.py", line 115, in fit
    loss = self.criterion(outputs, y)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/loss.py", line 1188, in forward
    return F.cross_entropy(input, target, weight=self.weight,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/functional.py", line 3104, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected floating point type for target with class probabilities, got Long

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=7457, ip=127.0.0.1, actor_id=d8cd0c8a6770c4a59324b50101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x16ee1dc90>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Expected floating point type for target with class probabilities, got Long
federated | ERROR flwr 2024-11-08 16:44:01,034 | ray_client_proxy.py:106 | Traceback (most recent call last):
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 94, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 398, in get_client_result
    return self._fetch_future_result(cid)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 279, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
                                         ^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=7458, ip=127.0.0.1, actor_id=267f550c66ad5dc367d35d5601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x104fa1190>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/message_handler/message_handler.py", line 129, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
              ^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client.py", line 255, in maybe_call_fit
    return client.fit(fit_ins)
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 259, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/texas100/globalattack.py", line 115, in fit
    loss = self.criterion(outputs, y)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/loss.py", line 1188, in forward
    return F.cross_entropy(input, target, weight=self.weight,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/functional.py", line 3104, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected floating point type for target with class probabilities, got Long

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=7458, ip=127.0.0.1, actor_id=267f550c66ad5dc367d35d5601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x104fa1190>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Expected floating point type for target with class probabilities, got Long

federated | ERROR flwr 2024-11-08 16:44:01,034 | ray_client_proxy.py:107 | [36mray::ClientAppActor.run()[39m (pid=7456, ip=127.0.0.1, actor_id=bea7c9a2f8df3a5d3039161001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x100c53850>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/message_handler/message_handler.py", line 129, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
              ^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client.py", line 255, in maybe_call_fit
    return client.fit(fit_ins)
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 259, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/texas100/globalattack.py", line 115, in fit
    loss = self.criterion(outputs, y)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/loss.py", line 1188, in forward
    return F.cross_entropy(input, target, weight=self.weight,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/functional.py", line 3104, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected floating point type for target with class probabilities, got Long

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=7456, ip=127.0.0.1, actor_id=bea7c9a2f8df3a5d3039161001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x100c53850>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Expected floating point type for target with class probabilities, got Long
federated | ERROR flwr 2024-11-08 16:44:01,034 | ray_client_proxy.py:107 | [36mray::ClientAppActor.run()[39m (pid=7458, ip=127.0.0.1, actor_id=267f550c66ad5dc367d35d5601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x104fa1190>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/message_handler/message_handler.py", line 129, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
              ^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client.py", line 255, in maybe_call_fit
    return client.fit(fit_ins)
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 259, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/texas100/globalattack.py", line 115, in fit
    loss = self.criterion(outputs, y)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/loss.py", line 1188, in forward
    return F.cross_entropy(input, target, weight=self.weight,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/functional.py", line 3104, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected floating point type for target with class probabilities, got Long

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=7458, ip=127.0.0.1, actor_id=267f550c66ad5dc367d35d5601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x104fa1190>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Expected floating point type for target with class probabilities, got Long
federated | ERROR flwr 2024-11-08 16:44:01,034 | ray_client_proxy.py:106 | Traceback (most recent call last):
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 94, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 398, in get_client_result
    return self._fetch_future_result(cid)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 279, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
                                         ^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=7459, ip=127.0.0.1, actor_id=d5f5709c7c2075c1494c0cd101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x104d41d10>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/message_handler/message_handler.py", line 129, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
              ^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client.py", line 255, in maybe_call_fit
    return client.fit(fit_ins)
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 259, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/texas100/globalattack.py", line 115, in fit
    loss = self.criterion(outputs, y)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/loss.py", line 1188, in forward
    return F.cross_entropy(input, target, weight=self.weight,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/functional.py", line 3104, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected floating point type for target with class probabilities, got Long

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=7459, ip=127.0.0.1, actor_id=d5f5709c7c2075c1494c0cd101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x104d41d10>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Expected floating point type for target with class probabilities, got Long

federated | ERROR flwr 2024-11-08 16:44:01,034 | ray_client_proxy.py:107 | [36mray::ClientAppActor.run()[39m (pid=7459, ip=127.0.0.1, actor_id=d5f5709c7c2075c1494c0cd101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x104d41d10>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/message_handler/message_handler.py", line 129, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
              ^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client.py", line 255, in maybe_call_fit
    return client.fit(fit_ins)
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 259, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/texas100/globalattack.py", line 115, in fit
    loss = self.criterion(outputs, y)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/loss.py", line 1188, in forward
    return F.cross_entropy(input, target, weight=self.weight,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/functional.py", line 3104, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected floating point type for target with class probabilities, got Long

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=7459, ip=127.0.0.1, actor_id=d5f5709c7c2075c1494c0cd101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x104d41d10>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Expected floating point type for target with class probabilities, got Long
federated | ERROR flwr 2024-11-08 16:44:01,709 | ray_client_proxy.py:106 | Traceback (most recent call last):
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 94, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 398, in get_client_result
    return self._fetch_future_result(cid)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 279, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
                                         ^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=7455, ip=127.0.0.1, actor_id=2e691067daf42eaca771f11601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x103453710>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/message_handler/message_handler.py", line 129, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
              ^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client.py", line 255, in maybe_call_fit
    return client.fit(fit_ins)
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 259, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/texas100/globalattack.py", line 115, in fit
    loss = self.criterion(outputs, y)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/loss.py", line 1188, in forward
    return F.cross_entropy(input, target, weight=self.weight,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/functional.py", line 3104, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected floating point type for target with class probabilities, got Long

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=7455, ip=127.0.0.1, actor_id=2e691067daf42eaca771f11601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x103453710>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Expected floating point type for target with class probabilities, got Long

federated | ERROR flwr 2024-11-08 16:44:01,709 | ray_client_proxy.py:107 | [36mray::ClientAppActor.run()[39m (pid=7455, ip=127.0.0.1, actor_id=2e691067daf42eaca771f11601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x103453710>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/message_handler/message_handler.py", line 129, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
              ^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client.py", line 255, in maybe_call_fit
    return client.fit(fit_ins)
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 259, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/texas100/globalattack.py", line 115, in fit
    loss = self.criterion(outputs, y)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/loss.py", line 1188, in forward
    return F.cross_entropy(input, target, weight=self.weight,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/functional.py", line 3104, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected floating point type for target with class probabilities, got Long

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=7455, ip=127.0.0.1, actor_id=2e691067daf42eaca771f11601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x103453710>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Expected floating point type for target with class probabilities, got Long
federated | INFO flwr 2024-11-08 16:44:01,709 | server.py:240 | aggregate_fit: received 0 results and 5 failures
federated | INFO flwr 2024-11-08 16:44:01,710 | server.py:178 | configure_evaluate: strategy sampled 5 clients (out of 5)
federated | ERROR flwr 2024-11-08 16:44:16,886 | ray_client_proxy.py:106 | Traceback (most recent call last):
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 94, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 398, in get_client_result
    return self._fetch_future_result(cid)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 279, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
                                         ^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=7455, ip=127.0.0.1, actor_id=2e691067daf42eaca771f11601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x103453710>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/message_handler/message_handler.py", line 136, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
                   ^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client.py", line 275, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 283, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/texas100/globalattack.py", line 129, in evaluate
    labels = torch.argmax(y, dim=1) if y.dim() > 1 else y  # Convert y to class indices if one-hot encoded
                ^^^^^^^^^^^^^^
RuntimeError: The size of tensor a (64) must match the size of tensor b (100) at non-singleton dimension 1

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=7455, ip=127.0.0.1, actor_id=2e691067daf42eaca771f11601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x103453710>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: The size of tensor a (64) must match the size of tensor b (100) at non-singleton dimension 1

federated | ERROR flwr 2024-11-08 16:44:16,887 | ray_client_proxy.py:106 | Traceback (most recent call last):
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 94, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 398, in get_client_result
    return self._fetch_future_result(cid)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 279, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
                                         ^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=7458, ip=127.0.0.1, actor_id=267f550c66ad5dc367d35d5601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x104fa1190>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/message_handler/message_handler.py", line 136, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
                   ^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client.py", line 275, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 283, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/texas100/globalattack.py", line 129, in evaluate
    labels = torch.argmax(y, dim=1) if y.dim() > 1 else y  # Convert y to class indices if one-hot encoded
                ^^^^^^^^^^^^^^
RuntimeError: The size of tensor a (64) must match the size of tensor b (100) at non-singleton dimension 1

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=7458, ip=127.0.0.1, actor_id=267f550c66ad5dc367d35d5601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x104fa1190>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: The size of tensor a (64) must match the size of tensor b (100) at non-singleton dimension 1

federated | ERROR flwr 2024-11-08 16:44:16,888 | ray_client_proxy.py:106 | Traceback (most recent call last):
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 94, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 398, in get_client_result
    return self._fetch_future_result(cid)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 279, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
                                         ^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=7456, ip=127.0.0.1, actor_id=bea7c9a2f8df3a5d3039161001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x100c53850>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/message_handler/message_handler.py", line 136, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
                   ^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client.py", line 275, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 283, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/texas100/globalattack.py", line 129, in evaluate
    labels = torch.argmax(y, dim=1) if y.dim() > 1 else y  # Convert y to class indices if one-hot encoded
                ^^^^^^^^^^^^^^
RuntimeError: The size of tensor a (64) must match the size of tensor b (100) at non-singleton dimension 1

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=7456, ip=127.0.0.1, actor_id=bea7c9a2f8df3a5d3039161001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x100c53850>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: The size of tensor a (64) must match the size of tensor b (100) at non-singleton dimension 1

federated | ERROR flwr 2024-11-08 16:44:16,888 | ray_client_proxy.py:106 | Traceback (most recent call last):
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 94, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 398, in get_client_result
    return self._fetch_future_result(cid)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 279, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
                                         ^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=7459, ip=127.0.0.1, actor_id=d5f5709c7c2075c1494c0cd101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x104d41d10>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/message_handler/message_handler.py", line 136, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
                   ^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client.py", line 275, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 283, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/texas100/globalattack.py", line 129, in evaluate
    labels = torch.argmax(y, dim=1) if y.dim() > 1 else y  # Convert y to class indices if one-hot encoded
                ^^^^^^^^^^^^^^
RuntimeError: The size of tensor a (64) must match the size of tensor b (100) at non-singleton dimension 1

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=7459, ip=127.0.0.1, actor_id=d5f5709c7c2075c1494c0cd101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x104d41d10>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: The size of tensor a (64) must match the size of tensor b (100) at non-singleton dimension 1

federated | ERROR flwr 2024-11-08 16:44:16,888 | ray_client_proxy.py:107 | [36mray::ClientAppActor.run()[39m (pid=7455, ip=127.0.0.1, actor_id=2e691067daf42eaca771f11601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x103453710>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/message_handler/message_handler.py", line 136, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
                   ^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client.py", line 275, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 283, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/texas100/globalattack.py", line 129, in evaluate
    labels = torch.argmax(y, dim=1) if y.dim() > 1 else y  # Convert y to class indices if one-hot encoded
                ^^^^^^^^^^^^^^
RuntimeError: The size of tensor a (64) must match the size of tensor b (100) at non-singleton dimension 1

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=7455, ip=127.0.0.1, actor_id=2e691067daf42eaca771f11601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x103453710>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: The size of tensor a (64) must match the size of tensor b (100) at non-singleton dimension 1
federated | ERROR flwr 2024-11-08 16:44:16,888 | ray_client_proxy.py:107 | [36mray::ClientAppActor.run()[39m (pid=7458, ip=127.0.0.1, actor_id=267f550c66ad5dc367d35d5601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x104fa1190>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/message_handler/message_handler.py", line 136, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
                   ^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client.py", line 275, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 283, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/texas100/globalattack.py", line 129, in evaluate
    labels = torch.argmax(y, dim=1) if y.dim() > 1 else y  # Convert y to class indices if one-hot encoded
                ^^^^^^^^^^^^^^
RuntimeError: The size of tensor a (64) must match the size of tensor b (100) at non-singleton dimension 1

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=7458, ip=127.0.0.1, actor_id=267f550c66ad5dc367d35d5601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x104fa1190>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: The size of tensor a (64) must match the size of tensor b (100) at non-singleton dimension 1
federated | ERROR flwr 2024-11-08 16:44:16,888 | ray_client_proxy.py:107 | [36mray::ClientAppActor.run()[39m (pid=7456, ip=127.0.0.1, actor_id=bea7c9a2f8df3a5d3039161001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x100c53850>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/message_handler/message_handler.py", line 136, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
                   ^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client.py", line 275, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 283, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/texas100/globalattack.py", line 129, in evaluate
    labels = torch.argmax(y, dim=1) if y.dim() > 1 else y  # Convert y to class indices if one-hot encoded
                ^^^^^^^^^^^^^^
RuntimeError: The size of tensor a (64) must match the size of tensor b (100) at non-singleton dimension 1

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=7456, ip=127.0.0.1, actor_id=bea7c9a2f8df3a5d3039161001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x100c53850>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: The size of tensor a (64) must match the size of tensor b (100) at non-singleton dimension 1
federated | ERROR flwr 2024-11-08 16:44:16,888 | ray_client_proxy.py:107 | [36mray::ClientAppActor.run()[39m (pid=7459, ip=127.0.0.1, actor_id=d5f5709c7c2075c1494c0cd101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x104d41d10>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/message_handler/message_handler.py", line 136, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
                   ^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client.py", line 275, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 283, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/texas100/globalattack.py", line 129, in evaluate
    labels = torch.argmax(y, dim=1) if y.dim() > 1 else y  # Convert y to class indices if one-hot encoded
                ^^^^^^^^^^^^^^
RuntimeError: The size of tensor a (64) must match the size of tensor b (100) at non-singleton dimension 1

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=7459, ip=127.0.0.1, actor_id=d5f5709c7c2075c1494c0cd101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x104d41d10>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: The size of tensor a (64) must match the size of tensor b (100) at non-singleton dimension 1
federated | ERROR flwr 2024-11-08 16:44:17,363 | ray_client_proxy.py:106 | Traceback (most recent call last):
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 94, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 398, in get_client_result
    return self._fetch_future_result(cid)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 279, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
                                         ^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=7457, ip=127.0.0.1, actor_id=d8cd0c8a6770c4a59324b50101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x16ee1dc90>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/message_handler/message_handler.py", line 136, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
                   ^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client.py", line 275, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 283, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/texas100/globalattack.py", line 129, in evaluate
    labels = torch.argmax(y, dim=1) if y.dim() > 1 else y  # Convert y to class indices if one-hot encoded
                ^^^^^^^^^^^^^^
RuntimeError: The size of tensor a (64) must match the size of tensor b (100) at non-singleton dimension 1

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=7457, ip=127.0.0.1, actor_id=d8cd0c8a6770c4a59324b50101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x16ee1dc90>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: The size of tensor a (64) must match the size of tensor b (100) at non-singleton dimension 1

federated | ERROR flwr 2024-11-08 16:44:17,363 | ray_client_proxy.py:107 | [36mray::ClientAppActor.run()[39m (pid=7457, ip=127.0.0.1, actor_id=d8cd0c8a6770c4a59324b50101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x16ee1dc90>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/message_handler/message_handler.py", line 136, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
                   ^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client.py", line 275, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 283, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/texas100/globalattack.py", line 129, in evaluate
    labels = torch.argmax(y, dim=1) if y.dim() > 1 else y  # Convert y to class indices if one-hot encoded
                ^^^^^^^^^^^^^^
RuntimeError: The size of tensor a (64) must match the size of tensor b (100) at non-singleton dimension 1

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=7457, ip=127.0.0.1, actor_id=d8cd0c8a6770c4a59324b50101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x16ee1dc90>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: The size of tensor a (64) must match the size of tensor b (100) at non-singleton dimension 1
federated | INFO flwr 2024-11-08 16:44:17,363 | server.py:192 | aggregate_evaluate: received 0 results and 5 failures
federated | INFO flwr 2024-11-08 16:44:17,363 | server.py:112 | 
federated | INFO flwr 2024-11-08 16:44:17,363 | server.py:113 | [ROUND 6]
federated | INFO flwr 2024-11-08 16:44:17,363 | server.py:226 | configure_fit: strategy sampled 5 clients (out of 5)
federated | INFO flwr 2024-11-08 16:44:35,988 | app.py:219 | Starting Flower simulation, config: num_rounds=10, no round_timeout
federated | INFO flwr 2024-11-08 16:44:38,408 | app.py:242 | Flower VCE: Ray initialized with resources: {'memory': 5838954496.0, 'node:__internal_head__': 1.0, 'CPU': 8.0, 'object_store_memory': 2147483648.0, 'node:127.0.0.1': 1.0}
federated | INFO flwr 2024-11-08 16:44:38,408 | app.py:248 | Optimize your simulation with Flower VCE: https://flower.ai/docs/framework/how-to-run-simulations.html
federated | INFO flwr 2024-11-08 16:44:38,408 | app.py:256 | No `client_resources` specified. Using minimal resources for clients.
federated | INFO flwr 2024-11-08 16:44:38,408 | app.py:271 | Flower VCE: Resources for each Virtual Client: {'num_cpus': 1, 'num_gpus': 0.0}
federated | INFO flwr 2024-11-08 16:44:38,422 | app.py:317 | Flower VCE: Creating VirtualClientEngineActorPool with 8 actors
federated | INFO flwr 2024-11-08 16:44:38,423 | server.py:92 | [INIT]
federated | INFO flwr 2024-11-08 16:44:38,423 | server.py:281 | Requesting initial parameters from one random client
federated | INFO flwr 2024-11-08 16:44:45,389 | server.py:288 | Received initial parameters from one random client
federated | INFO flwr 2024-11-08 16:44:45,389 | server.py:94 | Starting evaluation of initial global parameters
federated | INFO flwr 2024-11-08 16:44:45,389 | server.py:106 | Evaluation returned no results (`None`)
federated | INFO flwr 2024-11-08 16:44:45,389 | server.py:112 | 
federated | INFO flwr 2024-11-08 16:44:45,389 | server.py:113 | [ROUND 1]
federated | INFO flwr 2024-11-08 16:44:45,390 | server.py:226 | configure_fit: strategy sampled 5 clients (out of 5)
federated | ERROR flwr 2024-11-08 16:44:59,916 | ray_client_proxy.py:106 | Traceback (most recent call last):
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 94, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 398, in get_client_result
    return self._fetch_future_result(cid)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 279, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
                                         ^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=7619, ip=127.0.0.1, actor_id=1d07c852fb6187d9086b687401000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x167b12710>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/message_handler/message_handler.py", line 129, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
              ^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client.py", line 255, in maybe_call_fit
    return client.fit(fit_ins)
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 259, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/texas100/globalattack.py", line 115, in fit
    loss = self.criterion(outputs, y)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/loss.py", line 1188, in forward
    return F.cross_entropy(input, target, weight=self.weight,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/functional.py", line 3104, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected floating point type for target with class probabilities, got Long

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=7619, ip=127.0.0.1, actor_id=1d07c852fb6187d9086b687401000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x167b12710>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Expected floating point type for target with class probabilities, got Long

federated | ERROR flwr 2024-11-08 16:44:59,916 | ray_client_proxy.py:106 | Traceback (most recent call last):
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 94, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 398, in get_client_result
    return self._fetch_future_result(cid)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 279, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
                                         ^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=7618, ip=127.0.0.1, actor_id=e60f7d6b3644562e2dab0f2101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x10303fc90>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/message_handler/message_handler.py", line 129, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
              ^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client.py", line 255, in maybe_call_fit
    return client.fit(fit_ins)
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 259, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/texas100/globalattack.py", line 115, in fit
    loss = self.criterion(outputs, y)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/loss.py", line 1188, in forward
    return F.cross_entropy(input, target, weight=self.weight,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/functional.py", line 3104, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected floating point type for target with class probabilities, got Long

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=7618, ip=127.0.0.1, actor_id=e60f7d6b3644562e2dab0f2101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x10303fc90>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Expected floating point type for target with class probabilities, got Long

federated | ERROR flwr 2024-11-08 16:44:59,917 | ray_client_proxy.py:106 | Traceback (most recent call last):
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 94, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 398, in get_client_result
    return self._fetch_future_result(cid)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 279, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
                                         ^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=7620, ip=127.0.0.1, actor_id=3f145736ebe5029c6e45a93901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x167977110>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/message_handler/message_handler.py", line 129, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
              ^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client.py", line 255, in maybe_call_fit
    return client.fit(fit_ins)
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 259, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/texas100/globalattack.py", line 115, in fit
    loss = self.criterion(outputs, y)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/loss.py", line 1188, in forward
    return F.cross_entropy(input, target, weight=self.weight,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/functional.py", line 3104, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected floating point type for target with class probabilities, got Long

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=7620, ip=127.0.0.1, actor_id=3f145736ebe5029c6e45a93901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x167977110>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Expected floating point type for target with class probabilities, got Long

federated | ERROR flwr 2024-11-08 16:44:59,917 | ray_client_proxy.py:106 | Traceback (most recent call last):
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 94, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 398, in get_client_result
    return self._fetch_future_result(cid)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 279, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
                                         ^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=7621, ip=127.0.0.1, actor_id=fd5aab78596b9903a69e96fa01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x102d81b50>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/message_handler/message_handler.py", line 129, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
              ^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client.py", line 255, in maybe_call_fit
    return client.fit(fit_ins)
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 259, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/texas100/globalattack.py", line 115, in fit
    loss = self.criterion(outputs, y)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/loss.py", line 1188, in forward
    return F.cross_entropy(input, target, weight=self.weight,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/functional.py", line 3104, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected floating point type for target with class probabilities, got Long

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=7621, ip=127.0.0.1, actor_id=fd5aab78596b9903a69e96fa01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x102d81b50>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Expected floating point type for target with class probabilities, got Long

federated | ERROR flwr 2024-11-08 16:44:59,917 | ray_client_proxy.py:107 | [36mray::ClientAppActor.run()[39m (pid=7619, ip=127.0.0.1, actor_id=1d07c852fb6187d9086b687401000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x167b12710>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/message_handler/message_handler.py", line 129, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
              ^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client.py", line 255, in maybe_call_fit
    return client.fit(fit_ins)
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 259, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/texas100/globalattack.py", line 115, in fit
    loss = self.criterion(outputs, y)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/loss.py", line 1188, in forward
    return F.cross_entropy(input, target, weight=self.weight,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/functional.py", line 3104, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected floating point type for target with class probabilities, got Long

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=7619, ip=127.0.0.1, actor_id=1d07c852fb6187d9086b687401000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x167b12710>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Expected floating point type for target with class probabilities, got Long
federated | ERROR flwr 2024-11-08 16:44:59,917 | ray_client_proxy.py:107 | [36mray::ClientAppActor.run()[39m (pid=7618, ip=127.0.0.1, actor_id=e60f7d6b3644562e2dab0f2101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x10303fc90>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/message_handler/message_handler.py", line 129, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
              ^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client.py", line 255, in maybe_call_fit
    return client.fit(fit_ins)
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 259, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/texas100/globalattack.py", line 115, in fit
    loss = self.criterion(outputs, y)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/loss.py", line 1188, in forward
    return F.cross_entropy(input, target, weight=self.weight,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/functional.py", line 3104, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected floating point type for target with class probabilities, got Long

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=7618, ip=127.0.0.1, actor_id=e60f7d6b3644562e2dab0f2101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x10303fc90>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Expected floating point type for target with class probabilities, got Long
federated | ERROR flwr 2024-11-08 16:44:59,917 | ray_client_proxy.py:107 | [36mray::ClientAppActor.run()[39m (pid=7620, ip=127.0.0.1, actor_id=3f145736ebe5029c6e45a93901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x167977110>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/message_handler/message_handler.py", line 129, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
              ^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client.py", line 255, in maybe_call_fit
    return client.fit(fit_ins)
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 259, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/texas100/globalattack.py", line 115, in fit
    loss = self.criterion(outputs, y)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/loss.py", line 1188, in forward
    return F.cross_entropy(input, target, weight=self.weight,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/functional.py", line 3104, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected floating point type for target with class probabilities, got Long

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=7620, ip=127.0.0.1, actor_id=3f145736ebe5029c6e45a93901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x167977110>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Expected floating point type for target with class probabilities, got Long
federated | ERROR flwr 2024-11-08 16:44:59,917 | ray_client_proxy.py:107 | [36mray::ClientAppActor.run()[39m (pid=7621, ip=127.0.0.1, actor_id=fd5aab78596b9903a69e96fa01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x102d81b50>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/message_handler/message_handler.py", line 129, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
              ^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client.py", line 255, in maybe_call_fit
    return client.fit(fit_ins)
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 259, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/texas100/globalattack.py", line 115, in fit
    loss = self.criterion(outputs, y)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/loss.py", line 1188, in forward
    return F.cross_entropy(input, target, weight=self.weight,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/functional.py", line 3104, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected floating point type for target with class probabilities, got Long

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=7621, ip=127.0.0.1, actor_id=fd5aab78596b9903a69e96fa01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x102d81b50>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Expected floating point type for target with class probabilities, got Long
federated | ERROR flwr 2024-11-08 16:45:02,351 | ray_client_proxy.py:106 | Traceback (most recent call last):
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 94, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 398, in get_client_result
    return self._fetch_future_result(cid)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 279, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
                                         ^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=7617, ip=127.0.0.1, actor_id=b591f2382f60334ce3c815b401000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x103381190>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/message_handler/message_handler.py", line 129, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
              ^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client.py", line 255, in maybe_call_fit
    return client.fit(fit_ins)
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 259, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/texas100/globalattack.py", line 115, in fit
    loss = self.criterion(outputs, y)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/loss.py", line 1188, in forward
    return F.cross_entropy(input, target, weight=self.weight,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/functional.py", line 3104, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected floating point type for target with class probabilities, got Long

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=7617, ip=127.0.0.1, actor_id=b591f2382f60334ce3c815b401000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x103381190>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Expected floating point type for target with class probabilities, got Long

federated | ERROR flwr 2024-11-08 16:45:02,351 | ray_client_proxy.py:107 | [36mray::ClientAppActor.run()[39m (pid=7617, ip=127.0.0.1, actor_id=b591f2382f60334ce3c815b401000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x103381190>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/message_handler/message_handler.py", line 129, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
              ^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client.py", line 255, in maybe_call_fit
    return client.fit(fit_ins)
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 259, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/texas100/globalattack.py", line 115, in fit
    loss = self.criterion(outputs, y)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/loss.py", line 1188, in forward
    return F.cross_entropy(input, target, weight=self.weight,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/functional.py", line 3104, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected floating point type for target with class probabilities, got Long

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=7617, ip=127.0.0.1, actor_id=b591f2382f60334ce3c815b401000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x103381190>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Expected floating point type for target with class probabilities, got Long
federated | INFO flwr 2024-11-08 16:45:02,352 | server.py:240 | aggregate_fit: received 0 results and 5 failures
federated | INFO flwr 2024-11-08 16:45:02,352 | server.py:178 | configure_evaluate: strategy sampled 5 clients (out of 5)
globalattack | INFO flwr 2024-11-08 16:47:18,362 | app.py:219 | Starting Flower simulation, config: num_rounds=10, no round_timeout
globalattack | INFO flwr 2024-11-08 16:47:20,710 | app.py:242 | Flower VCE: Ray initialized with resources: {'memory': 5285389927.0, 'CPU': 8.0, 'node:127.0.0.1': 1.0, 'object_store_memory': 2147483648.0, 'node:__internal_head__': 1.0}
globalattack | INFO flwr 2024-11-08 16:47:20,710 | app.py:248 | Optimize your simulation with Flower VCE: https://flower.ai/docs/framework/how-to-run-simulations.html
globalattack | INFO flwr 2024-11-08 16:47:20,710 | app.py:256 | No `client_resources` specified. Using minimal resources for clients.
globalattack | INFO flwr 2024-11-08 16:47:20,710 | app.py:271 | Flower VCE: Resources for each Virtual Client: {'num_cpus': 1, 'num_gpus': 0.0}
globalattack | INFO flwr 2024-11-08 16:47:20,722 | app.py:317 | Flower VCE: Creating VirtualClientEngineActorPool with 8 actors
globalattack | INFO flwr 2024-11-08 16:47:20,722 | server.py:92 | [INIT]
globalattack | INFO flwr 2024-11-08 16:47:20,722 | server.py:281 | Requesting initial parameters from one random client
globalattack | ERROR flwr 2024-11-08 16:47:35,866 | ray_client_proxy.py:106 | Traceback (most recent call last):
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 94, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 398, in get_client_result
    return self._fetch_future_result(cid)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 279, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
                                         ^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=7705, ip=127.0.0.1, actor_id=85c4819fc60f6a66a20a600a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x174838390>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/message_handler/message_handler.py", line 95, in handle_legacy_message_from_msgtype
    client = client_fn(context)
             ^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 67, in adaptor_fn
    return client_fn(str(cid))  # type: ignore
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/texas100/globalattack.py", line 143, in client_fn
    return FlowerClient(model, int(cid), data_loader)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: FlowerClient.__init__() takes 3 positional arguments but 4 were given

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=7705, ip=127.0.0.1, actor_id=85c4819fc60f6a66a20a600a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x174838390>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: FlowerClient.__init__() takes 3 positional arguments but 4 were given

globalattack | ERROR flwr 2024-11-08 16:47:35,866 | ray_client_proxy.py:107 | [36mray::ClientAppActor.run()[39m (pid=7705, ip=127.0.0.1, actor_id=85c4819fc60f6a66a20a600a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x174838390>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/message_handler/message_handler.py", line 95, in handle_legacy_message_from_msgtype
    client = client_fn(context)
             ^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 67, in adaptor_fn
    return client_fn(str(cid))  # type: ignore
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/texas100/globalattack.py", line 143, in client_fn
    return FlowerClient(model, int(cid), data_loader)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: FlowerClient.__init__() takes 3 positional arguments but 4 were given

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=7705, ip=127.0.0.1, actor_id=85c4819fc60f6a66a20a600a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x174838390>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: FlowerClient.__init__() takes 3 positional arguments but 4 were given
globalattack | ERROR flwr 2024-11-08 16:47:35,866 | app.py:344 | [36mray::ClientAppActor.run()[39m (pid=7705, ip=127.0.0.1, actor_id=85c4819fc60f6a66a20a600a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x174838390>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/message_handler/message_handler.py", line 95, in handle_legacy_message_from_msgtype
    client = client_fn(context)
             ^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 67, in adaptor_fn
    return client_fn(str(cid))  # type: ignore
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/texas100/globalattack.py", line 143, in client_fn
    return FlowerClient(model, int(cid), data_loader)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: FlowerClient.__init__() takes 3 positional arguments but 4 were given

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=7705, ip=127.0.0.1, actor_id=85c4819fc60f6a66a20a600a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x174838390>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: FlowerClient.__init__() takes 3 positional arguments but 4 were given
globalattack | ERROR flwr 2024-11-08 16:47:35,867 | app.py:345 | Traceback (most recent call last):
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/app.py", line 339, in start_simulation
    hist = run_fl(
           ^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/server/server.py", line 492, in run_fl
    hist, elapsed_time = server.fit(
                         ^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/server/server.py", line 93, in fit
    self.parameters = self._get_initial_parameters(server_round=0, timeout=timeout)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/server/server.py", line 284, in _get_initial_parameters
    get_parameters_res = random_client.get_parameters(
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 168, in get_parameters
    message_out = self._submit_job(message, timeout)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 108, in _submit_job
    raise ex
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 94, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 398, in get_client_result
    return self._fetch_future_result(cid)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 279, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
                                         ^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=7705, ip=127.0.0.1, actor_id=85c4819fc60f6a66a20a600a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x174838390>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/message_handler/message_handler.py", line 95, in handle_legacy_message_from_msgtype
    client = client_fn(context)
             ^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 67, in adaptor_fn
    return client_fn(str(cid))  # type: ignore
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/texas100/globalattack.py", line 143, in client_fn
    return FlowerClient(model, int(cid), data_loader)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: FlowerClient.__init__() takes 3 positional arguments but 4 were given

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=7705, ip=127.0.0.1, actor_id=85c4819fc60f6a66a20a600a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x174838390>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: FlowerClient.__init__() takes 3 positional arguments but 4 were given

globalattack | ERROR flwr 2024-11-08 16:47:35,867 | app.py:346 | Your simulation crashed :(. This could be because of several reasons. The most common are: 
	 > Sometimes, issues in the simulation code itself can cause crashes. It's always a good idea to double-check your code for any potential bugs or inconsistencies that might be contributing to the problem. For example: 
		 - You might be using a class attribute in your clients that hasn't been defined.
		 - There could be an incorrect method call to a 3rd party library (e.g., PyTorch).
		 - The return types of methods in your clients/strategies might be incorrect.
	 > Your system couldn't fit a single VirtualClient: try lowering `client_resources`.
	 > All the actors in your pool crashed. This could be because: 
		 - You clients hit an out-of-memory (OOM) error and actors couldn't recover from it. Try launching your simulation with more generous `client_resources` setting (i.e. it seems {'num_cpus': 1, 'num_gpus': 0.0} is not enough for your run). Use fewer concurrent actors. 
		 - You were running a multi-node simulation and all worker nodes disconnected. The head node might still be alive but cannot accommodate any actor with resources: {'num_cpus': 1, 'num_gpus': 0.0}.
Take a look at the Flower simulation examples for guidance <https://flower.ai/docs/framework/how-to-run-simulations.html>.
globalattack | INFO flwr 2024-11-08 16:48:47,752 | app.py:219 | Starting Flower simulation, config: num_rounds=10, no round_timeout
globalattack | INFO flwr 2024-11-08 16:48:50,077 | app.py:242 | Flower VCE: Ray initialized with resources: {'node:__internal_head__': 1.0, 'node:127.0.0.1': 1.0, 'object_store_memory': 2147483648.0, 'CPU': 8.0, 'memory': 5763250586.0}
globalattack | INFO flwr 2024-11-08 16:48:50,077 | app.py:248 | Optimize your simulation with Flower VCE: https://flower.ai/docs/framework/how-to-run-simulations.html
globalattack | INFO flwr 2024-11-08 16:48:50,077 | app.py:256 | No `client_resources` specified. Using minimal resources for clients.
globalattack | INFO flwr 2024-11-08 16:48:50,077 | app.py:271 | Flower VCE: Resources for each Virtual Client: {'num_cpus': 1, 'num_gpus': 0.0}
globalattack | INFO flwr 2024-11-08 16:48:50,088 | app.py:317 | Flower VCE: Creating VirtualClientEngineActorPool with 8 actors
globalattack | INFO flwr 2024-11-08 16:48:50,088 | server.py:92 | [INIT]
globalattack | INFO flwr 2024-11-08 16:48:50,088 | server.py:281 | Requesting initial parameters from one random client
globalattack | ERROR flwr 2024-11-08 16:49:04,399 | ray_client_proxy.py:106 | Traceback (most recent call last):
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 94, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 398, in get_client_result
    return self._fetch_future_result(cid)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 279, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
                                         ^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=7766, ip=127.0.0.1, actor_id=9747ff8435152bdfdbc42c3401000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x157232350>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/message_handler/message_handler.py", line 95, in handle_legacy_message_from_msgtype
    client = client_fn(context)
             ^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 67, in adaptor_fn
    return client_fn(str(cid))  # type: ignore
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/texas100/globalattack.py", line 143, in client_fn
    return FlowerClient(model, int(cid), data_loader)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: FlowerClient.__init__() takes 3 positional arguments but 4 were given

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=7766, ip=127.0.0.1, actor_id=9747ff8435152bdfdbc42c3401000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x157232350>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: FlowerClient.__init__() takes 3 positional arguments but 4 were given

globalattack | ERROR flwr 2024-11-08 16:49:04,399 | ray_client_proxy.py:107 | [36mray::ClientAppActor.run()[39m (pid=7766, ip=127.0.0.1, actor_id=9747ff8435152bdfdbc42c3401000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x157232350>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/message_handler/message_handler.py", line 95, in handle_legacy_message_from_msgtype
    client = client_fn(context)
             ^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 67, in adaptor_fn
    return client_fn(str(cid))  # type: ignore
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/texas100/globalattack.py", line 143, in client_fn
    return FlowerClient(model, int(cid), data_loader)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: FlowerClient.__init__() takes 3 positional arguments but 4 were given

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=7766, ip=127.0.0.1, actor_id=9747ff8435152bdfdbc42c3401000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x157232350>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: FlowerClient.__init__() takes 3 positional arguments but 4 were given
globalattack | ERROR flwr 2024-11-08 16:49:04,399 | app.py:344 | [36mray::ClientAppActor.run()[39m (pid=7766, ip=127.0.0.1, actor_id=9747ff8435152bdfdbc42c3401000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x157232350>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/message_handler/message_handler.py", line 95, in handle_legacy_message_from_msgtype
    client = client_fn(context)
             ^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 67, in adaptor_fn
    return client_fn(str(cid))  # type: ignore
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/texas100/globalattack.py", line 143, in client_fn
    return FlowerClient(model, int(cid), data_loader)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: FlowerClient.__init__() takes 3 positional arguments but 4 were given

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=7766, ip=127.0.0.1, actor_id=9747ff8435152bdfdbc42c3401000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x157232350>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: FlowerClient.__init__() takes 3 positional arguments but 4 were given
globalattack | ERROR flwr 2024-11-08 16:49:04,400 | app.py:345 | Traceback (most recent call last):
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/app.py", line 339, in start_simulation
    hist = run_fl(
           ^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/server/server.py", line 492, in run_fl
    hist, elapsed_time = server.fit(
                         ^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/server/server.py", line 93, in fit
    self.parameters = self._get_initial_parameters(server_round=0, timeout=timeout)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/server/server.py", line 284, in _get_initial_parameters
    get_parameters_res = random_client.get_parameters(
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 168, in get_parameters
    message_out = self._submit_job(message, timeout)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 108, in _submit_job
    raise ex
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 94, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 398, in get_client_result
    return self._fetch_future_result(cid)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 279, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
                                         ^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=7766, ip=127.0.0.1, actor_id=9747ff8435152bdfdbc42c3401000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x157232350>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/message_handler/message_handler.py", line 95, in handle_legacy_message_from_msgtype
    client = client_fn(context)
             ^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 67, in adaptor_fn
    return client_fn(str(cid))  # type: ignore
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/texas100/globalattack.py", line 143, in client_fn
    return FlowerClient(model, int(cid), data_loader)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: FlowerClient.__init__() takes 3 positional arguments but 4 were given

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=7766, ip=127.0.0.1, actor_id=9747ff8435152bdfdbc42c3401000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x157232350>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: FlowerClient.__init__() takes 3 positional arguments but 4 were given

globalattack | ERROR flwr 2024-11-08 16:49:04,400 | app.py:346 | Your simulation crashed :(. This could be because of several reasons. The most common are: 
	 > Sometimes, issues in the simulation code itself can cause crashes. It's always a good idea to double-check your code for any potential bugs or inconsistencies that might be contributing to the problem. For example: 
		 - You might be using a class attribute in your clients that hasn't been defined.
		 - There could be an incorrect method call to a 3rd party library (e.g., PyTorch).
		 - The return types of methods in your clients/strategies might be incorrect.
	 > Your system couldn't fit a single VirtualClient: try lowering `client_resources`.
	 > All the actors in your pool crashed. This could be because: 
		 - You clients hit an out-of-memory (OOM) error and actors couldn't recover from it. Try launching your simulation with more generous `client_resources` setting (i.e. it seems {'num_cpus': 1, 'num_gpus': 0.0} is not enough for your run). Use fewer concurrent actors. 
		 - You were running a multi-node simulation and all worker nodes disconnected. The head node might still be alive but cannot accommodate any actor with resources: {'num_cpus': 1, 'num_gpus': 0.0}.
Take a look at the Flower simulation examples for guidance <https://flower.ai/docs/framework/how-to-run-simulations.html>.
globalattack | INFO flwr 2024-11-08 16:49:51,206 | app.py:219 | Starting Flower simulation, config: num_rounds=10, no round_timeout
globalattack | INFO flwr 2024-11-08 16:49:53,342 | app.py:242 | Flower VCE: Ray initialized with resources: {'node:127.0.0.1': 1.0, 'memory': 5477775770.0, 'GPU': 1.0, 'object_store_memory': 2147483648.0, 'node:__internal_head__': 1.0, 'CPU': 8.0}
globalattack | INFO flwr 2024-11-08 16:49:53,342 | app.py:248 | Optimize your simulation with Flower VCE: https://flower.ai/docs/framework/how-to-run-simulations.html
globalattack | INFO flwr 2024-11-08 16:49:53,342 | app.py:271 | Flower VCE: Resources for each Virtual Client: {'num_cpus': 1, 'num_gpus': 0.2}
globalattack | INFO flwr 2024-11-08 16:49:53,351 | app.py:317 | Flower VCE: Creating VirtualClientEngineActorPool with 5 actors
globalattack | INFO flwr 2024-11-08 16:49:53,352 | server.py:92 | [INIT]
globalattack | INFO flwr 2024-11-08 16:49:53,352 | server.py:281 | Requesting initial parameters from one random client
globalattack | ERROR flwr 2024-11-08 16:50:12,717 | ray_client_proxy.py:106 | Traceback (most recent call last):
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 94, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 398, in get_client_result
    return self._fetch_future_result(cid)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 279, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
                                         ^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=7824, ip=127.0.0.1, actor_id=5c3a1f785e0e6a04ba57c81901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x107d2f790>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/message_handler/message_handler.py", line 95, in handle_legacy_message_from_msgtype
    client = client_fn(context)
             ^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 67, in adaptor_fn
    return client_fn(str(cid))  # type: ignore
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/texas100/globalattack.py", line 143, in client_fn
    return FlowerClient(model, int(cid))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/texas100/globalattack.py", line 96, in __init__
    self.dataset = Texas100Dataset(features[target_train_indices], global_labels[target_train_indices])
                                            ^^^^^^^^^^^^^^^^^^^^
NameError: name 'target_train_indices' is not defined

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=7824, ip=127.0.0.1, actor_id=5c3a1f785e0e6a04ba57c81901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x107d2f790>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: name 'target_train_indices' is not defined

globalattack | ERROR flwr 2024-11-08 16:50:12,720 | ray_client_proxy.py:107 | [36mray::ClientAppActor.run()[39m (pid=7824, ip=127.0.0.1, actor_id=5c3a1f785e0e6a04ba57c81901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x107d2f790>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/message_handler/message_handler.py", line 95, in handle_legacy_message_from_msgtype
    client = client_fn(context)
             ^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 67, in adaptor_fn
    return client_fn(str(cid))  # type: ignore
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/texas100/globalattack.py", line 143, in client_fn
    return FlowerClient(model, int(cid))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/texas100/globalattack.py", line 96, in __init__
    self.dataset = Texas100Dataset(features[target_train_indices], global_labels[target_train_indices])
                                            ^^^^^^^^^^^^^^^^^^^^
NameError: name 'target_train_indices' is not defined

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=7824, ip=127.0.0.1, actor_id=5c3a1f785e0e6a04ba57c81901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x107d2f790>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: name 'target_train_indices' is not defined
globalattack | ERROR flwr 2024-11-08 16:50:12,720 | app.py:344 | [36mray::ClientAppActor.run()[39m (pid=7824, ip=127.0.0.1, actor_id=5c3a1f785e0e6a04ba57c81901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x107d2f790>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/message_handler/message_handler.py", line 95, in handle_legacy_message_from_msgtype
    client = client_fn(context)
             ^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 67, in adaptor_fn
    return client_fn(str(cid))  # type: ignore
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/texas100/globalattack.py", line 143, in client_fn
    return FlowerClient(model, int(cid))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/texas100/globalattack.py", line 96, in __init__
    self.dataset = Texas100Dataset(features[target_train_indices], global_labels[target_train_indices])
                                            ^^^^^^^^^^^^^^^^^^^^
NameError: name 'target_train_indices' is not defined

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=7824, ip=127.0.0.1, actor_id=5c3a1f785e0e6a04ba57c81901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x107d2f790>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: name 'target_train_indices' is not defined
globalattack | ERROR flwr 2024-11-08 16:50:12,722 | app.py:345 | Traceback (most recent call last):
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/app.py", line 339, in start_simulation
    hist = run_fl(
           ^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/server/server.py", line 492, in run_fl
    hist, elapsed_time = server.fit(
                         ^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/server/server.py", line 93, in fit
    self.parameters = self._get_initial_parameters(server_round=0, timeout=timeout)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/server/server.py", line 284, in _get_initial_parameters
    get_parameters_res = random_client.get_parameters(
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 168, in get_parameters
    message_out = self._submit_job(message, timeout)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 108, in _submit_job
    raise ex
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 94, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 398, in get_client_result
    return self._fetch_future_result(cid)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 279, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
                                         ^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=7824, ip=127.0.0.1, actor_id=5c3a1f785e0e6a04ba57c81901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x107d2f790>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/message_handler/message_handler.py", line 95, in handle_legacy_message_from_msgtype
    client = client_fn(context)
             ^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 67, in adaptor_fn
    return client_fn(str(cid))  # type: ignore
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/texas100/globalattack.py", line 143, in client_fn
    return FlowerClient(model, int(cid))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/texas100/globalattack.py", line 96, in __init__
    self.dataset = Texas100Dataset(features[target_train_indices], global_labels[target_train_indices])
                                            ^^^^^^^^^^^^^^^^^^^^
NameError: name 'target_train_indices' is not defined

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=7824, ip=127.0.0.1, actor_id=5c3a1f785e0e6a04ba57c81901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x107d2f790>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: name 'target_train_indices' is not defined

globalattack | ERROR flwr 2024-11-08 16:50:12,722 | app.py:346 | Your simulation crashed :(. This could be because of several reasons. The most common are: 
	 > Sometimes, issues in the simulation code itself can cause crashes. It's always a good idea to double-check your code for any potential bugs or inconsistencies that might be contributing to the problem. For example: 
		 - You might be using a class attribute in your clients that hasn't been defined.
		 - There could be an incorrect method call to a 3rd party library (e.g., PyTorch).
		 - The return types of methods in your clients/strategies might be incorrect.
	 > Your system couldn't fit a single VirtualClient: try lowering `client_resources`.
	 > All the actors in your pool crashed. This could be because: 
		 - You clients hit an out-of-memory (OOM) error and actors couldn't recover from it. Try launching your simulation with more generous `client_resources` setting (i.e. it seems {'num_cpus': 1, 'num_gpus': 0.2} is not enough for your run). Use fewer concurrent actors. 
		 - You were running a multi-node simulation and all worker nodes disconnected. The head node might still be alive but cannot accommodate any actor with resources: {'num_cpus': 1, 'num_gpus': 0.2}.
Take a look at the Flower simulation examples for guidance <https://flower.ai/docs/framework/how-to-run-simulations.html>.
globalattack | INFO flwr 2024-11-08 16:52:01,976 | app.py:219 | Starting Flower simulation, config: num_rounds=10, no round_timeout
globalattack | INFO flwr 2024-11-08 16:52:04,162 | app.py:242 | Flower VCE: Ray initialized with resources: {'node:__internal_head__': 1.0, 'memory': 5592776704.0, 'GPU': 1.0, 'object_store_memory': 2147483648.0, 'CPU': 8.0, 'node:127.0.0.1': 1.0}
globalattack | INFO flwr 2024-11-08 16:52:04,162 | app.py:248 | Optimize your simulation with Flower VCE: https://flower.ai/docs/framework/how-to-run-simulations.html
globalattack | INFO flwr 2024-11-08 16:52:04,162 | app.py:271 | Flower VCE: Resources for each Virtual Client: {'num_cpus': 1, 'num_gpus': 0.2}
globalattack | INFO flwr 2024-11-08 16:52:04,173 | app.py:317 | Flower VCE: Creating VirtualClientEngineActorPool with 5 actors
globalattack | INFO flwr 2024-11-08 16:52:04,173 | server.py:92 | [INIT]
globalattack | INFO flwr 2024-11-08 16:52:04,173 | server.py:281 | Requesting initial parameters from one random client
globalattack | ERROR flwr 2024-11-08 16:52:09,122 | ray_client_proxy.py:106 | Traceback (most recent call last):
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 94, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 398, in get_client_result
    return self._fetch_future_result(cid)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 279, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
                                         ^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=7897, ip=127.0.0.1, actor_id=b023c0839a0f593bb7cf78ab01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x16618bd10>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/message_handler/message_handler.py", line 95, in handle_legacy_message_from_msgtype
    client = client_fn(context)
             ^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 67, in adaptor_fn
    return client_fn(str(cid))  # type: ignore
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/texas100/globalattack.py", line 141, in client_fn
    return FlowerClient(model, int(cid))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: FlowerClient.__init__() missing 1 required positional argument: 'data_loader'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=7897, ip=127.0.0.1, actor_id=b023c0839a0f593bb7cf78ab01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x16618bd10>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: FlowerClient.__init__() missing 1 required positional argument: 'data_loader'

globalattack | ERROR flwr 2024-11-08 16:52:09,122 | ray_client_proxy.py:107 | [36mray::ClientAppActor.run()[39m (pid=7897, ip=127.0.0.1, actor_id=b023c0839a0f593bb7cf78ab01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x16618bd10>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/message_handler/message_handler.py", line 95, in handle_legacy_message_from_msgtype
    client = client_fn(context)
             ^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 67, in adaptor_fn
    return client_fn(str(cid))  # type: ignore
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/texas100/globalattack.py", line 141, in client_fn
    return FlowerClient(model, int(cid))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: FlowerClient.__init__() missing 1 required positional argument: 'data_loader'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=7897, ip=127.0.0.1, actor_id=b023c0839a0f593bb7cf78ab01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x16618bd10>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: FlowerClient.__init__() missing 1 required positional argument: 'data_loader'
globalattack | ERROR flwr 2024-11-08 16:52:09,122 | app.py:344 | [36mray::ClientAppActor.run()[39m (pid=7897, ip=127.0.0.1, actor_id=b023c0839a0f593bb7cf78ab01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x16618bd10>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/message_handler/message_handler.py", line 95, in handle_legacy_message_from_msgtype
    client = client_fn(context)
             ^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 67, in adaptor_fn
    return client_fn(str(cid))  # type: ignore
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/texas100/globalattack.py", line 141, in client_fn
    return FlowerClient(model, int(cid))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: FlowerClient.__init__() missing 1 required positional argument: 'data_loader'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=7897, ip=127.0.0.1, actor_id=b023c0839a0f593bb7cf78ab01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x16618bd10>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: FlowerClient.__init__() missing 1 required positional argument: 'data_loader'
globalattack | ERROR flwr 2024-11-08 16:52:09,123 | app.py:345 | Traceback (most recent call last):
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/app.py", line 339, in start_simulation
    hist = run_fl(
           ^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/server/server.py", line 492, in run_fl
    hist, elapsed_time = server.fit(
                         ^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/server/server.py", line 93, in fit
    self.parameters = self._get_initial_parameters(server_round=0, timeout=timeout)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/server/server.py", line 284, in _get_initial_parameters
    get_parameters_res = random_client.get_parameters(
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 168, in get_parameters
    message_out = self._submit_job(message, timeout)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 108, in _submit_job
    raise ex
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 94, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 398, in get_client_result
    return self._fetch_future_result(cid)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 279, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
                                         ^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=7897, ip=127.0.0.1, actor_id=b023c0839a0f593bb7cf78ab01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x16618bd10>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/message_handler/message_handler.py", line 95, in handle_legacy_message_from_msgtype
    client = client_fn(context)
             ^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 67, in adaptor_fn
    return client_fn(str(cid))  # type: ignore
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/texas100/globalattack.py", line 141, in client_fn
    return FlowerClient(model, int(cid))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: FlowerClient.__init__() missing 1 required positional argument: 'data_loader'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=7897, ip=127.0.0.1, actor_id=b023c0839a0f593bb7cf78ab01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x16618bd10>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: FlowerClient.__init__() missing 1 required positional argument: 'data_loader'

globalattack | ERROR flwr 2024-11-08 16:52:09,123 | app.py:346 | Your simulation crashed :(. This could be because of several reasons. The most common are: 
	 > Sometimes, issues in the simulation code itself can cause crashes. It's always a good idea to double-check your code for any potential bugs or inconsistencies that might be contributing to the problem. For example: 
		 - You might be using a class attribute in your clients that hasn't been defined.
		 - There could be an incorrect method call to a 3rd party library (e.g., PyTorch).
		 - The return types of methods in your clients/strategies might be incorrect.
	 > Your system couldn't fit a single VirtualClient: try lowering `client_resources`.
	 > All the actors in your pool crashed. This could be because: 
		 - You clients hit an out-of-memory (OOM) error and actors couldn't recover from it. Try launching your simulation with more generous `client_resources` setting (i.e. it seems {'num_cpus': 1, 'num_gpus': 0.2} is not enough for your run). Use fewer concurrent actors. 
		 - You were running a multi-node simulation and all worker nodes disconnected. The head node might still be alive but cannot accommodate any actor with resources: {'num_cpus': 1, 'num_gpus': 0.2}.
Take a look at the Flower simulation examples for guidance <https://flower.ai/docs/framework/how-to-run-simulations.html>.
globalattack | INFO flwr 2024-11-08 16:53:11,722 | app.py:219 | Starting Flower simulation, config: num_rounds=10, no round_timeout
globalattack | INFO flwr 2024-11-08 16:53:13,952 | app.py:242 | Flower VCE: Ray initialized with resources: {'node:127.0.0.1': 1.0, 'memory': 5643619533.0, 'GPU': 1.0, 'object_store_memory': 2147483648.0, 'node:__internal_head__': 1.0, 'CPU': 8.0}
globalattack | INFO flwr 2024-11-08 16:53:13,953 | app.py:248 | Optimize your simulation with Flower VCE: https://flower.ai/docs/framework/how-to-run-simulations.html
globalattack | INFO flwr 2024-11-08 16:53:13,953 | app.py:271 | Flower VCE: Resources for each Virtual Client: {'num_cpus': 1, 'num_gpus': 0.2}
globalattack | INFO flwr 2024-11-08 16:53:13,960 | app.py:317 | Flower VCE: Creating VirtualClientEngineActorPool with 5 actors
globalattack | INFO flwr 2024-11-08 16:53:13,960 | server.py:92 | [INIT]
globalattack | INFO flwr 2024-11-08 16:53:13,960 | server.py:281 | Requesting initial parameters from one random client
globalattack | ERROR flwr 2024-11-08 16:53:18,365 | ray_client_proxy.py:106 | Traceback (most recent call last):
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 94, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 398, in get_client_result
    return self._fetch_future_result(cid)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 279, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
                                         ^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=7959, ip=127.0.0.1, actor_id=2acdd9f5ff14256d88d9129301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x105851950>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/message_handler/message_handler.py", line 95, in handle_legacy_message_from_msgtype
    client = client_fn(context)
             ^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 67, in adaptor_fn
    return client_fn(str(cid))  # type: ignore
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/texas100/globalattack.py", line 142, in client_fn
    return FlowerClient(model, int(cid))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: FlowerClient.__init__() missing 1 required positional argument: 'data_loader'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=7959, ip=127.0.0.1, actor_id=2acdd9f5ff14256d88d9129301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x105851950>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: FlowerClient.__init__() missing 1 required positional argument: 'data_loader'

globalattack | ERROR flwr 2024-11-08 16:53:18,365 | ray_client_proxy.py:107 | [36mray::ClientAppActor.run()[39m (pid=7959, ip=127.0.0.1, actor_id=2acdd9f5ff14256d88d9129301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x105851950>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/message_handler/message_handler.py", line 95, in handle_legacy_message_from_msgtype
    client = client_fn(context)
             ^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 67, in adaptor_fn
    return client_fn(str(cid))  # type: ignore
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/texas100/globalattack.py", line 142, in client_fn
    return FlowerClient(model, int(cid))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: FlowerClient.__init__() missing 1 required positional argument: 'data_loader'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=7959, ip=127.0.0.1, actor_id=2acdd9f5ff14256d88d9129301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x105851950>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: FlowerClient.__init__() missing 1 required positional argument: 'data_loader'
globalattack | ERROR flwr 2024-11-08 16:53:18,365 | app.py:344 | [36mray::ClientAppActor.run()[39m (pid=7959, ip=127.0.0.1, actor_id=2acdd9f5ff14256d88d9129301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x105851950>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/message_handler/message_handler.py", line 95, in handle_legacy_message_from_msgtype
    client = client_fn(context)
             ^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 67, in adaptor_fn
    return client_fn(str(cid))  # type: ignore
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/texas100/globalattack.py", line 142, in client_fn
    return FlowerClient(model, int(cid))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: FlowerClient.__init__() missing 1 required positional argument: 'data_loader'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=7959, ip=127.0.0.1, actor_id=2acdd9f5ff14256d88d9129301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x105851950>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: FlowerClient.__init__() missing 1 required positional argument: 'data_loader'
globalattack | ERROR flwr 2024-11-08 16:53:18,366 | app.py:345 | Traceback (most recent call last):
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/app.py", line 339, in start_simulation
    hist = run_fl(
           ^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/server/server.py", line 492, in run_fl
    hist, elapsed_time = server.fit(
                         ^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/server/server.py", line 93, in fit
    self.parameters = self._get_initial_parameters(server_round=0, timeout=timeout)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/server/server.py", line 284, in _get_initial_parameters
    get_parameters_res = random_client.get_parameters(
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 168, in get_parameters
    message_out = self._submit_job(message, timeout)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 108, in _submit_job
    raise ex
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 94, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 398, in get_client_result
    return self._fetch_future_result(cid)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 279, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
                                         ^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=7959, ip=127.0.0.1, actor_id=2acdd9f5ff14256d88d9129301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x105851950>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/message_handler/message_handler.py", line 95, in handle_legacy_message_from_msgtype
    client = client_fn(context)
             ^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 67, in adaptor_fn
    return client_fn(str(cid))  # type: ignore
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/texas100/globalattack.py", line 142, in client_fn
    return FlowerClient(model, int(cid))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: FlowerClient.__init__() missing 1 required positional argument: 'data_loader'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=7959, ip=127.0.0.1, actor_id=2acdd9f5ff14256d88d9129301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x105851950>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: FlowerClient.__init__() missing 1 required positional argument: 'data_loader'

globalattack | ERROR flwr 2024-11-08 16:53:18,366 | app.py:346 | Your simulation crashed :(. This could be because of several reasons. The most common are: 
	 > Sometimes, issues in the simulation code itself can cause crashes. It's always a good idea to double-check your code for any potential bugs or inconsistencies that might be contributing to the problem. For example: 
		 - You might be using a class attribute in your clients that hasn't been defined.
		 - There could be an incorrect method call to a 3rd party library (e.g., PyTorch).
		 - The return types of methods in your clients/strategies might be incorrect.
	 > Your system couldn't fit a single VirtualClient: try lowering `client_resources`.
	 > All the actors in your pool crashed. This could be because: 
		 - You clients hit an out-of-memory (OOM) error and actors couldn't recover from it. Try launching your simulation with more generous `client_resources` setting (i.e. it seems {'num_cpus': 1, 'num_gpus': 0.2} is not enough for your run). Use fewer concurrent actors. 
		 - You were running a multi-node simulation and all worker nodes disconnected. The head node might still be alive but cannot accommodate any actor with resources: {'num_cpus': 1, 'num_gpus': 0.2}.
Take a look at the Flower simulation examples for guidance <https://flower.ai/docs/framework/how-to-run-simulations.html>.
globalattack | INFO flwr 2024-11-08 16:53:57,068 | app.py:219 | Starting Flower simulation, config: num_rounds=10, no round_timeout
globalattack | INFO flwr 2024-11-08 16:53:59,165 | app.py:242 | Flower VCE: Ray initialized with resources: {'node:127.0.0.1': 1.0, 'GPU': 1.0, 'memory': 5296109978.0, 'CPU': 8.0, 'object_store_memory': 2147483648.0, 'node:__internal_head__': 1.0}
globalattack | INFO flwr 2024-11-08 16:53:59,165 | app.py:248 | Optimize your simulation with Flower VCE: https://flower.ai/docs/framework/how-to-run-simulations.html
globalattack | INFO flwr 2024-11-08 16:53:59,165 | app.py:271 | Flower VCE: Resources for each Virtual Client: {'num_cpus': 1, 'num_gpus': 0.2}
globalattack | INFO flwr 2024-11-08 16:53:59,173 | app.py:317 | Flower VCE: Creating VirtualClientEngineActorPool with 5 actors
globalattack | INFO flwr 2024-11-08 16:53:59,173 | server.py:92 | [INIT]
globalattack | INFO flwr 2024-11-08 16:53:59,173 | server.py:281 | Requesting initial parameters from one random client
globalattack | INFO flwr 2024-11-08 16:54:03,882 | server.py:288 | Received initial parameters from one random client
globalattack | INFO flwr 2024-11-08 16:54:03,883 | server.py:94 | Starting evaluation of initial global parameters
globalattack | INFO flwr 2024-11-08 16:54:03,883 | server.py:106 | Evaluation returned no results (`None`)
globalattack | INFO flwr 2024-11-08 16:54:03,883 | server.py:112 | 
globalattack | INFO flwr 2024-11-08 16:54:03,883 | server.py:113 | [ROUND 1]
globalattack | INFO flwr 2024-11-08 16:54:03,884 | server.py:226 | configure_fit: strategy sampled 5 clients (out of 5)
globalattack | INFO flwr 2024-11-08 17:14:52,561 | app.py:219 | Starting Flower simulation, config: num_rounds=10, no round_timeout
globalattack | INFO flwr 2024-11-08 17:14:54,813 | app.py:242 | Flower VCE: Ray initialized with resources: {'node:__internal_head__': 1.0, 'GPU': 1.0, 'memory': 5256532788.0, 'node:127.0.0.1': 1.0, 'object_store_memory': 2147483648.0, 'CPU': 8.0}
globalattack | INFO flwr 2024-11-08 17:14:54,813 | app.py:248 | Optimize your simulation with Flower VCE: https://flower.ai/docs/framework/how-to-run-simulations.html
globalattack | INFO flwr 2024-11-08 17:14:54,813 | app.py:271 | Flower VCE: Resources for each Virtual Client: {'num_cpus': 1, 'num_gpus': 0.2}
globalattack | INFO flwr 2024-11-08 17:14:54,824 | app.py:317 | Flower VCE: Creating VirtualClientEngineActorPool with 5 actors
globalattack | INFO flwr 2024-11-08 17:14:54,824 | server.py:92 | [INIT]
globalattack | INFO flwr 2024-11-08 17:14:54,824 | server.py:281 | Requesting initial parameters from one random client
globalattack | INFO flwr 2024-11-08 17:14:59,819 | server.py:288 | Received initial parameters from one random client
globalattack | INFO flwr 2024-11-08 17:14:59,820 | server.py:94 | Starting evaluation of initial global parameters
globalattack | INFO flwr 2024-11-08 17:14:59,820 | server.py:106 | Evaluation returned no results (`None`)
globalattack | INFO flwr 2024-11-08 17:14:59,820 | server.py:112 | 
globalattack | INFO flwr 2024-11-08 17:14:59,820 | server.py:113 | [ROUND 1]
globalattack | INFO flwr 2024-11-08 17:14:59,822 | server.py:226 | configure_fit: strategy sampled 5 clients (out of 5)
globalattack | ERROR flwr 2024-11-08 17:15:11,329 | ray_client_proxy.py:106 | Traceback (most recent call last):
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 94, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 398, in get_client_result
    return self._fetch_future_result(cid)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 279, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
                                         ^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=9649, ip=127.0.0.1, actor_id=5a7da0714640cae3b5742cc001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x10588ff90>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/message_handler/message_handler.py", line 129, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
              ^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client.py", line 255, in maybe_call_fit
    return client.fit(fit_ins)
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 259, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/texas100/globalattack.py", line 155, in fit
    loss = self.criterion(outputs, labels)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/loss.py", line 1188, in forward
    return F.cross_entropy(input, target, weight=self.weight,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/functional.py", line 3104, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected floating point type for target with class probabilities, got Long

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=9649, ip=127.0.0.1, actor_id=5a7da0714640cae3b5742cc001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x10588ff90>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Expected floating point type for target with class probabilities, got Long

globalattack | ERROR flwr 2024-11-08 17:15:11,329 | ray_client_proxy.py:106 | Traceback (most recent call last):
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 94, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 398, in get_client_result
    return self._fetch_future_result(cid)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 279, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
                                         ^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=9652, ip=127.0.0.1, actor_id=f39efcee6a24bf3edfb318bf01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x109f6ff10>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/message_handler/message_handler.py", line 129, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
              ^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client.py", line 255, in maybe_call_fit
    return client.fit(fit_ins)
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 259, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/texas100/globalattack.py", line 155, in fit
    loss = self.criterion(outputs, labels)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/loss.py", line 1188, in forward
    return F.cross_entropy(input, target, weight=self.weight,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/functional.py", line 3104, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected floating point type for target with class probabilities, got Long

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=9652, ip=127.0.0.1, actor_id=f39efcee6a24bf3edfb318bf01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x109f6ff10>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Expected floating point type for target with class probabilities, got Long

globalattack | ERROR flwr 2024-11-08 17:15:11,330 | ray_client_proxy.py:106 | Traceback (most recent call last):
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 94, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 398, in get_client_result
    return self._fetch_future_result(cid)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 279, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
                                         ^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=9651, ip=127.0.0.1, actor_id=931c48e158afa5f772c5eedd01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x105333c90>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/message_handler/message_handler.py", line 129, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
              ^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client.py", line 255, in maybe_call_fit
    return client.fit(fit_ins)
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 259, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/texas100/globalattack.py", line 155, in fit
    loss = self.criterion(outputs, labels)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/loss.py", line 1188, in forward
    return F.cross_entropy(input, target, weight=self.weight,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/functional.py", line 3104, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected floating point type for target with class probabilities, got Long

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=9651, ip=127.0.0.1, actor_id=931c48e158afa5f772c5eedd01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x105333c90>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Expected floating point type for target with class probabilities, got Long

globalattack | ERROR flwr 2024-11-08 17:15:11,330 | ray_client_proxy.py:107 | [36mray::ClientAppActor.run()[39m (pid=9649, ip=127.0.0.1, actor_id=5a7da0714640cae3b5742cc001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x10588ff90>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/message_handler/message_handler.py", line 129, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
              ^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client.py", line 255, in maybe_call_fit
    return client.fit(fit_ins)
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 259, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/texas100/globalattack.py", line 155, in fit
    loss = self.criterion(outputs, labels)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/loss.py", line 1188, in forward
    return F.cross_entropy(input, target, weight=self.weight,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/functional.py", line 3104, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected floating point type for target with class probabilities, got Long

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=9649, ip=127.0.0.1, actor_id=5a7da0714640cae3b5742cc001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x10588ff90>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Expected floating point type for target with class probabilities, got Long
globalattack | ERROR flwr 2024-11-08 17:15:11,330 | ray_client_proxy.py:106 | Traceback (most recent call last):
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 94, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 398, in get_client_result
    return self._fetch_future_result(cid)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 279, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
                                         ^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=9653, ip=127.0.0.1, actor_id=a66ba487b3b82ec86d36c19101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15f097890>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/message_handler/message_handler.py", line 129, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
              ^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client.py", line 255, in maybe_call_fit
    return client.fit(fit_ins)
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 259, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/texas100/globalattack.py", line 155, in fit
    loss = self.criterion(outputs, labels)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/loss.py", line 1188, in forward
    return F.cross_entropy(input, target, weight=self.weight,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/functional.py", line 3104, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected floating point type for target with class probabilities, got Long

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=9653, ip=127.0.0.1, actor_id=a66ba487b3b82ec86d36c19101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15f097890>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Expected floating point type for target with class probabilities, got Long

globalattack | ERROR flwr 2024-11-08 17:15:11,330 | ray_client_proxy.py:107 | [36mray::ClientAppActor.run()[39m (pid=9652, ip=127.0.0.1, actor_id=f39efcee6a24bf3edfb318bf01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x109f6ff10>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/message_handler/message_handler.py", line 129, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
              ^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client.py", line 255, in maybe_call_fit
    return client.fit(fit_ins)
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 259, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/texas100/globalattack.py", line 155, in fit
    loss = self.criterion(outputs, labels)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/loss.py", line 1188, in forward
    return F.cross_entropy(input, target, weight=self.weight,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/functional.py", line 3104, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected floating point type for target with class probabilities, got Long

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=9652, ip=127.0.0.1, actor_id=f39efcee6a24bf3edfb318bf01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x109f6ff10>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Expected floating point type for target with class probabilities, got Long
globalattack | ERROR flwr 2024-11-08 17:15:11,330 | ray_client_proxy.py:107 | [36mray::ClientAppActor.run()[39m (pid=9651, ip=127.0.0.1, actor_id=931c48e158afa5f772c5eedd01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x105333c90>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/message_handler/message_handler.py", line 129, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
              ^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client.py", line 255, in maybe_call_fit
    return client.fit(fit_ins)
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 259, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/texas100/globalattack.py", line 155, in fit
    loss = self.criterion(outputs, labels)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/loss.py", line 1188, in forward
    return F.cross_entropy(input, target, weight=self.weight,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/functional.py", line 3104, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected floating point type for target with class probabilities, got Long

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=9651, ip=127.0.0.1, actor_id=931c48e158afa5f772c5eedd01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x105333c90>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Expected floating point type for target with class probabilities, got Long
globalattack | ERROR flwr 2024-11-08 17:15:11,330 | ray_client_proxy.py:107 | [36mray::ClientAppActor.run()[39m (pid=9653, ip=127.0.0.1, actor_id=a66ba487b3b82ec86d36c19101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15f097890>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/message_handler/message_handler.py", line 129, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
              ^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client.py", line 255, in maybe_call_fit
    return client.fit(fit_ins)
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 259, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/texas100/globalattack.py", line 155, in fit
    loss = self.criterion(outputs, labels)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/loss.py", line 1188, in forward
    return F.cross_entropy(input, target, weight=self.weight,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/functional.py", line 3104, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected floating point type for target with class probabilities, got Long

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=9653, ip=127.0.0.1, actor_id=a66ba487b3b82ec86d36c19101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15f097890>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Expected floating point type for target with class probabilities, got Long
globalattack | ERROR flwr 2024-11-08 17:15:12,576 | ray_client_proxy.py:106 | Traceback (most recent call last):
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 94, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 398, in get_client_result
    return self._fetch_future_result(cid)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 279, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
                                         ^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=9650, ip=127.0.0.1, actor_id=cbf68a497b722b4290c019ba01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x103d2f6d0>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/message_handler/message_handler.py", line 129, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
              ^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client.py", line 255, in maybe_call_fit
    return client.fit(fit_ins)
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 259, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/texas100/globalattack.py", line 155, in fit
    loss = self.criterion(outputs, labels)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/loss.py", line 1188, in forward
    return F.cross_entropy(input, target, weight=self.weight,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/functional.py", line 3104, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected floating point type for target with class probabilities, got Long

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=9650, ip=127.0.0.1, actor_id=cbf68a497b722b4290c019ba01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x103d2f6d0>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Expected floating point type for target with class probabilities, got Long

globalattack | ERROR flwr 2024-11-08 17:15:12,577 | ray_client_proxy.py:107 | [36mray::ClientAppActor.run()[39m (pid=9650, ip=127.0.0.1, actor_id=cbf68a497b722b4290c019ba01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x103d2f6d0>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/message_handler/message_handler.py", line 129, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
              ^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client.py", line 255, in maybe_call_fit
    return client.fit(fit_ins)
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 259, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/texas100/globalattack.py", line 155, in fit
    loss = self.criterion(outputs, labels)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/loss.py", line 1188, in forward
    return F.cross_entropy(input, target, weight=self.weight,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/functional.py", line 3104, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected floating point type for target with class probabilities, got Long

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=9650, ip=127.0.0.1, actor_id=cbf68a497b722b4290c019ba01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x103d2f6d0>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Expected floating point type for target with class probabilities, got Long
globalattack | INFO flwr 2024-11-08 17:15:12,577 | server.py:240 | aggregate_fit: received 0 results and 5 failures
globalattack | INFO flwr 2024-11-08 17:15:12,577 | server.py:178 | configure_evaluate: strategy sampled 5 clients (out of 5)
globalattack | ERROR flwr 2024-11-08 17:15:22,452 | ray_client_proxy.py:106 | Traceback (most recent call last):
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 94, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 398, in get_client_result
    return self._fetch_future_result(cid)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 279, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
                                         ^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=9650, ip=127.0.0.1, actor_id=cbf68a497b722b4290c019ba01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x103d2f6d0>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/message_handler/message_handler.py", line 136, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
                   ^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client.py", line 275, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 283, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/texas100/globalattack.py", line 170, in evaluate
    correct += (predicted == labels).sum().item()
                ^^^^^^^^^^^^^^^^^^^
RuntimeError: The size of tensor a (64) must match the size of tensor b (100) at non-singleton dimension 1

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=9650, ip=127.0.0.1, actor_id=cbf68a497b722b4290c019ba01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x103d2f6d0>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: The size of tensor a (64) must match the size of tensor b (100) at non-singleton dimension 1

globalattack | ERROR flwr 2024-11-08 17:15:22,453 | ray_client_proxy.py:107 | [36mray::ClientAppActor.run()[39m (pid=9650, ip=127.0.0.1, actor_id=cbf68a497b722b4290c019ba01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x103d2f6d0>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/message_handler/message_handler.py", line 136, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
                   ^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client.py", line 275, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 283, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/texas100/globalattack.py", line 170, in evaluate
    correct += (predicted == labels).sum().item()
                ^^^^^^^^^^^^^^^^^^^
RuntimeError: The size of tensor a (64) must match the size of tensor b (100) at non-singleton dimension 1

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=9650, ip=127.0.0.1, actor_id=cbf68a497b722b4290c019ba01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x103d2f6d0>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: The size of tensor a (64) must match the size of tensor b (100) at non-singleton dimension 1
globalattack | ERROR flwr 2024-11-08 17:15:22,453 | ray_client_proxy.py:106 | Traceback (most recent call last):
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 94, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 398, in get_client_result
    return self._fetch_future_result(cid)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 279, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
                                         ^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=9649, ip=127.0.0.1, actor_id=5a7da0714640cae3b5742cc001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x10588ff90>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/message_handler/message_handler.py", line 136, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
                   ^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client.py", line 275, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 283, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/texas100/globalattack.py", line 170, in evaluate
    correct += (predicted == labels).sum().item()
                ^^^^^^^^^^^^^^^^^^^
RuntimeError: The size of tensor a (64) must match the size of tensor b (100) at non-singleton dimension 1

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=9649, ip=127.0.0.1, actor_id=5a7da0714640cae3b5742cc001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x10588ff90>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: The size of tensor a (64) must match the size of tensor b (100) at non-singleton dimension 1

globalattack | ERROR flwr 2024-11-08 17:15:22,454 | ray_client_proxy.py:106 | Traceback (most recent call last):
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 94, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 398, in get_client_result
    return self._fetch_future_result(cid)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 279, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
                                         ^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=9651, ip=127.0.0.1, actor_id=931c48e158afa5f772c5eedd01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x105333c90>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/message_handler/message_handler.py", line 136, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
                   ^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client.py", line 275, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 283, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/texas100/globalattack.py", line 170, in evaluate
    correct += (predicted == labels).sum().item()
                ^^^^^^^^^^^^^^^^^^^
RuntimeError: The size of tensor a (64) must match the size of tensor b (100) at non-singleton dimension 1

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=9651, ip=127.0.0.1, actor_id=931c48e158afa5f772c5eedd01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x105333c90>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: The size of tensor a (64) must match the size of tensor b (100) at non-singleton dimension 1

globalattack | ERROR flwr 2024-11-08 17:15:22,454 | ray_client_proxy.py:107 | [36mray::ClientAppActor.run()[39m (pid=9649, ip=127.0.0.1, actor_id=5a7da0714640cae3b5742cc001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x10588ff90>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/message_handler/message_handler.py", line 136, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
                   ^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client.py", line 275, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 283, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/texas100/globalattack.py", line 170, in evaluate
    correct += (predicted == labels).sum().item()
                ^^^^^^^^^^^^^^^^^^^
RuntimeError: The size of tensor a (64) must match the size of tensor b (100) at non-singleton dimension 1

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=9649, ip=127.0.0.1, actor_id=5a7da0714640cae3b5742cc001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x10588ff90>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: The size of tensor a (64) must match the size of tensor b (100) at non-singleton dimension 1
globalattack | ERROR flwr 2024-11-08 17:15:22,454 | ray_client_proxy.py:106 | Traceback (most recent call last):
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 94, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 398, in get_client_result
    return self._fetch_future_result(cid)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 279, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
                                         ^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=9652, ip=127.0.0.1, actor_id=f39efcee6a24bf3edfb318bf01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x109f6ff10>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/message_handler/message_handler.py", line 136, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
                   ^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client.py", line 275, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 283, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/texas100/globalattack.py", line 170, in evaluate
    correct += (predicted == labels).sum().item()
                ^^^^^^^^^^^^^^^^^^^
RuntimeError: The size of tensor a (64) must match the size of tensor b (100) at non-singleton dimension 1

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=9652, ip=127.0.0.1, actor_id=f39efcee6a24bf3edfb318bf01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x109f6ff10>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: The size of tensor a (64) must match the size of tensor b (100) at non-singleton dimension 1

globalattack | ERROR flwr 2024-11-08 17:15:22,454 | ray_client_proxy.py:107 | [36mray::ClientAppActor.run()[39m (pid=9651, ip=127.0.0.1, actor_id=931c48e158afa5f772c5eedd01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x105333c90>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/message_handler/message_handler.py", line 136, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
                   ^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client.py", line 275, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 283, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/texas100/globalattack.py", line 170, in evaluate
    correct += (predicted == labels).sum().item()
                ^^^^^^^^^^^^^^^^^^^
RuntimeError: The size of tensor a (64) must match the size of tensor b (100) at non-singleton dimension 1

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=9651, ip=127.0.0.1, actor_id=931c48e158afa5f772c5eedd01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x105333c90>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: The size of tensor a (64) must match the size of tensor b (100) at non-singleton dimension 1
globalattack | ERROR flwr 2024-11-08 17:15:22,454 | ray_client_proxy.py:107 | [36mray::ClientAppActor.run()[39m (pid=9652, ip=127.0.0.1, actor_id=f39efcee6a24bf3edfb318bf01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x109f6ff10>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/message_handler/message_handler.py", line 136, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
                   ^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client.py", line 275, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 283, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/texas100/globalattack.py", line 170, in evaluate
    correct += (predicted == labels).sum().item()
                ^^^^^^^^^^^^^^^^^^^
RuntimeError: The size of tensor a (64) must match the size of tensor b (100) at non-singleton dimension 1

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=9652, ip=127.0.0.1, actor_id=f39efcee6a24bf3edfb318bf01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x109f6ff10>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: The size of tensor a (64) must match the size of tensor b (100) at non-singleton dimension 1
globalattack | ERROR flwr 2024-11-08 17:15:22,964 | ray_client_proxy.py:106 | Traceback (most recent call last):
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 94, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 398, in get_client_result
    return self._fetch_future_result(cid)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 279, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
                                         ^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=9653, ip=127.0.0.1, actor_id=a66ba487b3b82ec86d36c19101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15f097890>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/message_handler/message_handler.py", line 136, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
                   ^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client.py", line 275, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 283, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/texas100/globalattack.py", line 170, in evaluate
    correct += (predicted == labels).sum().item()
                ^^^^^^^^^^^^^^^^^^^
RuntimeError: The size of tensor a (64) must match the size of tensor b (100) at non-singleton dimension 1

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=9653, ip=127.0.0.1, actor_id=a66ba487b3b82ec86d36c19101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15f097890>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: The size of tensor a (64) must match the size of tensor b (100) at non-singleton dimension 1

globalattack | ERROR flwr 2024-11-08 17:15:22,965 | ray_client_proxy.py:107 | [36mray::ClientAppActor.run()[39m (pid=9653, ip=127.0.0.1, actor_id=a66ba487b3b82ec86d36c19101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15f097890>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/message_handler/message_handler.py", line 136, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
                   ^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client.py", line 275, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 283, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/texas100/globalattack.py", line 170, in evaluate
    correct += (predicted == labels).sum().item()
                ^^^^^^^^^^^^^^^^^^^
RuntimeError: The size of tensor a (64) must match the size of tensor b (100) at non-singleton dimension 1

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=9653, ip=127.0.0.1, actor_id=a66ba487b3b82ec86d36c19101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15f097890>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: The size of tensor a (64) must match the size of tensor b (100) at non-singleton dimension 1
globalattack | INFO flwr 2024-11-08 17:15:22,966 | server.py:192 | aggregate_evaluate: received 0 results and 5 failures
globalattack | INFO flwr 2024-11-08 17:15:22,966 | server.py:112 | 
globalattack | INFO flwr 2024-11-08 17:15:22,966 | server.py:113 | [ROUND 2]
globalattack | INFO flwr 2024-11-08 17:15:22,966 | server.py:226 | configure_fit: strategy sampled 5 clients (out of 5)
globalattack | ERROR flwr 2024-11-08 17:15:37,562 | ray_client_proxy.py:106 | Traceback (most recent call last):
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 94, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 398, in get_client_result
    return self._fetch_future_result(cid)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 279, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
                                         ^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=9653, ip=127.0.0.1, actor_id=a66ba487b3b82ec86d36c19101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15f097890>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/message_handler/message_handler.py", line 129, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
              ^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client.py", line 255, in maybe_call_fit
    return client.fit(fit_ins)
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 259, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/texas100/globalattack.py", line 155, in fit
    loss = self.criterion(outputs, labels)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/loss.py", line 1188, in forward
    return F.cross_entropy(input, target, weight=self.weight,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/functional.py", line 3104, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected floating point type for target with class probabilities, got Long

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=9653, ip=127.0.0.1, actor_id=a66ba487b3b82ec86d36c19101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15f097890>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Expected floating point type for target with class probabilities, got Long

globalattack | ERROR flwr 2024-11-08 17:15:37,563 | ray_client_proxy.py:106 | Traceback (most recent call last):
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 94, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 398, in get_client_result
    return self._fetch_future_result(cid)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 279, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
                                         ^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=9652, ip=127.0.0.1, actor_id=f39efcee6a24bf3edfb318bf01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x109f6ff10>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/message_handler/message_handler.py", line 129, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
              ^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client.py", line 255, in maybe_call_fit
    return client.fit(fit_ins)
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 259, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/texas100/globalattack.py", line 155, in fit
    loss = self.criterion(outputs, labels)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/loss.py", line 1188, in forward
    return F.cross_entropy(input, target, weight=self.weight,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/functional.py", line 3104, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected floating point type for target with class probabilities, got Long

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=9652, ip=127.0.0.1, actor_id=f39efcee6a24bf3edfb318bf01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x109f6ff10>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Expected floating point type for target with class probabilities, got Long

globalattack | ERROR flwr 2024-11-08 17:15:37,563 | ray_client_proxy.py:107 | [36mray::ClientAppActor.run()[39m (pid=9653, ip=127.0.0.1, actor_id=a66ba487b3b82ec86d36c19101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15f097890>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/message_handler/message_handler.py", line 129, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
              ^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client.py", line 255, in maybe_call_fit
    return client.fit(fit_ins)
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 259, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/texas100/globalattack.py", line 155, in fit
    loss = self.criterion(outputs, labels)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/loss.py", line 1188, in forward
    return F.cross_entropy(input, target, weight=self.weight,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/functional.py", line 3104, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected floating point type for target with class probabilities, got Long

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=9653, ip=127.0.0.1, actor_id=a66ba487b3b82ec86d36c19101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x15f097890>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Expected floating point type for target with class probabilities, got Long
globalattack | ERROR flwr 2024-11-08 17:15:37,564 | ray_client_proxy.py:106 | Traceback (most recent call last):
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 94, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 398, in get_client_result
    return self._fetch_future_result(cid)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 279, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
                                         ^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=9649, ip=127.0.0.1, actor_id=5a7da0714640cae3b5742cc001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x10588ff90>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/message_handler/message_handler.py", line 129, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
              ^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client.py", line 255, in maybe_call_fit
    return client.fit(fit_ins)
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 259, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/texas100/globalattack.py", line 155, in fit
    loss = self.criterion(outputs, labels)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/loss.py", line 1188, in forward
    return F.cross_entropy(input, target, weight=self.weight,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/functional.py", line 3104, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected floating point type for target with class probabilities, got Long

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=9649, ip=127.0.0.1, actor_id=5a7da0714640cae3b5742cc001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x10588ff90>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Expected floating point type for target with class probabilities, got Long

globalattack | ERROR flwr 2024-11-08 17:15:37,564 | ray_client_proxy.py:107 | [36mray::ClientAppActor.run()[39m (pid=9652, ip=127.0.0.1, actor_id=f39efcee6a24bf3edfb318bf01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x109f6ff10>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/message_handler/message_handler.py", line 129, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
              ^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client.py", line 255, in maybe_call_fit
    return client.fit(fit_ins)
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 259, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/texas100/globalattack.py", line 155, in fit
    loss = self.criterion(outputs, labels)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/loss.py", line 1188, in forward
    return F.cross_entropy(input, target, weight=self.weight,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/functional.py", line 3104, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected floating point type for target with class probabilities, got Long

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=9652, ip=127.0.0.1, actor_id=f39efcee6a24bf3edfb318bf01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x109f6ff10>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Expected floating point type for target with class probabilities, got Long
globalattack | ERROR flwr 2024-11-08 17:15:37,564 | ray_client_proxy.py:106 | Traceback (most recent call last):
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 94, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 398, in get_client_result
    return self._fetch_future_result(cid)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 279, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
                                         ^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=9651, ip=127.0.0.1, actor_id=931c48e158afa5f772c5eedd01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x105333c90>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/message_handler/message_handler.py", line 129, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
              ^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client.py", line 255, in maybe_call_fit
    return client.fit(fit_ins)
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 259, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/texas100/globalattack.py", line 155, in fit
    loss = self.criterion(outputs, labels)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/loss.py", line 1188, in forward
    return F.cross_entropy(input, target, weight=self.weight,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/functional.py", line 3104, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected floating point type for target with class probabilities, got Long

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=9651, ip=127.0.0.1, actor_id=931c48e158afa5f772c5eedd01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x105333c90>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Expected floating point type for target with class probabilities, got Long

globalattack | ERROR flwr 2024-11-08 17:15:37,564 | ray_client_proxy.py:107 | [36mray::ClientAppActor.run()[39m (pid=9649, ip=127.0.0.1, actor_id=5a7da0714640cae3b5742cc001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x10588ff90>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/message_handler/message_handler.py", line 129, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
              ^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client.py", line 255, in maybe_call_fit
    return client.fit(fit_ins)
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 259, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/texas100/globalattack.py", line 155, in fit
    loss = self.criterion(outputs, labels)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/loss.py", line 1188, in forward
    return F.cross_entropy(input, target, weight=self.weight,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/functional.py", line 3104, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected floating point type for target with class probabilities, got Long

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=9649, ip=127.0.0.1, actor_id=5a7da0714640cae3b5742cc001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x10588ff90>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Expected floating point type for target with class probabilities, got Long
globalattack | ERROR flwr 2024-11-08 17:15:37,564 | ray_client_proxy.py:107 | [36mray::ClientAppActor.run()[39m (pid=9651, ip=127.0.0.1, actor_id=931c48e158afa5f772c5eedd01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x105333c90>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/message_handler/message_handler.py", line 129, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
              ^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client.py", line 255, in maybe_call_fit
    return client.fit(fit_ins)
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 259, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/texas100/globalattack.py", line 155, in fit
    loss = self.criterion(outputs, labels)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/loss.py", line 1188, in forward
    return F.cross_entropy(input, target, weight=self.weight,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/functional.py", line 3104, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected floating point type for target with class probabilities, got Long

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=9651, ip=127.0.0.1, actor_id=931c48e158afa5f772c5eedd01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x105333c90>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Expected floating point type for target with class probabilities, got Long
globalattack | ERROR flwr 2024-11-08 17:15:37,843 | ray_client_proxy.py:106 | Traceback (most recent call last):
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 94, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 398, in get_client_result
    return self._fetch_future_result(cid)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 279, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
                                         ^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=9650, ip=127.0.0.1, actor_id=cbf68a497b722b4290c019ba01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x103d2f6d0>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/message_handler/message_handler.py", line 129, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
              ^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client.py", line 255, in maybe_call_fit
    return client.fit(fit_ins)
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 259, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/texas100/globalattack.py", line 155, in fit
    loss = self.criterion(outputs, labels)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/loss.py", line 1188, in forward
    return F.cross_entropy(input, target, weight=self.weight,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/functional.py", line 3104, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected floating point type for target with class probabilities, got Long

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=9650, ip=127.0.0.1, actor_id=cbf68a497b722b4290c019ba01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x103d2f6d0>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Expected floating point type for target with class probabilities, got Long

globalattack | ERROR flwr 2024-11-08 17:15:37,843 | ray_client_proxy.py:107 | [36mray::ClientAppActor.run()[39m (pid=9650, ip=127.0.0.1, actor_id=cbf68a497b722b4290c019ba01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x103d2f6d0>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/message_handler/message_handler.py", line 129, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
              ^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client.py", line 255, in maybe_call_fit
    return client.fit(fit_ins)
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 259, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/texas100/globalattack.py", line 155, in fit
    loss = self.criterion(outputs, labels)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/loss.py", line 1188, in forward
    return F.cross_entropy(input, target, weight=self.weight,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/functional.py", line 3104, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected floating point type for target with class probabilities, got Long

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=9650, ip=127.0.0.1, actor_id=cbf68a497b722b4290c019ba01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x103d2f6d0>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Expected floating point type for target with class probabilities, got Long
globalattack | INFO flwr 2024-11-08 17:15:37,843 | server.py:240 | aggregate_fit: received 0 results and 5 failures
globalattack | INFO flwr 2024-11-08 17:15:37,844 | server.py:178 | configure_evaluate: strategy sampled 5 clients (out of 5)
globalattack | INFO flwr 2024-11-08 17:19:12,135 | app.py:219 | Starting Flower simulation, config: num_rounds=10, no round_timeout
globalattack | INFO flwr 2024-11-08 17:19:14,420 | app.py:242 | Flower VCE: Ray initialized with resources: {'node:127.0.0.1': 1.0, 'memory': 5511307264.0, 'GPU': 1.0, 'node:__internal_head__': 1.0, 'CPU': 8.0, 'object_store_memory': 2147483648.0}
globalattack | INFO flwr 2024-11-08 17:19:14,421 | app.py:248 | Optimize your simulation with Flower VCE: https://flower.ai/docs/framework/how-to-run-simulations.html
globalattack | INFO flwr 2024-11-08 17:19:14,421 | app.py:271 | Flower VCE: Resources for each Virtual Client: {'num_cpus': 1, 'num_gpus': 0.2}
globalattack | INFO flwr 2024-11-08 17:19:14,429 | app.py:317 | Flower VCE: Creating VirtualClientEngineActorPool with 5 actors
globalattack | INFO flwr 2024-11-08 17:19:14,429 | server.py:92 | [INIT]
globalattack | INFO flwr 2024-11-08 17:19:14,429 | server.py:281 | Requesting initial parameters from one random client
globalattack | INFO flwr 2024-11-08 17:19:19,390 | server.py:288 | Received initial parameters from one random client
globalattack | INFO flwr 2024-11-08 17:19:19,390 | server.py:94 | Starting evaluation of initial global parameters
globalattack | INFO flwr 2024-11-08 17:19:19,390 | server.py:106 | Evaluation returned no results (`None`)
globalattack | INFO flwr 2024-11-08 17:19:19,390 | server.py:112 | 
globalattack | INFO flwr 2024-11-08 17:19:19,390 | server.py:113 | [ROUND 1]
globalattack | INFO flwr 2024-11-08 17:19:19,391 | server.py:226 | configure_fit: strategy sampled 5 clients (out of 5)
globalattack | ERROR flwr 2024-11-08 17:19:32,469 | ray_client_proxy.py:106 | Traceback (most recent call last):
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 94, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 398, in get_client_result
    return self._fetch_future_result(cid)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 279, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
                                         ^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=9820, ip=127.0.0.1, actor_id=af3908374b471a7365724f9901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1069f0b50>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/message_handler/message_handler.py", line 129, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
              ^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client.py", line 255, in maybe_call_fit
    return client.fit(fit_ins)
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 259, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/texas100/globalattack.py", line 161, in fit
    loss = self.criterion(outputs, labels)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/loss.py", line 1188, in forward
    return F.cross_entropy(input, target, weight=self.weight,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/functional.py", line 3104, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected floating point type for target with class probabilities, got Long

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=9820, ip=127.0.0.1, actor_id=af3908374b471a7365724f9901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1069f0b50>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Expected floating point type for target with class probabilities, got Long

globalattack | ERROR flwr 2024-11-08 17:19:32,469 | ray_client_proxy.py:106 | Traceback (most recent call last):
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 94, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 398, in get_client_result
    return self._fetch_future_result(cid)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 279, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
                                         ^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=9821, ip=127.0.0.1, actor_id=c4ea4d1f5ae1f3878da5489a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x106d45850>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/message_handler/message_handler.py", line 129, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
              ^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client.py", line 255, in maybe_call_fit
    return client.fit(fit_ins)
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 259, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/texas100/globalattack.py", line 161, in fit
    loss = self.criterion(outputs, labels)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/loss.py", line 1188, in forward
    return F.cross_entropy(input, target, weight=self.weight,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/functional.py", line 3104, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected floating point type for target with class probabilities, got Long

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=9821, ip=127.0.0.1, actor_id=c4ea4d1f5ae1f3878da5489a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x106d45850>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Expected floating point type for target with class probabilities, got Long

globalattack | ERROR flwr 2024-11-08 17:19:32,469 | ray_client_proxy.py:106 | Traceback (most recent call last):
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 94, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 398, in get_client_result
    return self._fetch_future_result(cid)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 279, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
                                         ^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=9822, ip=127.0.0.1, actor_id=a932a79c449044005091a7c601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x107249790>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/message_handler/message_handler.py", line 129, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
              ^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client.py", line 255, in maybe_call_fit
    return client.fit(fit_ins)
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 259, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/texas100/globalattack.py", line 161, in fit
    loss = self.criterion(outputs, labels)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/loss.py", line 1188, in forward
    return F.cross_entropy(input, target, weight=self.weight,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/functional.py", line 3104, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected floating point type for target with class probabilities, got Long

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=9822, ip=127.0.0.1, actor_id=a932a79c449044005091a7c601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x107249790>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Expected floating point type for target with class probabilities, got Long

globalattack | ERROR flwr 2024-11-08 17:19:32,470 | ray_client_proxy.py:106 | Traceback (most recent call last):
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 94, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 398, in get_client_result
    return self._fetch_future_result(cid)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 279, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
                                         ^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=9819, ip=127.0.0.1, actor_id=1de94fe2e0bc1b22196a618501000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x102e2fbd0>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/message_handler/message_handler.py", line 129, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
              ^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client.py", line 255, in maybe_call_fit
    return client.fit(fit_ins)
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 259, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/texas100/globalattack.py", line 161, in fit
    loss = self.criterion(outputs, labels)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/loss.py", line 1188, in forward
    return F.cross_entropy(input, target, weight=self.weight,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/functional.py", line 3104, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected floating point type for target with class probabilities, got Long

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=9819, ip=127.0.0.1, actor_id=1de94fe2e0bc1b22196a618501000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x102e2fbd0>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Expected floating point type for target with class probabilities, got Long

globalattack | ERROR flwr 2024-11-08 17:19:32,470 | ray_client_proxy.py:107 | [36mray::ClientAppActor.run()[39m (pid=9820, ip=127.0.0.1, actor_id=af3908374b471a7365724f9901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1069f0b50>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/message_handler/message_handler.py", line 129, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
              ^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client.py", line 255, in maybe_call_fit
    return client.fit(fit_ins)
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 259, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/texas100/globalattack.py", line 161, in fit
    loss = self.criterion(outputs, labels)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/loss.py", line 1188, in forward
    return F.cross_entropy(input, target, weight=self.weight,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/functional.py", line 3104, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected floating point type for target with class probabilities, got Long

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=9820, ip=127.0.0.1, actor_id=af3908374b471a7365724f9901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1069f0b50>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Expected floating point type for target with class probabilities, got Long
globalattack | ERROR flwr 2024-11-08 17:19:32,470 | ray_client_proxy.py:107 | [36mray::ClientAppActor.run()[39m (pid=9821, ip=127.0.0.1, actor_id=c4ea4d1f5ae1f3878da5489a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x106d45850>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/message_handler/message_handler.py", line 129, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
              ^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client.py", line 255, in maybe_call_fit
    return client.fit(fit_ins)
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 259, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/texas100/globalattack.py", line 161, in fit
    loss = self.criterion(outputs, labels)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/loss.py", line 1188, in forward
    return F.cross_entropy(input, target, weight=self.weight,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/functional.py", line 3104, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected floating point type for target with class probabilities, got Long

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=9821, ip=127.0.0.1, actor_id=c4ea4d1f5ae1f3878da5489a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x106d45850>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Expected floating point type for target with class probabilities, got Long
globalattack | ERROR flwr 2024-11-08 17:19:32,470 | ray_client_proxy.py:107 | [36mray::ClientAppActor.run()[39m (pid=9822, ip=127.0.0.1, actor_id=a932a79c449044005091a7c601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x107249790>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/message_handler/message_handler.py", line 129, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
              ^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client.py", line 255, in maybe_call_fit
    return client.fit(fit_ins)
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 259, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/texas100/globalattack.py", line 161, in fit
    loss = self.criterion(outputs, labels)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/loss.py", line 1188, in forward
    return F.cross_entropy(input, target, weight=self.weight,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/functional.py", line 3104, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected floating point type for target with class probabilities, got Long

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=9822, ip=127.0.0.1, actor_id=a932a79c449044005091a7c601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x107249790>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Expected floating point type for target with class probabilities, got Long
globalattack | ERROR flwr 2024-11-08 17:19:32,470 | ray_client_proxy.py:107 | [36mray::ClientAppActor.run()[39m (pid=9819, ip=127.0.0.1, actor_id=1de94fe2e0bc1b22196a618501000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x102e2fbd0>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/message_handler/message_handler.py", line 129, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
              ^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client.py", line 255, in maybe_call_fit
    return client.fit(fit_ins)
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 259, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/texas100/globalattack.py", line 161, in fit
    loss = self.criterion(outputs, labels)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/loss.py", line 1188, in forward
    return F.cross_entropy(input, target, weight=self.weight,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/functional.py", line 3104, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected floating point type for target with class probabilities, got Long

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=9819, ip=127.0.0.1, actor_id=1de94fe2e0bc1b22196a618501000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x102e2fbd0>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Expected floating point type for target with class probabilities, got Long
globalattack | ERROR flwr 2024-11-08 17:19:33,894 | ray_client_proxy.py:106 | Traceback (most recent call last):
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 94, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 398, in get_client_result
    return self._fetch_future_result(cid)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 279, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
                                         ^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=9818, ip=127.0.0.1, actor_id=fcc2c6def9f546af828ccd1801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x104f43cd0>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/message_handler/message_handler.py", line 129, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
              ^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client.py", line 255, in maybe_call_fit
    return client.fit(fit_ins)
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 259, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/texas100/globalattack.py", line 161, in fit
    loss = self.criterion(outputs, labels)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/loss.py", line 1188, in forward
    return F.cross_entropy(input, target, weight=self.weight,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/functional.py", line 3104, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected floating point type for target with class probabilities, got Long

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=9818, ip=127.0.0.1, actor_id=fcc2c6def9f546af828ccd1801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x104f43cd0>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Expected floating point type for target with class probabilities, got Long

globalattack | ERROR flwr 2024-11-08 17:19:33,894 | ray_client_proxy.py:107 | [36mray::ClientAppActor.run()[39m (pid=9818, ip=127.0.0.1, actor_id=fcc2c6def9f546af828ccd1801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x104f43cd0>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/message_handler/message_handler.py", line 129, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
              ^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client.py", line 255, in maybe_call_fit
    return client.fit(fit_ins)
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 259, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/texas100/globalattack.py", line 161, in fit
    loss = self.criterion(outputs, labels)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/loss.py", line 1188, in forward
    return F.cross_entropy(input, target, weight=self.weight,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/functional.py", line 3104, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected floating point type for target with class probabilities, got Long

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=9818, ip=127.0.0.1, actor_id=fcc2c6def9f546af828ccd1801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x104f43cd0>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Expected floating point type for target with class probabilities, got Long
globalattack | INFO flwr 2024-11-08 17:19:33,895 | server.py:240 | aggregate_fit: received 0 results and 5 failures
globalattack | INFO flwr 2024-11-08 17:19:33,895 | server.py:178 | configure_evaluate: strategy sampled 5 clients (out of 5)
globalattack | ERROR flwr 2024-11-08 17:19:47,294 | ray_client_proxy.py:106 | Traceback (most recent call last):
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 94, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 398, in get_client_result
    return self._fetch_future_result(cid)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 279, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
                                         ^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=9818, ip=127.0.0.1, actor_id=fcc2c6def9f546af828ccd1801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x104f43cd0>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/message_handler/message_handler.py", line 136, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
                   ^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client.py", line 275, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 283, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/texas100/globalattack.py", line 176, in evaluate
    correct += (predicted == labels).sum().item()
                ^^^^^^^^^^^^^^^^^^^
RuntimeError: The size of tensor a (64) must match the size of tensor b (100) at non-singleton dimension 1

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=9818, ip=127.0.0.1, actor_id=fcc2c6def9f546af828ccd1801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x104f43cd0>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: The size of tensor a (64) must match the size of tensor b (100) at non-singleton dimension 1

globalattack | ERROR flwr 2024-11-08 17:19:47,295 | ray_client_proxy.py:106 | Traceback (most recent call last):
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 94, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 398, in get_client_result
    return self._fetch_future_result(cid)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 279, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
                                         ^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=9819, ip=127.0.0.1, actor_id=1de94fe2e0bc1b22196a618501000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x102e2fbd0>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/message_handler/message_handler.py", line 136, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
                   ^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client.py", line 275, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 283, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/texas100/globalattack.py", line 176, in evaluate
    correct += (predicted == labels).sum().item()
                ^^^^^^^^^^^^^^^^^^^
RuntimeError: The size of tensor a (64) must match the size of tensor b (100) at non-singleton dimension 1

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=9819, ip=127.0.0.1, actor_id=1de94fe2e0bc1b22196a618501000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x102e2fbd0>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: The size of tensor a (64) must match the size of tensor b (100) at non-singleton dimension 1

globalattack | ERROR flwr 2024-11-08 17:19:47,295 | ray_client_proxy.py:106 | Traceback (most recent call last):
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 94, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 398, in get_client_result
    return self._fetch_future_result(cid)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 279, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
                                         ^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=9820, ip=127.0.0.1, actor_id=af3908374b471a7365724f9901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1069f0b50>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/message_handler/message_handler.py", line 136, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
                   ^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client.py", line 275, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 283, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/texas100/globalattack.py", line 176, in evaluate
    correct += (predicted == labels).sum().item()
                ^^^^^^^^^^^^^^^^^^^
RuntimeError: The size of tensor a (64) must match the size of tensor b (100) at non-singleton dimension 1

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=9820, ip=127.0.0.1, actor_id=af3908374b471a7365724f9901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1069f0b50>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: The size of tensor a (64) must match the size of tensor b (100) at non-singleton dimension 1

globalattack | ERROR flwr 2024-11-08 17:19:47,295 | ray_client_proxy.py:106 | Traceback (most recent call last):
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 94, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 398, in get_client_result
    return self._fetch_future_result(cid)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 279, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
                                         ^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=9821, ip=127.0.0.1, actor_id=c4ea4d1f5ae1f3878da5489a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x106d45850>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/message_handler/message_handler.py", line 136, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
                   ^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client.py", line 275, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 283, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/texas100/globalattack.py", line 176, in evaluate
    correct += (predicted == labels).sum().item()
                ^^^^^^^^^^^^^^^^^^^
RuntimeError: The size of tensor a (64) must match the size of tensor b (100) at non-singleton dimension 1

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=9821, ip=127.0.0.1, actor_id=c4ea4d1f5ae1f3878da5489a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x106d45850>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: The size of tensor a (64) must match the size of tensor b (100) at non-singleton dimension 1

globalattack | ERROR flwr 2024-11-08 17:19:47,296 | ray_client_proxy.py:107 | [36mray::ClientAppActor.run()[39m (pid=9818, ip=127.0.0.1, actor_id=fcc2c6def9f546af828ccd1801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x104f43cd0>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/message_handler/message_handler.py", line 136, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
                   ^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client.py", line 275, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 283, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/texas100/globalattack.py", line 176, in evaluate
    correct += (predicted == labels).sum().item()
                ^^^^^^^^^^^^^^^^^^^
RuntimeError: The size of tensor a (64) must match the size of tensor b (100) at non-singleton dimension 1

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=9818, ip=127.0.0.1, actor_id=fcc2c6def9f546af828ccd1801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x104f43cd0>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: The size of tensor a (64) must match the size of tensor b (100) at non-singleton dimension 1
globalattack | ERROR flwr 2024-11-08 17:19:47,296 | ray_client_proxy.py:107 | [36mray::ClientAppActor.run()[39m (pid=9819, ip=127.0.0.1, actor_id=1de94fe2e0bc1b22196a618501000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x102e2fbd0>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/message_handler/message_handler.py", line 136, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
                   ^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client.py", line 275, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 283, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/texas100/globalattack.py", line 176, in evaluate
    correct += (predicted == labels).sum().item()
                ^^^^^^^^^^^^^^^^^^^
RuntimeError: The size of tensor a (64) must match the size of tensor b (100) at non-singleton dimension 1

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=9819, ip=127.0.0.1, actor_id=1de94fe2e0bc1b22196a618501000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x102e2fbd0>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: The size of tensor a (64) must match the size of tensor b (100) at non-singleton dimension 1
globalattack | ERROR flwr 2024-11-08 17:19:47,296 | ray_client_proxy.py:107 | [36mray::ClientAppActor.run()[39m (pid=9820, ip=127.0.0.1, actor_id=af3908374b471a7365724f9901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1069f0b50>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/message_handler/message_handler.py", line 136, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
                   ^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client.py", line 275, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 283, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/texas100/globalattack.py", line 176, in evaluate
    correct += (predicted == labels).sum().item()
                ^^^^^^^^^^^^^^^^^^^
RuntimeError: The size of tensor a (64) must match the size of tensor b (100) at non-singleton dimension 1

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=9820, ip=127.0.0.1, actor_id=af3908374b471a7365724f9901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1069f0b50>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: The size of tensor a (64) must match the size of tensor b (100) at non-singleton dimension 1
globalattack | ERROR flwr 2024-11-08 17:19:47,296 | ray_client_proxy.py:107 | [36mray::ClientAppActor.run()[39m (pid=9821, ip=127.0.0.1, actor_id=c4ea4d1f5ae1f3878da5489a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x106d45850>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/message_handler/message_handler.py", line 136, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
                   ^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client.py", line 275, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 283, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/texas100/globalattack.py", line 176, in evaluate
    correct += (predicted == labels).sum().item()
                ^^^^^^^^^^^^^^^^^^^
RuntimeError: The size of tensor a (64) must match the size of tensor b (100) at non-singleton dimension 1

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=9821, ip=127.0.0.1, actor_id=c4ea4d1f5ae1f3878da5489a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x106d45850>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: The size of tensor a (64) must match the size of tensor b (100) at non-singleton dimension 1
globalattack | ERROR flwr 2024-11-08 17:19:47,674 | ray_client_proxy.py:106 | Traceback (most recent call last):
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 94, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 398, in get_client_result
    return self._fetch_future_result(cid)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 279, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
                                         ^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=9822, ip=127.0.0.1, actor_id=a932a79c449044005091a7c601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x107249790>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/message_handler/message_handler.py", line 136, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
                   ^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client.py", line 275, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 283, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/texas100/globalattack.py", line 176, in evaluate
    correct += (predicted == labels).sum().item()
                ^^^^^^^^^^^^^^^^^^^
RuntimeError: The size of tensor a (64) must match the size of tensor b (100) at non-singleton dimension 1

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=9822, ip=127.0.0.1, actor_id=a932a79c449044005091a7c601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x107249790>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: The size of tensor a (64) must match the size of tensor b (100) at non-singleton dimension 1

globalattack | ERROR flwr 2024-11-08 17:19:47,675 | ray_client_proxy.py:107 | [36mray::ClientAppActor.run()[39m (pid=9822, ip=127.0.0.1, actor_id=a932a79c449044005091a7c601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x107249790>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/message_handler/message_handler.py", line 136, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
                   ^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client.py", line 275, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 283, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/texas100/globalattack.py", line 176, in evaluate
    correct += (predicted == labels).sum().item()
                ^^^^^^^^^^^^^^^^^^^
RuntimeError: The size of tensor a (64) must match the size of tensor b (100) at non-singleton dimension 1

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=9822, ip=127.0.0.1, actor_id=a932a79c449044005091a7c601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x107249790>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: The size of tensor a (64) must match the size of tensor b (100) at non-singleton dimension 1
globalattack | INFO flwr 2024-11-08 17:19:47,675 | server.py:192 | aggregate_evaluate: received 0 results and 5 failures
globalattack | INFO flwr 2024-11-08 17:19:47,675 | server.py:112 | 
globalattack | INFO flwr 2024-11-08 17:19:47,675 | server.py:113 | [ROUND 2]
globalattack | INFO flwr 2024-11-08 17:19:47,675 | server.py:226 | configure_fit: strategy sampled 5 clients (out of 5)
globalattack | ERROR flwr 2024-11-08 17:19:59,478 | ray_client_proxy.py:106 | Traceback (most recent call last):
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 94, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 398, in get_client_result
    return self._fetch_future_result(cid)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 279, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
                                         ^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=9822, ip=127.0.0.1, actor_id=a932a79c449044005091a7c601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x107249790>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/message_handler/message_handler.py", line 129, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
              ^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client.py", line 255, in maybe_call_fit
    return client.fit(fit_ins)
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 259, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/texas100/globalattack.py", line 161, in fit
    loss = self.criterion(outputs, labels)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/loss.py", line 1188, in forward
    return F.cross_entropy(input, target, weight=self.weight,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/functional.py", line 3104, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected floating point type for target with class probabilities, got Long

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=9822, ip=127.0.0.1, actor_id=a932a79c449044005091a7c601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x107249790>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Expected floating point type for target with class probabilities, got Long

globalattack | ERROR flwr 2024-11-08 17:19:59,479 | ray_client_proxy.py:106 | Traceback (most recent call last):
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 94, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 398, in get_client_result
    return self._fetch_future_result(cid)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 279, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
                                         ^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=9819, ip=127.0.0.1, actor_id=1de94fe2e0bc1b22196a618501000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x102e2fbd0>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/message_handler/message_handler.py", line 129, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
              ^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client.py", line 255, in maybe_call_fit
    return client.fit(fit_ins)
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 259, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/texas100/globalattack.py", line 161, in fit
    loss = self.criterion(outputs, labels)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/loss.py", line 1188, in forward
    return F.cross_entropy(input, target, weight=self.weight,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/functional.py", line 3104, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected floating point type for target with class probabilities, got Long

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=9819, ip=127.0.0.1, actor_id=1de94fe2e0bc1b22196a618501000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x102e2fbd0>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Expected floating point type for target with class probabilities, got Long

globalattack | ERROR flwr 2024-11-08 17:19:59,479 | ray_client_proxy.py:106 | Traceback (most recent call last):
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 94, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 398, in get_client_result
    return self._fetch_future_result(cid)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 279, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
                                         ^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=9820, ip=127.0.0.1, actor_id=af3908374b471a7365724f9901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1069f0b50>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/message_handler/message_handler.py", line 129, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
              ^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client.py", line 255, in maybe_call_fit
    return client.fit(fit_ins)
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 259, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/texas100/globalattack.py", line 161, in fit
    loss = self.criterion(outputs, labels)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/loss.py", line 1188, in forward
    return F.cross_entropy(input, target, weight=self.weight,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/functional.py", line 3104, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected floating point type for target with class probabilities, got Long

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=9820, ip=127.0.0.1, actor_id=af3908374b471a7365724f9901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1069f0b50>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Expected floating point type for target with class probabilities, got Long

globalattack | ERROR flwr 2024-11-08 17:19:59,479 | ray_client_proxy.py:107 | [36mray::ClientAppActor.run()[39m (pid=9822, ip=127.0.0.1, actor_id=a932a79c449044005091a7c601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x107249790>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/message_handler/message_handler.py", line 129, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
              ^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client.py", line 255, in maybe_call_fit
    return client.fit(fit_ins)
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 259, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/texas100/globalattack.py", line 161, in fit
    loss = self.criterion(outputs, labels)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/loss.py", line 1188, in forward
    return F.cross_entropy(input, target, weight=self.weight,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/functional.py", line 3104, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected floating point type for target with class probabilities, got Long

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=9822, ip=127.0.0.1, actor_id=a932a79c449044005091a7c601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x107249790>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Expected floating point type for target with class probabilities, got Long
globalattack | ERROR flwr 2024-11-08 17:19:59,479 | ray_client_proxy.py:106 | Traceback (most recent call last):
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 94, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 398, in get_client_result
    return self._fetch_future_result(cid)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 279, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
                                         ^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=9821, ip=127.0.0.1, actor_id=c4ea4d1f5ae1f3878da5489a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x106d45850>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/message_handler/message_handler.py", line 129, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
              ^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client.py", line 255, in maybe_call_fit
    return client.fit(fit_ins)
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 259, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/texas100/globalattack.py", line 161, in fit
    loss = self.criterion(outputs, labels)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/loss.py", line 1188, in forward
    return F.cross_entropy(input, target, weight=self.weight,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/functional.py", line 3104, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected floating point type for target with class probabilities, got Long

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=9821, ip=127.0.0.1, actor_id=c4ea4d1f5ae1f3878da5489a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x106d45850>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Expected floating point type for target with class probabilities, got Long

globalattack | ERROR flwr 2024-11-08 17:19:59,479 | ray_client_proxy.py:107 | [36mray::ClientAppActor.run()[39m (pid=9819, ip=127.0.0.1, actor_id=1de94fe2e0bc1b22196a618501000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x102e2fbd0>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/message_handler/message_handler.py", line 129, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
              ^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client.py", line 255, in maybe_call_fit
    return client.fit(fit_ins)
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 259, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/texas100/globalattack.py", line 161, in fit
    loss = self.criterion(outputs, labels)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/loss.py", line 1188, in forward
    return F.cross_entropy(input, target, weight=self.weight,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/functional.py", line 3104, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected floating point type for target with class probabilities, got Long

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=9819, ip=127.0.0.1, actor_id=1de94fe2e0bc1b22196a618501000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x102e2fbd0>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Expected floating point type for target with class probabilities, got Long
globalattack | ERROR flwr 2024-11-08 17:19:59,480 | ray_client_proxy.py:107 | [36mray::ClientAppActor.run()[39m (pid=9820, ip=127.0.0.1, actor_id=af3908374b471a7365724f9901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1069f0b50>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/message_handler/message_handler.py", line 129, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
              ^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client.py", line 255, in maybe_call_fit
    return client.fit(fit_ins)
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 259, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/texas100/globalattack.py", line 161, in fit
    loss = self.criterion(outputs, labels)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/loss.py", line 1188, in forward
    return F.cross_entropy(input, target, weight=self.weight,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/functional.py", line 3104, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected floating point type for target with class probabilities, got Long

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=9820, ip=127.0.0.1, actor_id=af3908374b471a7365724f9901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1069f0b50>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Expected floating point type for target with class probabilities, got Long
globalattack | ERROR flwr 2024-11-08 17:19:59,480 | ray_client_proxy.py:107 | [36mray::ClientAppActor.run()[39m (pid=9821, ip=127.0.0.1, actor_id=c4ea4d1f5ae1f3878da5489a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x106d45850>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/message_handler/message_handler.py", line 129, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
              ^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client.py", line 255, in maybe_call_fit
    return client.fit(fit_ins)
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 259, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/texas100/globalattack.py", line 161, in fit
    loss = self.criterion(outputs, labels)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/loss.py", line 1188, in forward
    return F.cross_entropy(input, target, weight=self.weight,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/functional.py", line 3104, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected floating point type for target with class probabilities, got Long

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=9821, ip=127.0.0.1, actor_id=c4ea4d1f5ae1f3878da5489a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x106d45850>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Expected floating point type for target with class probabilities, got Long
globalattack | ERROR flwr 2024-11-08 17:20:00,415 | ray_client_proxy.py:106 | Traceback (most recent call last):
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 94, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 398, in get_client_result
    return self._fetch_future_result(cid)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 279, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
                                         ^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=9818, ip=127.0.0.1, actor_id=fcc2c6def9f546af828ccd1801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x104f43cd0>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/message_handler/message_handler.py", line 129, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
              ^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client.py", line 255, in maybe_call_fit
    return client.fit(fit_ins)
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 259, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/texas100/globalattack.py", line 161, in fit
    loss = self.criterion(outputs, labels)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/loss.py", line 1188, in forward
    return F.cross_entropy(input, target, weight=self.weight,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/functional.py", line 3104, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected floating point type for target with class probabilities, got Long

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=9818, ip=127.0.0.1, actor_id=fcc2c6def9f546af828ccd1801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x104f43cd0>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Expected floating point type for target with class probabilities, got Long

globalattack | ERROR flwr 2024-11-08 17:20:00,415 | ray_client_proxy.py:107 | [36mray::ClientAppActor.run()[39m (pid=9818, ip=127.0.0.1, actor_id=fcc2c6def9f546af828ccd1801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x104f43cd0>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/message_handler/message_handler.py", line 129, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
              ^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client.py", line 255, in maybe_call_fit
    return client.fit(fit_ins)
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 259, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/texas100/globalattack.py", line 161, in fit
    loss = self.criterion(outputs, labels)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/loss.py", line 1188, in forward
    return F.cross_entropy(input, target, weight=self.weight,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/functional.py", line 3104, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected floating point type for target with class probabilities, got Long

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=9818, ip=127.0.0.1, actor_id=fcc2c6def9f546af828ccd1801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x104f43cd0>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Expected floating point type for target with class probabilities, got Long
globalattack | INFO flwr 2024-11-08 17:20:00,418 | server.py:240 | aggregate_fit: received 0 results and 5 failures
globalattack | INFO flwr 2024-11-08 17:20:00,424 | server.py:178 | configure_evaluate: strategy sampled 5 clients (out of 5)
globalattack | ERROR flwr 2024-11-08 17:20:12,441 | ray_client_proxy.py:106 | Traceback (most recent call last):
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 94, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 398, in get_client_result
    return self._fetch_future_result(cid)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 279, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
                                         ^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=9818, ip=127.0.0.1, actor_id=fcc2c6def9f546af828ccd1801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x104f43cd0>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/message_handler/message_handler.py", line 136, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
                   ^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client.py", line 275, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 283, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/texas100/globalattack.py", line 176, in evaluate
    correct += (predicted == labels).sum().item()
                ^^^^^^^^^^^^^^^^^^^
RuntimeError: The size of tensor a (64) must match the size of tensor b (100) at non-singleton dimension 1

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=9818, ip=127.0.0.1, actor_id=fcc2c6def9f546af828ccd1801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x104f43cd0>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: The size of tensor a (64) must match the size of tensor b (100) at non-singleton dimension 1

globalattack | ERROR flwr 2024-11-08 17:20:12,442 | ray_client_proxy.py:107 | [36mray::ClientAppActor.run()[39m (pid=9818, ip=127.0.0.1, actor_id=fcc2c6def9f546af828ccd1801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x104f43cd0>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/message_handler/message_handler.py", line 136, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
                   ^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client.py", line 275, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 283, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/texas100/globalattack.py", line 176, in evaluate
    correct += (predicted == labels).sum().item()
                ^^^^^^^^^^^^^^^^^^^
RuntimeError: The size of tensor a (64) must match the size of tensor b (100) at non-singleton dimension 1

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=9818, ip=127.0.0.1, actor_id=fcc2c6def9f546af828ccd1801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x104f43cd0>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: The size of tensor a (64) must match the size of tensor b (100) at non-singleton dimension 1
globalattack | ERROR flwr 2024-11-08 17:20:12,443 | ray_client_proxy.py:106 | Traceback (most recent call last):
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 94, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 398, in get_client_result
    return self._fetch_future_result(cid)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 279, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
                                         ^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=9820, ip=127.0.0.1, actor_id=af3908374b471a7365724f9901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1069f0b50>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/message_handler/message_handler.py", line 136, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
                   ^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client.py", line 275, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 283, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/texas100/globalattack.py", line 176, in evaluate
    correct += (predicted == labels).sum().item()
                ^^^^^^^^^^^^^^^^^^^
RuntimeError: The size of tensor a (64) must match the size of tensor b (100) at non-singleton dimension 1

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=9820, ip=127.0.0.1, actor_id=af3908374b471a7365724f9901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1069f0b50>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: The size of tensor a (64) must match the size of tensor b (100) at non-singleton dimension 1

globalattack | ERROR flwr 2024-11-08 17:20:12,443 | ray_client_proxy.py:106 | Traceback (most recent call last):
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 94, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 398, in get_client_result
    return self._fetch_future_result(cid)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 279, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
                                         ^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=9821, ip=127.0.0.1, actor_id=c4ea4d1f5ae1f3878da5489a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x106d45850>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/message_handler/message_handler.py", line 136, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
                   ^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client.py", line 275, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 283, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/texas100/globalattack.py", line 176, in evaluate
    correct += (predicted == labels).sum().item()
                ^^^^^^^^^^^^^^^^^^^
RuntimeError: The size of tensor a (64) must match the size of tensor b (100) at non-singleton dimension 1

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=9821, ip=127.0.0.1, actor_id=c4ea4d1f5ae1f3878da5489a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x106d45850>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: The size of tensor a (64) must match the size of tensor b (100) at non-singleton dimension 1

globalattack | ERROR flwr 2024-11-08 17:20:12,443 | ray_client_proxy.py:106 | Traceback (most recent call last):
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 94, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 398, in get_client_result
    return self._fetch_future_result(cid)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 279, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
                                         ^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=9819, ip=127.0.0.1, actor_id=1de94fe2e0bc1b22196a618501000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x102e2fbd0>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/message_handler/message_handler.py", line 136, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
                   ^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client.py", line 275, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 283, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/texas100/globalattack.py", line 176, in evaluate
    correct += (predicted == labels).sum().item()
                ^^^^^^^^^^^^^^^^^^^
RuntimeError: The size of tensor a (64) must match the size of tensor b (100) at non-singleton dimension 1

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=9819, ip=127.0.0.1, actor_id=1de94fe2e0bc1b22196a618501000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x102e2fbd0>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: The size of tensor a (64) must match the size of tensor b (100) at non-singleton dimension 1

globalattack | ERROR flwr 2024-11-08 17:20:12,443 | ray_client_proxy.py:107 | [36mray::ClientAppActor.run()[39m (pid=9820, ip=127.0.0.1, actor_id=af3908374b471a7365724f9901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1069f0b50>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/message_handler/message_handler.py", line 136, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
                   ^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client.py", line 275, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 283, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/texas100/globalattack.py", line 176, in evaluate
    correct += (predicted == labels).sum().item()
                ^^^^^^^^^^^^^^^^^^^
RuntimeError: The size of tensor a (64) must match the size of tensor b (100) at non-singleton dimension 1

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=9820, ip=127.0.0.1, actor_id=af3908374b471a7365724f9901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1069f0b50>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: The size of tensor a (64) must match the size of tensor b (100) at non-singleton dimension 1
globalattack | ERROR flwr 2024-11-08 17:20:12,443 | ray_client_proxy.py:107 | [36mray::ClientAppActor.run()[39m (pid=9821, ip=127.0.0.1, actor_id=c4ea4d1f5ae1f3878da5489a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x106d45850>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/message_handler/message_handler.py", line 136, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
                   ^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client.py", line 275, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 283, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/texas100/globalattack.py", line 176, in evaluate
    correct += (predicted == labels).sum().item()
                ^^^^^^^^^^^^^^^^^^^
RuntimeError: The size of tensor a (64) must match the size of tensor b (100) at non-singleton dimension 1

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=9821, ip=127.0.0.1, actor_id=c4ea4d1f5ae1f3878da5489a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x106d45850>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: The size of tensor a (64) must match the size of tensor b (100) at non-singleton dimension 1
globalattack | ERROR flwr 2024-11-08 17:20:12,443 | ray_client_proxy.py:107 | [36mray::ClientAppActor.run()[39m (pid=9819, ip=127.0.0.1, actor_id=1de94fe2e0bc1b22196a618501000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x102e2fbd0>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/message_handler/message_handler.py", line 136, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
                   ^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client.py", line 275, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 283, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/texas100/globalattack.py", line 176, in evaluate
    correct += (predicted == labels).sum().item()
                ^^^^^^^^^^^^^^^^^^^
RuntimeError: The size of tensor a (64) must match the size of tensor b (100) at non-singleton dimension 1

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=9819, ip=127.0.0.1, actor_id=1de94fe2e0bc1b22196a618501000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x102e2fbd0>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: The size of tensor a (64) must match the size of tensor b (100) at non-singleton dimension 1
globalattack | ERROR flwr 2024-11-08 17:20:12,831 | ray_client_proxy.py:106 | Traceback (most recent call last):
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 94, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 398, in get_client_result
    return self._fetch_future_result(cid)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 279, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
                                         ^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=9822, ip=127.0.0.1, actor_id=a932a79c449044005091a7c601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x107249790>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/message_handler/message_handler.py", line 136, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
                   ^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client.py", line 275, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 283, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/texas100/globalattack.py", line 176, in evaluate
    correct += (predicted == labels).sum().item()
                ^^^^^^^^^^^^^^^^^^^
RuntimeError: The size of tensor a (64) must match the size of tensor b (100) at non-singleton dimension 1

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=9822, ip=127.0.0.1, actor_id=a932a79c449044005091a7c601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x107249790>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: The size of tensor a (64) must match the size of tensor b (100) at non-singleton dimension 1

globalattack | ERROR flwr 2024-11-08 17:20:12,831 | ray_client_proxy.py:107 | [36mray::ClientAppActor.run()[39m (pid=9822, ip=127.0.0.1, actor_id=a932a79c449044005091a7c601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x107249790>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/message_handler/message_handler.py", line 136, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
                   ^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client.py", line 275, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 283, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/texas100/globalattack.py", line 176, in evaluate
    correct += (predicted == labels).sum().item()
                ^^^^^^^^^^^^^^^^^^^
RuntimeError: The size of tensor a (64) must match the size of tensor b (100) at non-singleton dimension 1

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=9822, ip=127.0.0.1, actor_id=a932a79c449044005091a7c601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x107249790>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: The size of tensor a (64) must match the size of tensor b (100) at non-singleton dimension 1
globalattack | INFO flwr 2024-11-08 17:20:12,832 | server.py:192 | aggregate_evaluate: received 0 results and 5 failures
globalattack | INFO flwr 2024-11-08 17:20:12,832 | server.py:112 | 
globalattack | INFO flwr 2024-11-08 17:20:12,832 | server.py:113 | [ROUND 3]
globalattack | INFO flwr 2024-11-08 17:20:12,832 | server.py:226 | configure_fit: strategy sampled 5 clients (out of 5)
globalattack | INFO flwr 2024-11-08 17:21:09,384 | app.py:219 | Starting Flower simulation, config: num_rounds=10, no round_timeout
globalattack | INFO flwr 2024-11-08 17:21:11,661 | app.py:242 | Flower VCE: Ray initialized with resources: {'node:__internal_head__': 1.0, 'GPU': 1.0, 'memory': 5780886324.0, 'node:127.0.0.1': 1.0, 'object_store_memory': 2147483648.0, 'CPU': 8.0}
globalattack | INFO flwr 2024-11-08 17:21:11,661 | app.py:248 | Optimize your simulation with Flower VCE: https://flower.ai/docs/framework/how-to-run-simulations.html
globalattack | INFO flwr 2024-11-08 17:21:11,661 | app.py:271 | Flower VCE: Resources for each Virtual Client: {'num_cpus': 1, 'num_gpus': 0.2}
globalattack | INFO flwr 2024-11-08 17:21:11,672 | app.py:317 | Flower VCE: Creating VirtualClientEngineActorPool with 5 actors
globalattack | INFO flwr 2024-11-08 17:21:11,672 | server.py:92 | [INIT]
globalattack | INFO flwr 2024-11-08 17:21:11,672 | server.py:281 | Requesting initial parameters from one random client
globalattack | INFO flwr 2024-11-08 17:21:17,160 | server.py:288 | Received initial parameters from one random client
globalattack | INFO flwr 2024-11-08 17:21:17,160 | server.py:94 | Starting evaluation of initial global parameters
globalattack | INFO flwr 2024-11-08 17:21:17,160 | server.py:106 | Evaluation returned no results (`None`)
globalattack | INFO flwr 2024-11-08 17:21:17,160 | server.py:112 | 
globalattack | INFO flwr 2024-11-08 17:21:17,160 | server.py:113 | [ROUND 1]
globalattack | INFO flwr 2024-11-08 17:21:17,161 | server.py:226 | configure_fit: strategy sampled 5 clients (out of 5)
globalattack | ERROR flwr 2024-11-08 17:21:30,355 | ray_client_proxy.py:106 | Traceback (most recent call last):
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 94, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 398, in get_client_result
    return self._fetch_future_result(cid)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 279, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
                                         ^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=9951, ip=127.0.0.1, actor_id=650d30305a5b7738a5386d6001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x10102f910>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/message_handler/message_handler.py", line 129, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
              ^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client.py", line 255, in maybe_call_fit
    return client.fit(fit_ins)
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 259, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/texas100/globalattack.py", line 161, in fit
    loss = self.criterion(outputs, labels)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/loss.py", line 1188, in forward
    return F.cross_entropy(input, target, weight=self.weight,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/functional.py", line 3104, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected floating point type for target with class probabilities, got Long

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=9951, ip=127.0.0.1, actor_id=650d30305a5b7738a5386d6001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x10102f910>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Expected floating point type for target with class probabilities, got Long

globalattack | ERROR flwr 2024-11-08 17:21:30,355 | ray_client_proxy.py:106 | Traceback (most recent call last):
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 94, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 398, in get_client_result
    return self._fetch_future_result(cid)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 279, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
                                         ^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=9953, ip=127.0.0.1, actor_id=762b8d78b5188d73a8b75c1c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1031f5dd0>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/message_handler/message_handler.py", line 129, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
              ^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client.py", line 255, in maybe_call_fit
    return client.fit(fit_ins)
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 259, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/texas100/globalattack.py", line 161, in fit
    loss = self.criterion(outputs, labels)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/loss.py", line 1188, in forward
    return F.cross_entropy(input, target, weight=self.weight,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/functional.py", line 3104, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected floating point type for target with class probabilities, got Long

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=9953, ip=127.0.0.1, actor_id=762b8d78b5188d73a8b75c1c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1031f5dd0>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Expected floating point type for target with class probabilities, got Long

globalattack | ERROR flwr 2024-11-08 17:21:30,356 | ray_client_proxy.py:106 | Traceback (most recent call last):
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 94, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 398, in get_client_result
    return self._fetch_future_result(cid)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 279, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
                                         ^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=9950, ip=127.0.0.1, actor_id=347da2ddc203e52e1f206e2701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b503710>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/message_handler/message_handler.py", line 129, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
              ^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client.py", line 255, in maybe_call_fit
    return client.fit(fit_ins)
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 259, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/texas100/globalattack.py", line 161, in fit
    loss = self.criterion(outputs, labels)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/loss.py", line 1188, in forward
    return F.cross_entropy(input, target, weight=self.weight,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/functional.py", line 3104, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected floating point type for target with class probabilities, got Long

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=9950, ip=127.0.0.1, actor_id=347da2ddc203e52e1f206e2701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b503710>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Expected floating point type for target with class probabilities, got Long

globalattack | ERROR flwr 2024-11-08 17:21:30,356 | ray_client_proxy.py:106 | Traceback (most recent call last):
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 94, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 398, in get_client_result
    return self._fetch_future_result(cid)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 279, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
                                         ^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=9952, ip=127.0.0.1, actor_id=d9ccb570deaaad2f05fadbe801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1659b8910>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/message_handler/message_handler.py", line 129, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
              ^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client.py", line 255, in maybe_call_fit
    return client.fit(fit_ins)
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 259, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/texas100/globalattack.py", line 161, in fit
    loss = self.criterion(outputs, labels)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/loss.py", line 1188, in forward
    return F.cross_entropy(input, target, weight=self.weight,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/functional.py", line 3104, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected floating point type for target with class probabilities, got Long

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=9952, ip=127.0.0.1, actor_id=d9ccb570deaaad2f05fadbe801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1659b8910>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Expected floating point type for target with class probabilities, got Long

globalattack | ERROR flwr 2024-11-08 17:21:30,356 | ray_client_proxy.py:107 | [36mray::ClientAppActor.run()[39m (pid=9951, ip=127.0.0.1, actor_id=650d30305a5b7738a5386d6001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x10102f910>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/message_handler/message_handler.py", line 129, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
              ^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client.py", line 255, in maybe_call_fit
    return client.fit(fit_ins)
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 259, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/texas100/globalattack.py", line 161, in fit
    loss = self.criterion(outputs, labels)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/loss.py", line 1188, in forward
    return F.cross_entropy(input, target, weight=self.weight,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/functional.py", line 3104, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected floating point type for target with class probabilities, got Long

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=9951, ip=127.0.0.1, actor_id=650d30305a5b7738a5386d6001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x10102f910>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Expected floating point type for target with class probabilities, got Long
globalattack | ERROR flwr 2024-11-08 17:21:30,356 | ray_client_proxy.py:107 | [36mray::ClientAppActor.run()[39m (pid=9953, ip=127.0.0.1, actor_id=762b8d78b5188d73a8b75c1c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1031f5dd0>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/message_handler/message_handler.py", line 129, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
              ^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client.py", line 255, in maybe_call_fit
    return client.fit(fit_ins)
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 259, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/texas100/globalattack.py", line 161, in fit
    loss = self.criterion(outputs, labels)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/loss.py", line 1188, in forward
    return F.cross_entropy(input, target, weight=self.weight,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/functional.py", line 3104, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected floating point type for target with class probabilities, got Long

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=9953, ip=127.0.0.1, actor_id=762b8d78b5188d73a8b75c1c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1031f5dd0>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Expected floating point type for target with class probabilities, got Long
globalattack | ERROR flwr 2024-11-08 17:21:30,356 | ray_client_proxy.py:107 | [36mray::ClientAppActor.run()[39m (pid=9950, ip=127.0.0.1, actor_id=347da2ddc203e52e1f206e2701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b503710>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/message_handler/message_handler.py", line 129, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
              ^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client.py", line 255, in maybe_call_fit
    return client.fit(fit_ins)
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 259, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/texas100/globalattack.py", line 161, in fit
    loss = self.criterion(outputs, labels)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/loss.py", line 1188, in forward
    return F.cross_entropy(input, target, weight=self.weight,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/functional.py", line 3104, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected floating point type for target with class probabilities, got Long

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=9950, ip=127.0.0.1, actor_id=347da2ddc203e52e1f206e2701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b503710>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Expected floating point type for target with class probabilities, got Long
globalattack | ERROR flwr 2024-11-08 17:21:30,356 | ray_client_proxy.py:107 | [36mray::ClientAppActor.run()[39m (pid=9952, ip=127.0.0.1, actor_id=d9ccb570deaaad2f05fadbe801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1659b8910>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/message_handler/message_handler.py", line 129, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
              ^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client.py", line 255, in maybe_call_fit
    return client.fit(fit_ins)
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 259, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/texas100/globalattack.py", line 161, in fit
    loss = self.criterion(outputs, labels)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/loss.py", line 1188, in forward
    return F.cross_entropy(input, target, weight=self.weight,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/functional.py", line 3104, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected floating point type for target with class probabilities, got Long

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=9952, ip=127.0.0.1, actor_id=d9ccb570deaaad2f05fadbe801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1659b8910>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Expected floating point type for target with class probabilities, got Long
globalattack | ERROR flwr 2024-11-08 17:21:31,645 | ray_client_proxy.py:106 | Traceback (most recent call last):
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 94, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 398, in get_client_result
    return self._fetch_future_result(cid)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 279, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
                                         ^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=9949, ip=127.0.0.1, actor_id=962306ad002c3eb7b9e4afa001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x104f07a50>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/message_handler/message_handler.py", line 129, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
              ^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client.py", line 255, in maybe_call_fit
    return client.fit(fit_ins)
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 259, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/texas100/globalattack.py", line 161, in fit
    loss = self.criterion(outputs, labels)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/loss.py", line 1188, in forward
    return F.cross_entropy(input, target, weight=self.weight,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/functional.py", line 3104, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected floating point type for target with class probabilities, got Long

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=9949, ip=127.0.0.1, actor_id=962306ad002c3eb7b9e4afa001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x104f07a50>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Expected floating point type for target with class probabilities, got Long

globalattack | ERROR flwr 2024-11-08 17:21:31,646 | ray_client_proxy.py:107 | [36mray::ClientAppActor.run()[39m (pid=9949, ip=127.0.0.1, actor_id=962306ad002c3eb7b9e4afa001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x104f07a50>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/message_handler/message_handler.py", line 129, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
              ^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client.py", line 255, in maybe_call_fit
    return client.fit(fit_ins)
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 259, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/texas100/globalattack.py", line 161, in fit
    loss = self.criterion(outputs, labels)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/modules/loss.py", line 1188, in forward
    return F.cross_entropy(input, target, weight=self.weight,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/torch/nn/functional.py", line 3104, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected floating point type for target with class probabilities, got Long

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=9949, ip=127.0.0.1, actor_id=962306ad002c3eb7b9e4afa001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x104f07a50>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Expected floating point type for target with class probabilities, got Long
globalattack | INFO flwr 2024-11-08 17:21:31,646 | server.py:240 | aggregate_fit: received 0 results and 5 failures
globalattack | INFO flwr 2024-11-08 17:21:31,646 | server.py:178 | configure_evaluate: strategy sampled 5 clients (out of 5)
globalattack | INFO flwr 2024-11-08 17:24:21,679 | app.py:219 | Starting Flower simulation, config: num_rounds=30, no round_timeout
globalattack | INFO flwr 2024-11-08 17:24:23,817 | app.py:242 | Flower VCE: Ray initialized with resources: {'GPU': 1.0, 'memory': 5780031079.0, 'node:__internal_head__': 1.0, 'node:127.0.0.1': 1.0, 'object_store_memory': 2147483648.0, 'CPU': 8.0}
globalattack | INFO flwr 2024-11-08 17:24:23,817 | app.py:248 | Optimize your simulation with Flower VCE: https://flower.ai/docs/framework/how-to-run-simulations.html
globalattack | INFO flwr 2024-11-08 17:24:23,817 | app.py:271 | Flower VCE: Resources for each Virtual Client: {'num_cpus': 1, 'num_gpus': 0.2}
globalattack | INFO flwr 2024-11-08 17:24:23,826 | app.py:317 | Flower VCE: Creating VirtualClientEngineActorPool with 5 actors
globalattack | INFO flwr 2024-11-08 17:24:23,826 | server.py:92 | [INIT]
globalattack | INFO flwr 2024-11-08 17:24:23,826 | server.py:281 | Requesting initial parameters from one random client
globalattack | ERROR flwr 2024-11-08 17:24:28,148 | ray_client_proxy.py:106 | Traceback (most recent call last):
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 94, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 398, in get_client_result
    return self._fetch_future_result(cid)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 279, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
                                         ^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=10049, ip=127.0.0.1, actor_id=f5e3b7cb6e54a1d5c183f8ba01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x16e997650>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/message_handler/message_handler.py", line 95, in handle_legacy_message_from_msgtype
    client = client_fn(context)
             ^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 67, in adaptor_fn
    return client_fn(str(cid))  # type: ignore
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/texas100/globalattack.py", line 200, in client_fn
    client_features = train_features[indices]
                      ~~~~~~~~~~~~~~^^^^^^^^^
IndexError: index 38349 is out of bounds for axis 0 with size 30000

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=10049, ip=127.0.0.1, actor_id=f5e3b7cb6e54a1d5c183f8ba01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x16e997650>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: index 38349 is out of bounds for axis 0 with size 30000

globalattack | ERROR flwr 2024-11-08 17:24:28,149 | ray_client_proxy.py:107 | [36mray::ClientAppActor.run()[39m (pid=10049, ip=127.0.0.1, actor_id=f5e3b7cb6e54a1d5c183f8ba01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x16e997650>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/message_handler/message_handler.py", line 95, in handle_legacy_message_from_msgtype
    client = client_fn(context)
             ^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 67, in adaptor_fn
    return client_fn(str(cid))  # type: ignore
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/texas100/globalattack.py", line 200, in client_fn
    client_features = train_features[indices]
                      ~~~~~~~~~~~~~~^^^^^^^^^
IndexError: index 38349 is out of bounds for axis 0 with size 30000

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=10049, ip=127.0.0.1, actor_id=f5e3b7cb6e54a1d5c183f8ba01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x16e997650>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: index 38349 is out of bounds for axis 0 with size 30000
globalattack | ERROR flwr 2024-11-08 17:24:28,149 | app.py:344 | [36mray::ClientAppActor.run()[39m (pid=10049, ip=127.0.0.1, actor_id=f5e3b7cb6e54a1d5c183f8ba01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x16e997650>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/message_handler/message_handler.py", line 95, in handle_legacy_message_from_msgtype
    client = client_fn(context)
             ^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 67, in adaptor_fn
    return client_fn(str(cid))  # type: ignore
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/texas100/globalattack.py", line 200, in client_fn
    client_features = train_features[indices]
                      ~~~~~~~~~~~~~~^^^^^^^^^
IndexError: index 38349 is out of bounds for axis 0 with size 30000

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=10049, ip=127.0.0.1, actor_id=f5e3b7cb6e54a1d5c183f8ba01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x16e997650>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: index 38349 is out of bounds for axis 0 with size 30000
globalattack | ERROR flwr 2024-11-08 17:24:28,149 | app.py:345 | Traceback (most recent call last):
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/app.py", line 339, in start_simulation
    hist = run_fl(
           ^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/server/server.py", line 492, in run_fl
    hist, elapsed_time = server.fit(
                         ^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/server/server.py", line 93, in fit
    self.parameters = self._get_initial_parameters(server_round=0, timeout=timeout)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/server/server.py", line 284, in _get_initial_parameters
    get_parameters_res = random_client.get_parameters(
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 168, in get_parameters
    message_out = self._submit_job(message, timeout)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 108, in _submit_job
    raise ex
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 94, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 398, in get_client_result
    return self._fetch_future_result(cid)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 279, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
                                         ^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=10049, ip=127.0.0.1, actor_id=f5e3b7cb6e54a1d5c183f8ba01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x16e997650>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/message_handler/message_handler.py", line 95, in handle_legacy_message_from_msgtype
    client = client_fn(context)
             ^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 67, in adaptor_fn
    return client_fn(str(cid))  # type: ignore
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/texas100/globalattack.py", line 200, in client_fn
    client_features = train_features[indices]
                      ~~~~~~~~~~~~~~^^^^^^^^^
IndexError: index 38349 is out of bounds for axis 0 with size 30000

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=10049, ip=127.0.0.1, actor_id=f5e3b7cb6e54a1d5c183f8ba01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x16e997650>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: index 38349 is out of bounds for axis 0 with size 30000

globalattack | ERROR flwr 2024-11-08 17:24:28,150 | app.py:346 | Your simulation crashed :(. This could be because of several reasons. The most common are: 
	 > Sometimes, issues in the simulation code itself can cause crashes. It's always a good idea to double-check your code for any potential bugs or inconsistencies that might be contributing to the problem. For example: 
		 - You might be using a class attribute in your clients that hasn't been defined.
		 - There could be an incorrect method call to a 3rd party library (e.g., PyTorch).
		 - The return types of methods in your clients/strategies might be incorrect.
	 > Your system couldn't fit a single VirtualClient: try lowering `client_resources`.
	 > All the actors in your pool crashed. This could be because: 
		 - You clients hit an out-of-memory (OOM) error and actors couldn't recover from it. Try launching your simulation with more generous `client_resources` setting (i.e. it seems {'num_cpus': 1, 'num_gpus': 0.2} is not enough for your run). Use fewer concurrent actors. 
		 - You were running a multi-node simulation and all worker nodes disconnected. The head node might still be alive but cannot accommodate any actor with resources: {'num_cpus': 1, 'num_gpus': 0.2}.
Take a look at the Flower simulation examples for guidance <https://flower.ai/docs/framework/how-to-run-simulations.html>.
globalattack | INFO flwr 2024-11-08 17:25:23,166 | app.py:219 | Starting Flower simulation, config: num_rounds=30, no round_timeout
globalattack | INFO flwr 2024-11-08 17:25:25,356 | app.py:242 | Flower VCE: Ray initialized with resources: {'object_store_memory': 2147483648.0, 'memory': 5986012365.0, 'GPU': 1.0, 'node:127.0.0.1': 1.0, 'CPU': 8.0, 'node:__internal_head__': 1.0}
globalattack | INFO flwr 2024-11-08 17:25:25,356 | app.py:248 | Optimize your simulation with Flower VCE: https://flower.ai/docs/framework/how-to-run-simulations.html
globalattack | INFO flwr 2024-11-08 17:25:25,356 | app.py:271 | Flower VCE: Resources for each Virtual Client: {'num_cpus': 1, 'num_gpus': 0.2}
globalattack | INFO flwr 2024-11-08 17:25:25,365 | app.py:317 | Flower VCE: Creating VirtualClientEngineActorPool with 5 actors
globalattack | INFO flwr 2024-11-08 17:25:25,366 | server.py:92 | [INIT]
globalattack | INFO flwr 2024-11-08 17:25:25,366 | server.py:281 | Requesting initial parameters from one random client
globalattack | ERROR flwr 2024-11-08 17:25:29,239 | ray_client_proxy.py:106 | Traceback (most recent call last):
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 94, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 398, in get_client_result
    return self._fetch_future_result(cid)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 279, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
                                         ^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=10101, ip=127.0.0.1, actor_id=f1fa8bd34f328363999cb53501000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x105145b10>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/message_handler/message_handler.py", line 95, in handle_legacy_message_from_msgtype
    client = client_fn(context)
             ^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 67, in adaptor_fn
    return client_fn(str(cid))  # type: ignore
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/texas100/globalattack.py", line 205, in client_fn
    client_features = train_features[indices]
                      ~~~~~~~~~~~~~~^^^^^^^^^
IndexError: index 49125 is out of bounds for axis 0 with size 30000

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=10101, ip=127.0.0.1, actor_id=f1fa8bd34f328363999cb53501000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x105145b10>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: index 49125 is out of bounds for axis 0 with size 30000

globalattack | ERROR flwr 2024-11-08 17:25:29,240 | ray_client_proxy.py:107 | [36mray::ClientAppActor.run()[39m (pid=10101, ip=127.0.0.1, actor_id=f1fa8bd34f328363999cb53501000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x105145b10>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/message_handler/message_handler.py", line 95, in handle_legacy_message_from_msgtype
    client = client_fn(context)
             ^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 67, in adaptor_fn
    return client_fn(str(cid))  # type: ignore
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/texas100/globalattack.py", line 205, in client_fn
    client_features = train_features[indices]
                      ~~~~~~~~~~~~~~^^^^^^^^^
IndexError: index 49125 is out of bounds for axis 0 with size 30000

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=10101, ip=127.0.0.1, actor_id=f1fa8bd34f328363999cb53501000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x105145b10>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: index 49125 is out of bounds for axis 0 with size 30000
globalattack | ERROR flwr 2024-11-08 17:25:29,240 | app.py:344 | [36mray::ClientAppActor.run()[39m (pid=10101, ip=127.0.0.1, actor_id=f1fa8bd34f328363999cb53501000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x105145b10>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/message_handler/message_handler.py", line 95, in handle_legacy_message_from_msgtype
    client = client_fn(context)
             ^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 67, in adaptor_fn
    return client_fn(str(cid))  # type: ignore
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/texas100/globalattack.py", line 205, in client_fn
    client_features = train_features[indices]
                      ~~~~~~~~~~~~~~^^^^^^^^^
IndexError: index 49125 is out of bounds for axis 0 with size 30000

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=10101, ip=127.0.0.1, actor_id=f1fa8bd34f328363999cb53501000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x105145b10>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: index 49125 is out of bounds for axis 0 with size 30000
globalattack | ERROR flwr 2024-11-08 17:25:29,241 | app.py:345 | Traceback (most recent call last):
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/app.py", line 339, in start_simulation
    hist = run_fl(
           ^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/server/server.py", line 492, in run_fl
    hist, elapsed_time = server.fit(
                         ^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/server/server.py", line 93, in fit
    self.parameters = self._get_initial_parameters(server_round=0, timeout=timeout)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/server/server.py", line 284, in _get_initial_parameters
    get_parameters_res = random_client.get_parameters(
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 168, in get_parameters
    message_out = self._submit_job(message, timeout)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 108, in _submit_job
    raise ex
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 94, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 398, in get_client_result
    return self._fetch_future_result(cid)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 279, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
                                         ^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=10101, ip=127.0.0.1, actor_id=f1fa8bd34f328363999cb53501000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x105145b10>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/message_handler/message_handler.py", line 95, in handle_legacy_message_from_msgtype
    client = client_fn(context)
             ^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 67, in adaptor_fn
    return client_fn(str(cid))  # type: ignore
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/texas100/globalattack.py", line 205, in client_fn
    client_features = train_features[indices]
                      ~~~~~~~~~~~~~~^^^^^^^^^
IndexError: index 49125 is out of bounds for axis 0 with size 30000

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=10101, ip=127.0.0.1, actor_id=f1fa8bd34f328363999cb53501000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x105145b10>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: index 49125 is out of bounds for axis 0 with size 30000

globalattack | ERROR flwr 2024-11-08 17:25:29,241 | app.py:346 | Your simulation crashed :(. This could be because of several reasons. The most common are: 
	 > Sometimes, issues in the simulation code itself can cause crashes. It's always a good idea to double-check your code for any potential bugs or inconsistencies that might be contributing to the problem. For example: 
		 - You might be using a class attribute in your clients that hasn't been defined.
		 - There could be an incorrect method call to a 3rd party library (e.g., PyTorch).
		 - The return types of methods in your clients/strategies might be incorrect.
	 > Your system couldn't fit a single VirtualClient: try lowering `client_resources`.
	 > All the actors in your pool crashed. This could be because: 
		 - You clients hit an out-of-memory (OOM) error and actors couldn't recover from it. Try launching your simulation with more generous `client_resources` setting (i.e. it seems {'num_cpus': 1, 'num_gpus': 0.2} is not enough for your run). Use fewer concurrent actors. 
		 - You were running a multi-node simulation and all worker nodes disconnected. The head node might still be alive but cannot accommodate any actor with resources: {'num_cpus': 1, 'num_gpus': 0.2}.
Take a look at the Flower simulation examples for guidance <https://flower.ai/docs/framework/how-to-run-simulations.html>.
globalattack | INFO flwr 2024-11-08 17:32:32,750 | app.py:219 | Starting Flower simulation, config: num_rounds=30, no round_timeout
globalattack | INFO flwr 2024-11-08 17:32:34,982 | app.py:242 | Flower VCE: Ray initialized with resources: {'node:__internal_head__': 1.0, 'node:127.0.0.1': 1.0, 'CPU': 8.0, 'object_store_memory': 2147483648.0, 'GPU': 1.0, 'memory': 5803461837.0}
globalattack | INFO flwr 2024-11-08 17:32:34,983 | app.py:248 | Optimize your simulation with Flower VCE: https://flower.ai/docs/framework/how-to-run-simulations.html
globalattack | INFO flwr 2024-11-08 17:32:34,983 | app.py:271 | Flower VCE: Resources for each Virtual Client: {'num_cpus': 1, 'num_gpus': 0.2}
globalattack | INFO flwr 2024-11-08 17:32:34,996 | app.py:317 | Flower VCE: Creating VirtualClientEngineActorPool with 5 actors
globalattack | INFO flwr 2024-11-08 17:32:34,997 | server.py:92 | [INIT]
globalattack | INFO flwr 2024-11-08 17:32:34,997 | server.py:281 | Requesting initial parameters from one random client
globalattack | ERROR flwr 2024-11-08 17:32:39,252 | ray_client_proxy.py:106 | Traceback (most recent call last):
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 94, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 398, in get_client_result
    return self._fetch_future_result(cid)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 279, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
                                         ^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=10182, ip=127.0.0.1, actor_id=3e33007b3c4a96121053a7eb01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x173123110>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/message_handler/message_handler.py", line 95, in handle_legacy_message_from_msgtype
    client = client_fn(context)
             ^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 67, in adaptor_fn
    return client_fn(str(cid))  # type: ignore
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/texas100/globalattack.py", line 198, in client_fn
    return FlowerClient(model, cid, data_loader)
                      ^^^^^^^^^^^^^^^^^^^^^^^
IndexError: index 50423 is out of bounds for axis 0 with size 30000

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=10182, ip=127.0.0.1, actor_id=3e33007b3c4a96121053a7eb01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x173123110>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: index 50423 is out of bounds for axis 0 with size 30000

globalattack | ERROR flwr 2024-11-08 17:32:39,253 | ray_client_proxy.py:107 | [36mray::ClientAppActor.run()[39m (pid=10182, ip=127.0.0.1, actor_id=3e33007b3c4a96121053a7eb01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x173123110>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/message_handler/message_handler.py", line 95, in handle_legacy_message_from_msgtype
    client = client_fn(context)
             ^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 67, in adaptor_fn
    return client_fn(str(cid))  # type: ignore
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/texas100/globalattack.py", line 198, in client_fn
    return FlowerClient(model, cid, data_loader)
                      ^^^^^^^^^^^^^^^^^^^^^^^
IndexError: index 50423 is out of bounds for axis 0 with size 30000

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=10182, ip=127.0.0.1, actor_id=3e33007b3c4a96121053a7eb01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x173123110>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: index 50423 is out of bounds for axis 0 with size 30000
globalattack | ERROR flwr 2024-11-08 17:32:39,253 | app.py:344 | [36mray::ClientAppActor.run()[39m (pid=10182, ip=127.0.0.1, actor_id=3e33007b3c4a96121053a7eb01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x173123110>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/message_handler/message_handler.py", line 95, in handle_legacy_message_from_msgtype
    client = client_fn(context)
             ^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 67, in adaptor_fn
    return client_fn(str(cid))  # type: ignore
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/texas100/globalattack.py", line 198, in client_fn
    return FlowerClient(model, cid, data_loader)
                      ^^^^^^^^^^^^^^^^^^^^^^^
IndexError: index 50423 is out of bounds for axis 0 with size 30000

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=10182, ip=127.0.0.1, actor_id=3e33007b3c4a96121053a7eb01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x173123110>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: index 50423 is out of bounds for axis 0 with size 30000
globalattack | ERROR flwr 2024-11-08 17:32:39,253 | app.py:345 | Traceback (most recent call last):
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/app.py", line 339, in start_simulation
    hist = run_fl(
           ^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/server/server.py", line 492, in run_fl
    hist, elapsed_time = server.fit(
                         ^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/server/server.py", line 93, in fit
    self.parameters = self._get_initial_parameters(server_round=0, timeout=timeout)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/server/server.py", line 284, in _get_initial_parameters
    get_parameters_res = random_client.get_parameters(
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 168, in get_parameters
    message_out = self._submit_job(message, timeout)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 108, in _submit_job
    raise ex
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 94, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 398, in get_client_result
    return self._fetch_future_result(cid)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 279, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
                                         ^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=10182, ip=127.0.0.1, actor_id=3e33007b3c4a96121053a7eb01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x173123110>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/message_handler/message_handler.py", line 95, in handle_legacy_message_from_msgtype
    client = client_fn(context)
             ^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 67, in adaptor_fn
    return client_fn(str(cid))  # type: ignore
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/texas100/globalattack.py", line 198, in client_fn
    return FlowerClient(model, cid, data_loader)
                      ^^^^^^^^^^^^^^^^^^^^^^^
IndexError: index 50423 is out of bounds for axis 0 with size 30000

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=10182, ip=127.0.0.1, actor_id=3e33007b3c4a96121053a7eb01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x173123110>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: index 50423 is out of bounds for axis 0 with size 30000

globalattack | ERROR flwr 2024-11-08 17:32:39,254 | app.py:346 | Your simulation crashed :(. This could be because of several reasons. The most common are: 
	 > Sometimes, issues in the simulation code itself can cause crashes. It's always a good idea to double-check your code for any potential bugs or inconsistencies that might be contributing to the problem. For example: 
		 - You might be using a class attribute in your clients that hasn't been defined.
		 - There could be an incorrect method call to a 3rd party library (e.g., PyTorch).
		 - The return types of methods in your clients/strategies might be incorrect.
	 > Your system couldn't fit a single VirtualClient: try lowering `client_resources`.
	 > All the actors in your pool crashed. This could be because: 
		 - You clients hit an out-of-memory (OOM) error and actors couldn't recover from it. Try launching your simulation with more generous `client_resources` setting (i.e. it seems {'num_cpus': 1, 'num_gpus': 0.2} is not enough for your run). Use fewer concurrent actors. 
		 - You were running a multi-node simulation and all worker nodes disconnected. The head node might still be alive but cannot accommodate any actor with resources: {'num_cpus': 1, 'num_gpus': 0.2}.
Take a look at the Flower simulation examples for guidance <https://flower.ai/docs/framework/how-to-run-simulations.html>.
globalattack | INFO flwr 2024-11-08 17:52:20,951 | app.py:219 | Starting Flower simulation, config: num_rounds=30, no round_timeout
globalattack | INFO flwr 2024-11-08 17:52:23,137 | app.py:242 | Flower VCE: Ray initialized with resources: {'node:127.0.0.1': 1.0, 'memory': 5866233856.0, 'GPU': 1.0, 'object_store_memory': 2147483648.0, 'node:__internal_head__': 1.0, 'CPU': 8.0}
globalattack | INFO flwr 2024-11-08 17:52:23,137 | app.py:248 | Optimize your simulation with Flower VCE: https://flower.ai/docs/framework/how-to-run-simulations.html
globalattack | INFO flwr 2024-11-08 17:52:23,137 | app.py:271 | Flower VCE: Resources for each Virtual Client: {'num_cpus': 1, 'num_gpus': 0.2}
globalattack | INFO flwr 2024-11-08 17:52:23,146 | app.py:317 | Flower VCE: Creating VirtualClientEngineActorPool with 5 actors
globalattack | INFO flwr 2024-11-08 17:52:23,146 | server.py:92 | [INIT]
globalattack | INFO flwr 2024-11-08 17:52:23,146 | server.py:281 | Requesting initial parameters from one random client
globalattack | ERROR flwr 2024-11-08 17:52:27,200 | ray_client_proxy.py:106 | Traceback (most recent call last):
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 94, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 398, in get_client_result
    return self._fetch_future_result(cid)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 279, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
                                         ^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=10308, ip=127.0.0.1, actor_id=4327ea2543eced1ccf25b72701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x165a8fbd0>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/message_handler/message_handler.py", line 95, in handle_legacy_message_from_msgtype
    client = client_fn(context)
             ^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 67, in adaptor_fn
    return client_fn(str(cid))  # type: ignore
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/texas100/globalattack.py", line 203, in client_fn
    client_features = train_features[indices]
                      ~~~~~~~~~~~~~~^^^^^^^^^
IndexError: index 34782 is out of bounds for axis 0 with size 30000

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=10308, ip=127.0.0.1, actor_id=4327ea2543eced1ccf25b72701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x165a8fbd0>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: index 34782 is out of bounds for axis 0 with size 30000

globalattack | ERROR flwr 2024-11-08 17:52:27,201 | ray_client_proxy.py:107 | [36mray::ClientAppActor.run()[39m (pid=10308, ip=127.0.0.1, actor_id=4327ea2543eced1ccf25b72701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x165a8fbd0>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/message_handler/message_handler.py", line 95, in handle_legacy_message_from_msgtype
    client = client_fn(context)
             ^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 67, in adaptor_fn
    return client_fn(str(cid))  # type: ignore
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/texas100/globalattack.py", line 203, in client_fn
    client_features = train_features[indices]
                      ~~~~~~~~~~~~~~^^^^^^^^^
IndexError: index 34782 is out of bounds for axis 0 with size 30000

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=10308, ip=127.0.0.1, actor_id=4327ea2543eced1ccf25b72701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x165a8fbd0>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: index 34782 is out of bounds for axis 0 with size 30000
globalattack | ERROR flwr 2024-11-08 17:52:27,201 | app.py:344 | [36mray::ClientAppActor.run()[39m (pid=10308, ip=127.0.0.1, actor_id=4327ea2543eced1ccf25b72701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x165a8fbd0>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/message_handler/message_handler.py", line 95, in handle_legacy_message_from_msgtype
    client = client_fn(context)
             ^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 67, in adaptor_fn
    return client_fn(str(cid))  # type: ignore
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/texas100/globalattack.py", line 203, in client_fn
    client_features = train_features[indices]
                      ~~~~~~~~~~~~~~^^^^^^^^^
IndexError: index 34782 is out of bounds for axis 0 with size 30000

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=10308, ip=127.0.0.1, actor_id=4327ea2543eced1ccf25b72701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x165a8fbd0>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: index 34782 is out of bounds for axis 0 with size 30000
globalattack | ERROR flwr 2024-11-08 17:52:27,202 | app.py:345 | Traceback (most recent call last):
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/app.py", line 339, in start_simulation
    hist = run_fl(
           ^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/server/server.py", line 492, in run_fl
    hist, elapsed_time = server.fit(
                         ^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/server/server.py", line 93, in fit
    self.parameters = self._get_initial_parameters(server_round=0, timeout=timeout)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/server/server.py", line 284, in _get_initial_parameters
    get_parameters_res = random_client.get_parameters(
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 168, in get_parameters
    message_out = self._submit_job(message, timeout)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 108, in _submit_job
    raise ex
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 94, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 398, in get_client_result
    return self._fetch_future_result(cid)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 279, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
                                         ^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=10308, ip=127.0.0.1, actor_id=4327ea2543eced1ccf25b72701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x165a8fbd0>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/message_handler/message_handler.py", line 95, in handle_legacy_message_from_msgtype
    client = client_fn(context)
             ^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 67, in adaptor_fn
    return client_fn(str(cid))  # type: ignore
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/texas100/globalattack.py", line 203, in client_fn
    client_features = train_features[indices]
                      ~~~~~~~~~~~~~~^^^^^^^^^
IndexError: index 34782 is out of bounds for axis 0 with size 30000

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=10308, ip=127.0.0.1, actor_id=4327ea2543eced1ccf25b72701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x165a8fbd0>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: index 34782 is out of bounds for axis 0 with size 30000

globalattack | ERROR flwr 2024-11-08 17:52:27,202 | app.py:346 | Your simulation crashed :(. This could be because of several reasons. The most common are: 
	 > Sometimes, issues in the simulation code itself can cause crashes. It's always a good idea to double-check your code for any potential bugs or inconsistencies that might be contributing to the problem. For example: 
		 - You might be using a class attribute in your clients that hasn't been defined.
		 - There could be an incorrect method call to a 3rd party library (e.g., PyTorch).
		 - The return types of methods in your clients/strategies might be incorrect.
	 > Your system couldn't fit a single VirtualClient: try lowering `client_resources`.
	 > All the actors in your pool crashed. This could be because: 
		 - You clients hit an out-of-memory (OOM) error and actors couldn't recover from it. Try launching your simulation with more generous `client_resources` setting (i.e. it seems {'num_cpus': 1, 'num_gpus': 0.2} is not enough for your run). Use fewer concurrent actors. 
		 - You were running a multi-node simulation and all worker nodes disconnected. The head node might still be alive but cannot accommodate any actor with resources: {'num_cpus': 1, 'num_gpus': 0.2}.
Take a look at the Flower simulation examples for guidance <https://flower.ai/docs/framework/how-to-run-simulations.html>.
globalattack | INFO flwr 2024-11-08 17:55:04,395 | app.py:219 | Starting Flower simulation, config: num_rounds=30, no round_timeout
globalattack | INFO flwr 2024-11-08 17:55:06,555 | app.py:242 | Flower VCE: Ray initialized with resources: {'GPU': 1.0, 'memory': 5989949440.0, 'CPU': 8.0, 'node:127.0.0.1': 1.0, 'object_store_memory': 2147483648.0, 'node:__internal_head__': 1.0}
globalattack | INFO flwr 2024-11-08 17:55:06,555 | app.py:248 | Optimize your simulation with Flower VCE: https://flower.ai/docs/framework/how-to-run-simulations.html
globalattack | INFO flwr 2024-11-08 17:55:06,555 | app.py:271 | Flower VCE: Resources for each Virtual Client: {'num_cpus': 1, 'num_gpus': 0.2}
globalattack | INFO flwr 2024-11-08 17:55:06,564 | app.py:317 | Flower VCE: Creating VirtualClientEngineActorPool with 5 actors
globalattack | INFO flwr 2024-11-08 17:55:06,564 | server.py:92 | [INIT]
globalattack | INFO flwr 2024-11-08 17:55:06,565 | server.py:281 | Requesting initial parameters from one random client
globalattack | INFO flwr 2024-11-08 17:55:11,163 | server.py:288 | Received initial parameters from one random client
globalattack | INFO flwr 2024-11-08 17:55:11,163 | server.py:94 | Starting evaluation of initial global parameters
globalattack | INFO flwr 2024-11-08 17:55:11,163 | server.py:106 | Evaluation returned no results (`None`)
globalattack | INFO flwr 2024-11-08 17:55:11,163 | server.py:112 | 
globalattack | INFO flwr 2024-11-08 17:55:11,163 | server.py:113 | [ROUND 1]
globalattack | INFO flwr 2024-11-08 17:55:11,164 | server.py:226 | configure_fit: strategy sampled 5 clients (out of 5)
globalattack | INFO flwr 2024-11-08 17:55:27,823 | server.py:240 | aggregate_fit: received 5 results and 0 failures
globalattack | WARNING flwr 2024-11-08 17:55:27,881 | fedavg.py:252 | No fit_metrics_aggregation_fn provided
globalattack | INFO flwr 2024-11-08 17:55:27,881 | server.py:178 | configure_evaluate: strategy sampled 5 clients (out of 5)
globalattack | INFO flwr 2024-11-08 17:55:50,751 | server.py:192 | aggregate_evaluate: received 5 results and 0 failures
globalattack | WARNING flwr 2024-11-08 17:55:50,752 | fedavg.py:283 | No evaluate_metrics_aggregation_fn provided
globalattack | INFO flwr 2024-11-08 17:55:50,752 | server.py:112 | 
globalattack | INFO flwr 2024-11-08 17:55:50,752 | server.py:113 | [ROUND 2]
globalattack | INFO flwr 2024-11-08 17:55:50,752 | server.py:226 | configure_fit: strategy sampled 5 clients (out of 5)
globalattack | INFO flwr 2024-11-08 17:58:04,717 | app.py:219 | Starting Flower simulation, config: num_rounds=30, no round_timeout
globalattack | INFO flwr 2024-11-08 17:58:07,013 | app.py:242 | Flower VCE: Ray initialized with resources: {'CPU': 8.0, 'object_store_memory': 2147483648.0, 'node:127.0.0.1': 1.0, 'node:__internal_head__': 1.0, 'GPU': 1.0, 'memory': 6242806989.0}
globalattack | INFO flwr 2024-11-08 17:58:07,013 | app.py:248 | Optimize your simulation with Flower VCE: https://flower.ai/docs/framework/how-to-run-simulations.html
globalattack | INFO flwr 2024-11-08 17:58:07,013 | app.py:271 | Flower VCE: Resources for each Virtual Client: {'num_cpus': 1, 'num_gpus': 0.2}
globalattack | INFO flwr 2024-11-08 17:58:07,023 | app.py:317 | Flower VCE: Creating VirtualClientEngineActorPool with 5 actors
globalattack | INFO flwr 2024-11-08 17:58:07,023 | server.py:92 | [INIT]
globalattack | INFO flwr 2024-11-08 17:58:07,023 | server.py:281 | Requesting initial parameters from one random client
globalattack | INFO flwr 2024-11-08 17:58:12,279 | server.py:288 | Received initial parameters from one random client
globalattack | INFO flwr 2024-11-08 17:58:12,279 | server.py:94 | Starting evaluation of initial global parameters
globalattack | INFO flwr 2024-11-08 17:58:12,279 | server.py:106 | Evaluation returned no results (`None`)
globalattack | INFO flwr 2024-11-08 17:58:12,279 | server.py:112 | 
globalattack | INFO flwr 2024-11-08 17:58:12,280 | server.py:113 | [ROUND 1]
globalattack | INFO flwr 2024-11-08 17:58:12,291 | server.py:226 | configure_fit: strategy sampled 5 clients (out of 5)
globalattack | INFO flwr 2024-11-09 14:58:03,717 | app.py:219 | Starting Flower simulation, config: num_rounds=30, no round_timeout
globalattack | INFO flwr 2024-11-09 14:58:05,998 | app.py:242 | Flower VCE: Ray initialized with resources: {'object_store_memory': 2147483648.0, 'memory': 6055213466.0, 'GPU': 1.0, 'node:__internal_head__': 1.0, 'node:127.0.0.1': 1.0, 'CPU': 8.0}
globalattack | INFO flwr 2024-11-09 14:58:05,998 | app.py:248 | Optimize your simulation with Flower VCE: https://flower.ai/docs/framework/how-to-run-simulations.html
globalattack | INFO flwr 2024-11-09 14:58:05,998 | app.py:271 | Flower VCE: Resources for each Virtual Client: {'num_cpus': 1, 'num_gpus': 0.2}
globalattack | INFO flwr 2024-11-09 14:58:06,009 | app.py:317 | Flower VCE: Creating VirtualClientEngineActorPool with 5 actors
globalattack | INFO flwr 2024-11-09 14:58:06,009 | server.py:92 | [INIT]
globalattack | INFO flwr 2024-11-09 14:58:06,009 | server.py:281 | Requesting initial parameters from one random client
globalattack | INFO flwr 2024-11-09 14:58:10,971 | server.py:288 | Received initial parameters from one random client
globalattack | INFO flwr 2024-11-09 14:58:10,972 | server.py:94 | Starting evaluation of initial global parameters
globalattack | INFO flwr 2024-11-09 14:58:10,972 | server.py:106 | Evaluation returned no results (`None`)
globalattack | INFO flwr 2024-11-09 14:58:10,972 | server.py:112 | 
globalattack | INFO flwr 2024-11-09 14:58:10,972 | server.py:113 | [ROUND 1]
globalattack | INFO flwr 2024-11-09 14:58:10,973 | server.py:226 | configure_fit: strategy sampled 5 clients (out of 5)
globalattack | INFO flwr 2024-11-09 15:00:49,843 | app.py:219 | Starting Flower simulation, config: num_rounds=30, no round_timeout
globalattack | INFO flwr 2024-11-09 15:00:52,089 | app.py:242 | Flower VCE: Ray initialized with resources: {'object_store_memory': 2147483648.0, 'GPU': 1.0, 'memory': 6030145946.0, 'node:127.0.0.1': 1.0, 'node:__internal_head__': 1.0, 'CPU': 8.0}
globalattack | INFO flwr 2024-11-09 15:00:52,090 | app.py:248 | Optimize your simulation with Flower VCE: https://flower.ai/docs/framework/how-to-run-simulations.html
globalattack | INFO flwr 2024-11-09 15:00:52,090 | app.py:271 | Flower VCE: Resources for each Virtual Client: {'num_cpus': 1, 'num_gpus': 0.2}
globalattack | INFO flwr 2024-11-09 15:00:52,103 | app.py:317 | Flower VCE: Creating VirtualClientEngineActorPool with 5 actors
globalattack | INFO flwr 2024-11-09 15:00:52,103 | server.py:92 | [INIT]
globalattack | INFO flwr 2024-11-09 15:00:52,103 | server.py:281 | Requesting initial parameters from one random client
globalattack | INFO flwr 2024-11-09 15:00:57,412 | server.py:288 | Received initial parameters from one random client
globalattack | INFO flwr 2024-11-09 15:00:57,413 | server.py:94 | Starting evaluation of initial global parameters
globalattack | INFO flwr 2024-11-09 15:00:57,414 | server.py:106 | Evaluation returned no results (`None`)
globalattack | INFO flwr 2024-11-09 15:00:57,414 | server.py:112 | 
globalattack | INFO flwr 2024-11-09 15:00:57,414 | server.py:113 | [ROUND 1]
globalattack | INFO flwr 2024-11-09 15:00:57,415 | server.py:226 | configure_fit: strategy sampled 5 clients (out of 5)
globalattack | INFO flwr 2024-11-09 15:02:47,177 | server.py:240 | aggregate_fit: received 5 results and 0 failures
globalattack | WARNING flwr 2024-11-09 15:02:47,226 | fedavg.py:252 | No fit_metrics_aggregation_fn provided
globalattack | INFO flwr 2024-11-09 15:02:47,227 | server.py:178 | configure_evaluate: strategy sampled 5 clients (out of 5)
globalattack | INFO flwr 2024-11-09 15:03:00,337 | server.py:192 | aggregate_evaluate: received 5 results and 0 failures
globalattack | WARNING flwr 2024-11-09 15:03:00,337 | fedavg.py:283 | No evaluate_metrics_aggregation_fn provided
globalattack | INFO flwr 2024-11-09 15:03:00,337 | server.py:112 | 
globalattack | INFO flwr 2024-11-09 15:03:00,337 | server.py:113 | [ROUND 2]
globalattack | INFO flwr 2024-11-09 15:03:00,337 | server.py:226 | configure_fit: strategy sampled 5 clients (out of 5)
globalattack | INFO flwr 2024-11-09 15:04:29,161 | app.py:219 | Starting Flower simulation, config: num_rounds=1, no round_timeout
globalattack | INFO flwr 2024-11-09 15:04:31,298 | app.py:242 | Flower VCE: Ray initialized with resources: {'memory': 6058663936.0, 'GPU': 1.0, 'object_store_memory': 2147483648.0, 'node:__internal_head__': 1.0, 'CPU': 8.0, 'node:127.0.0.1': 1.0}
globalattack | INFO flwr 2024-11-09 15:04:31,298 | app.py:248 | Optimize your simulation with Flower VCE: https://flower.ai/docs/framework/how-to-run-simulations.html
globalattack | INFO flwr 2024-11-09 15:04:31,298 | app.py:271 | Flower VCE: Resources for each Virtual Client: {'num_cpus': 1, 'num_gpus': 0.2}
globalattack | INFO flwr 2024-11-09 15:04:31,307 | app.py:317 | Flower VCE: Creating VirtualClientEngineActorPool with 5 actors
globalattack | INFO flwr 2024-11-09 15:04:31,307 | server.py:92 | [INIT]
globalattack | INFO flwr 2024-11-09 15:04:31,308 | server.py:281 | Requesting initial parameters from one random client
globalattack | INFO flwr 2024-11-09 15:04:36,248 | server.py:288 | Received initial parameters from one random client
globalattack | INFO flwr 2024-11-09 15:04:36,248 | server.py:94 | Starting evaluation of initial global parameters
globalattack | INFO flwr 2024-11-09 15:04:36,248 | server.py:106 | Evaluation returned no results (`None`)
globalattack | INFO flwr 2024-11-09 15:04:36,249 | server.py:112 | 
globalattack | INFO flwr 2024-11-09 15:04:36,249 | server.py:113 | [ROUND 1]
globalattack | INFO flwr 2024-11-09 15:04:36,249 | server.py:226 | configure_fit: strategy sampled 5 clients (out of 5)
globalattack | INFO flwr 2024-11-09 15:06:22,655 | server.py:240 | aggregate_fit: received 5 results and 0 failures
globalattack | WARNING flwr 2024-11-09 15:06:23,033 | fedavg.py:252 | No fit_metrics_aggregation_fn provided
globalattack | INFO flwr 2024-11-09 15:06:23,043 | server.py:178 | configure_evaluate: strategy sampled 5 clients (out of 5)
globalattack | INFO flwr 2024-11-09 15:06:35,550 | server.py:192 | aggregate_evaluate: received 5 results and 0 failures
globalattack | WARNING flwr 2024-11-09 15:06:35,550 | fedavg.py:283 | No evaluate_metrics_aggregation_fn provided
globalattack | INFO flwr 2024-11-09 15:06:35,558 | server.py:496 | 
globalattack | INFO flwr 2024-11-09 15:06:35,558 | server.py:497 | [SUMMARY]
globalattack | INFO flwr 2024-11-09 15:06:35,558 | server.py:498 | Run finished 1 round(s) in 119.30s
globalattack | INFO flwr 2024-11-09 15:06:35,558 | server.py:500 | 	History (loss, distributed):
globalattack | INFO flwr 2024-11-09 15:06:35,559 | server.py:500 | 		round 1: 0.2367
globalattack | INFO flwr 2024-11-09 15:06:35,559 | server.py:501 | 
globalattack | INFO flwr 2024-11-09 15:09:20,528 | app.py:219 | Starting Flower simulation, config: num_rounds=2, no round_timeout
globalattack | INFO flwr 2024-11-09 15:09:22,663 | app.py:242 | Flower VCE: Ray initialized with resources: {'GPU': 1.0, 'memory': 5348324148.0, 'node:127.0.0.1': 1.0, 'node:__internal_head__': 1.0, 'object_store_memory': 2147483648.0, 'CPU': 8.0}
globalattack | INFO flwr 2024-11-09 15:09:22,663 | app.py:248 | Optimize your simulation with Flower VCE: https://flower.ai/docs/framework/how-to-run-simulations.html
globalattack | INFO flwr 2024-11-09 15:09:22,663 | app.py:271 | Flower VCE: Resources for each Virtual Client: {'num_cpus': 1, 'num_gpus': 0.2}
globalattack | INFO flwr 2024-11-09 15:09:22,671 | app.py:317 | Flower VCE: Creating VirtualClientEngineActorPool with 5 actors
globalattack | INFO flwr 2024-11-09 15:09:22,671 | server.py:92 | [INIT]
globalattack | INFO flwr 2024-11-09 15:09:22,671 | server.py:281 | Requesting initial parameters from one random client
globalattack | INFO flwr 2024-11-09 15:09:27,494 | server.py:288 | Received initial parameters from one random client
globalattack | INFO flwr 2024-11-09 15:09:27,494 | server.py:94 | Starting evaluation of initial global parameters
globalattack | INFO flwr 2024-11-09 15:09:27,494 | server.py:106 | Evaluation returned no results (`None`)
globalattack | INFO flwr 2024-11-09 15:09:27,494 | server.py:112 | 
globalattack | INFO flwr 2024-11-09 15:09:27,494 | server.py:113 | [ROUND 1]
globalattack | INFO flwr 2024-11-09 15:09:27,495 | server.py:226 | configure_fit: strategy sampled 5 clients (out of 5)
globalattack | INFO flwr 2024-11-09 15:11:06,064 | server.py:240 | aggregate_fit: received 5 results and 0 failures
globalattack | WARNING flwr 2024-11-09 15:11:06,116 | fedavg.py:252 | No fit_metrics_aggregation_fn provided
globalattack | INFO flwr 2024-11-09 15:11:06,117 | server.py:178 | configure_evaluate: strategy sampled 5 clients (out of 5)
globalattack | INFO flwr 2024-11-09 15:11:18,665 | server.py:192 | aggregate_evaluate: received 5 results and 0 failures
globalattack | WARNING flwr 2024-11-09 15:11:18,665 | fedavg.py:283 | No evaluate_metrics_aggregation_fn provided
globalattack | INFO flwr 2024-11-09 15:11:18,666 | server.py:112 | 
globalattack | INFO flwr 2024-11-09 15:11:18,666 | server.py:113 | [ROUND 2]
globalattack | INFO flwr 2024-11-09 15:11:18,666 | server.py:226 | configure_fit: strategy sampled 5 clients (out of 5)
globalattack | INFO flwr 2024-11-09 15:13:08,148 | server.py:240 | aggregate_fit: received 5 results and 0 failures
globalattack | INFO flwr 2024-11-09 15:13:08,237 | server.py:178 | configure_evaluate: strategy sampled 5 clients (out of 5)
globalattack | INFO flwr 2024-11-09 15:13:21,060 | server.py:192 | aggregate_evaluate: received 5 results and 0 failures
globalattack | INFO flwr 2024-11-09 15:13:21,069 | server.py:496 | 
globalattack | INFO flwr 2024-11-09 15:13:21,069 | server.py:497 | [SUMMARY]
globalattack | INFO flwr 2024-11-09 15:13:21,069 | server.py:498 | Run finished 2 round(s) in 233.57s
globalattack | INFO flwr 2024-11-09 15:13:21,069 | server.py:500 | 	History (loss, distributed):
globalattack | INFO flwr 2024-11-09 15:13:21,069 | server.py:500 | 		round 1: 0.23796666666666666
globalattack | INFO flwr 2024-11-09 15:13:21,069 | server.py:500 | 		round 2: 0.47036666666666666
globalattack | INFO flwr 2024-11-09 15:13:21,069 | server.py:501 | 
globalattack | INFO flwr 2024-11-09 15:15:20,491 | app.py:219 | Starting Flower simulation, config: num_rounds=2, no round_timeout
globalattack | INFO flwr 2024-11-09 15:15:22,779 | app.py:242 | Flower VCE: Ray initialized with resources: {'node:__internal_head__': 1.0, 'memory': 5474089370.0, 'GPU': 1.0, 'CPU': 8.0, 'object_store_memory': 2147483648.0, 'node:127.0.0.1': 1.0}
globalattack | INFO flwr 2024-11-09 15:15:22,779 | app.py:248 | Optimize your simulation with Flower VCE: https://flower.ai/docs/framework/how-to-run-simulations.html
globalattack | INFO flwr 2024-11-09 15:15:22,779 | app.py:271 | Flower VCE: Resources for each Virtual Client: {'num_cpus': 1, 'num_gpus': 0.2}
globalattack | INFO flwr 2024-11-09 15:15:22,789 | app.py:317 | Flower VCE: Creating VirtualClientEngineActorPool with 5 actors
globalattack | INFO flwr 2024-11-09 15:15:22,789 | server.py:92 | [INIT]
globalattack | INFO flwr 2024-11-09 15:15:22,789 | server.py:281 | Requesting initial parameters from one random client
globalattack | INFO flwr 2024-11-09 15:15:27,727 | server.py:288 | Received initial parameters from one random client
globalattack | INFO flwr 2024-11-09 15:15:27,727 | server.py:94 | Starting evaluation of initial global parameters
globalattack | INFO flwr 2024-11-09 15:15:27,727 | server.py:106 | Evaluation returned no results (`None`)
globalattack | INFO flwr 2024-11-09 15:15:27,727 | server.py:112 | 
globalattack | INFO flwr 2024-11-09 15:15:27,727 | server.py:113 | [ROUND 1]
globalattack | INFO flwr 2024-11-09 15:15:27,728 | server.py:226 | configure_fit: strategy sampled 5 clients (out of 5)
globalattack | INFO flwr 2024-11-09 15:17:08,900 | server.py:240 | aggregate_fit: received 5 results and 0 failures
globalattack | WARNING flwr 2024-11-09 15:17:08,965 | fedavg.py:252 | No fit_metrics_aggregation_fn provided
globalattack | INFO flwr 2024-11-09 15:17:08,967 | server.py:178 | configure_evaluate: strategy sampled 5 clients (out of 5)
globalattack | INFO flwr 2024-11-09 15:17:22,572 | server.py:192 | aggregate_evaluate: received 5 results and 0 failures
globalattack | WARNING flwr 2024-11-09 15:17:22,572 | fedavg.py:283 | No evaluate_metrics_aggregation_fn provided
globalattack | INFO flwr 2024-11-09 15:17:22,572 | server.py:112 | 
globalattack | INFO flwr 2024-11-09 15:17:22,572 | server.py:113 | [ROUND 2]
globalattack | INFO flwr 2024-11-09 15:17:22,572 | server.py:226 | configure_fit: strategy sampled 5 clients (out of 5)
globalattack | INFO flwr 2024-11-09 15:19:02,751 | server.py:240 | aggregate_fit: received 5 results and 0 failures
globalattack | INFO flwr 2024-11-09 15:19:02,812 | server.py:178 | configure_evaluate: strategy sampled 5 clients (out of 5)
globalattack | INFO flwr 2024-11-09 15:19:15,329 | server.py:192 | aggregate_evaluate: received 5 results and 0 failures
globalattack | INFO flwr 2024-11-09 15:19:15,339 | server.py:496 | 
globalattack | INFO flwr 2024-11-09 15:19:15,340 | server.py:497 | [SUMMARY]
globalattack | INFO flwr 2024-11-09 15:19:15,340 | server.py:498 | Run finished 2 round(s) in 227.60s
globalattack | INFO flwr 2024-11-09 15:19:15,340 | server.py:500 | 	History (loss, distributed):
globalattack | INFO flwr 2024-11-09 15:19:15,340 | server.py:500 | 		round 1: 0.3031333333333333
globalattack | INFO flwr 2024-11-09 15:19:15,340 | server.py:500 | 		round 2: 0.45553333333333335
globalattack | INFO flwr 2024-11-09 15:19:15,340 | server.py:501 | 
globalattack | INFO flwr 2024-11-09 15:19:15,340 | globalattack.py:127 | No bias differences to analyze in `all_bias_diffs`.
globalattack | INFO flwr 2024-11-09 15:32:24,006 | app.py:219 | Starting Flower simulation, config: num_rounds=2, no round_timeout
globalattack | INFO flwr 2024-11-09 15:32:26,251 | app.py:242 | Flower VCE: Ray initialized with resources: {'CPU': 8.0, 'GPU': 1.0, 'memory': 5398532916.0, 'object_store_memory': 2147483648.0, 'node:127.0.0.1': 1.0, 'node:__internal_head__': 1.0}
globalattack | INFO flwr 2024-11-09 15:32:26,252 | app.py:248 | Optimize your simulation with Flower VCE: https://flower.ai/docs/framework/how-to-run-simulations.html
globalattack | INFO flwr 2024-11-09 15:32:26,252 | app.py:271 | Flower VCE: Resources for each Virtual Client: {'num_cpus': 1, 'num_gpus': 0.2}
globalattack | INFO flwr 2024-11-09 15:32:26,262 | app.py:317 | Flower VCE: Creating VirtualClientEngineActorPool with 5 actors
globalattack | INFO flwr 2024-11-09 15:32:26,262 | server.py:92 | [INIT]
globalattack | INFO flwr 2024-11-09 15:32:26,263 | server.py:281 | Requesting initial parameters from one random client
globalattack | INFO flwr 2024-11-09 15:32:31,476 | server.py:288 | Received initial parameters from one random client
globalattack | INFO flwr 2024-11-09 15:32:31,476 | server.py:94 | Starting evaluation of initial global parameters
globalattack | INFO flwr 2024-11-09 15:32:31,476 | server.py:106 | Evaluation returned no results (`None`)
globalattack | INFO flwr 2024-11-09 15:32:31,476 | server.py:112 | 
globalattack | INFO flwr 2024-11-09 15:32:31,476 | server.py:113 | [ROUND 1]
globalattack | INFO flwr 2024-11-09 15:32:31,477 | server.py:226 | configure_fit: strategy sampled 5 clients (out of 5)
globalattack | INFO flwr 2024-11-09 15:34:34,643 | app.py:219 | Starting Flower simulation, config: num_rounds=2, no round_timeout
globalattack | INFO flwr 2024-11-09 15:34:36,928 | app.py:242 | Flower VCE: Ray initialized with resources: {'memory': 6299651277.0, 'GPU': 1.0, 'node:127.0.0.1': 1.0, 'object_store_memory': 2147483648.0, 'CPU': 8.0, 'node:__internal_head__': 1.0}
globalattack | INFO flwr 2024-11-09 15:34:36,928 | app.py:248 | Optimize your simulation with Flower VCE: https://flower.ai/docs/framework/how-to-run-simulations.html
globalattack | INFO flwr 2024-11-09 15:34:36,928 | app.py:271 | Flower VCE: Resources for each Virtual Client: {'num_cpus': 1, 'num_gpus': 0.2}
globalattack | INFO flwr 2024-11-09 15:34:36,939 | app.py:317 | Flower VCE: Creating VirtualClientEngineActorPool with 5 actors
globalattack | INFO flwr 2024-11-09 15:34:36,940 | server.py:92 | [INIT]
globalattack | INFO flwr 2024-11-09 15:34:36,940 | server.py:281 | Requesting initial parameters from one random client
globalattack | INFO flwr 2024-11-09 15:34:42,215 | server.py:288 | Received initial parameters from one random client
globalattack | INFO flwr 2024-11-09 15:34:42,216 | server.py:94 | Starting evaluation of initial global parameters
globalattack | INFO flwr 2024-11-09 15:34:42,216 | server.py:106 | Evaluation returned no results (`None`)
globalattack | INFO flwr 2024-11-09 15:34:42,216 | server.py:112 | 
globalattack | INFO flwr 2024-11-09 15:34:42,216 | server.py:113 | [ROUND 1]
globalattack | INFO flwr 2024-11-09 15:34:42,217 | server.py:226 | configure_fit: strategy sampled 5 clients (out of 5)
globalattack | INFO flwr 2024-11-09 15:36:25,255 | server.py:240 | aggregate_fit: received 5 results and 0 failures
globalattack | WARNING flwr 2024-11-09 15:36:25,307 | fedavg.py:252 | No fit_metrics_aggregation_fn provided
globalattack | INFO flwr 2024-11-09 15:36:25,307 | server.py:178 | configure_evaluate: strategy sampled 5 clients (out of 5)
globalattack | INFO flwr 2024-11-09 15:36:39,113 | server.py:192 | aggregate_evaluate: received 5 results and 0 failures
globalattack | WARNING flwr 2024-11-09 15:36:39,113 | fedavg.py:283 | No evaluate_metrics_aggregation_fn provided
globalattack | INFO flwr 2024-11-09 15:36:39,113 | server.py:112 | 
globalattack | INFO flwr 2024-11-09 15:36:39,113 | server.py:113 | [ROUND 2]
globalattack | INFO flwr 2024-11-09 15:36:39,113 | server.py:226 | configure_fit: strategy sampled 5 clients (out of 5)
globalattack | INFO flwr 2024-11-09 15:38:23,442 | server.py:240 | aggregate_fit: received 5 results and 0 failures
globalattack | INFO flwr 2024-11-09 15:38:23,511 | server.py:178 | configure_evaluate: strategy sampled 5 clients (out of 5)
globalattack | INFO flwr 2024-11-09 15:38:37,705 | server.py:192 | aggregate_evaluate: received 5 results and 0 failures
globalattack | INFO flwr 2024-11-09 15:38:37,717 | server.py:496 | 
globalattack | INFO flwr 2024-11-09 15:38:37,717 | server.py:497 | [SUMMARY]
globalattack | INFO flwr 2024-11-09 15:38:37,717 | server.py:498 | Run finished 2 round(s) in 235.49s
globalattack | INFO flwr 2024-11-09 15:38:37,717 | server.py:500 | 	History (loss, distributed):
globalattack | INFO flwr 2024-11-09 15:38:37,717 | server.py:500 | 		round 1: 0.22783333333333333
globalattack | INFO flwr 2024-11-09 15:38:37,717 | server.py:500 | 		round 2: 0.4576
globalattack | INFO flwr 2024-11-09 15:38:37,717 | server.py:501 | 
globalattack | INFO flwr 2024-11-09 15:39:42,860 | app.py:219 | Starting Flower simulation, config: num_rounds=2, no round_timeout
globalattack | INFO flwr 2024-11-09 15:39:45,241 | app.py:242 | Flower VCE: Ray initialized with resources: {'object_store_memory': 2147483648.0, 'memory': 5305473434.0, 'GPU': 1.0, 'CPU': 8.0, 'node:127.0.0.1': 1.0, 'node:__internal_head__': 1.0}
globalattack | INFO flwr 2024-11-09 15:39:45,242 | app.py:248 | Optimize your simulation with Flower VCE: https://flower.ai/docs/framework/how-to-run-simulations.html
globalattack | INFO flwr 2024-11-09 15:39:45,242 | app.py:271 | Flower VCE: Resources for each Virtual Client: {'num_cpus': 1, 'num_gpus': 0.2}
globalattack | INFO flwr 2024-11-09 15:39:45,252 | app.py:317 | Flower VCE: Creating VirtualClientEngineActorPool with 5 actors
globalattack | INFO flwr 2024-11-09 15:39:45,253 | server.py:92 | [INIT]
globalattack | INFO flwr 2024-11-09 15:39:45,253 | server.py:281 | Requesting initial parameters from one random client
globalattack | INFO flwr 2024-11-09 15:39:50,600 | server.py:288 | Received initial parameters from one random client
globalattack | INFO flwr 2024-11-09 15:39:50,601 | server.py:94 | Starting evaluation of initial global parameters
globalattack | INFO flwr 2024-11-09 15:39:50,601 | server.py:106 | Evaluation returned no results (`None`)
globalattack | INFO flwr 2024-11-09 15:39:50,601 | server.py:112 | 
globalattack | INFO flwr 2024-11-09 15:39:50,601 | server.py:113 | [ROUND 1]
globalattack | INFO flwr 2024-11-09 15:39:50,601 | server.py:226 | configure_fit: strategy sampled 5 clients (out of 5)
globalattack | INFO flwr 2024-11-09 15:41:34,406 | server.py:240 | aggregate_fit: received 5 results and 0 failures
globalattack | WARNING flwr 2024-11-09 15:41:34,463 | fedavg.py:252 | No fit_metrics_aggregation_fn provided
globalattack | INFO flwr 2024-11-09 15:41:34,463 | server.py:178 | configure_evaluate: strategy sampled 5 clients (out of 5)
globalattack | INFO flwr 2024-11-09 15:41:47,048 | server.py:192 | aggregate_evaluate: received 5 results and 0 failures
globalattack | WARNING flwr 2024-11-09 15:41:47,048 | fedavg.py:283 | No evaluate_metrics_aggregation_fn provided
globalattack | INFO flwr 2024-11-09 15:41:47,048 | server.py:112 | 
globalattack | INFO flwr 2024-11-09 15:41:47,048 | server.py:113 | [ROUND 2]
globalattack | INFO flwr 2024-11-09 15:41:47,049 | server.py:226 | configure_fit: strategy sampled 5 clients (out of 5)
globalattack | INFO flwr 2024-11-09 15:43:31,216 | server.py:240 | aggregate_fit: received 5 results and 0 failures
globalattack | INFO flwr 2024-11-09 15:43:31,278 | server.py:178 | configure_evaluate: strategy sampled 5 clients (out of 5)
globalattack | INFO flwr 2024-11-09 15:43:45,272 | server.py:192 | aggregate_evaluate: received 5 results and 0 failures
globalattack | INFO flwr 2024-11-09 15:43:45,280 | server.py:496 | 
globalattack | INFO flwr 2024-11-09 15:43:45,280 | server.py:497 | [SUMMARY]
globalattack | INFO flwr 2024-11-09 15:43:45,280 | server.py:498 | Run finished 2 round(s) in 234.67s
globalattack | INFO flwr 2024-11-09 15:43:45,280 | server.py:500 | 	History (loss, distributed):
globalattack | INFO flwr 2024-11-09 15:43:45,281 | server.py:500 | 		round 1: 0.22073333333333334
globalattack | INFO flwr 2024-11-09 15:43:45,281 | server.py:500 | 		round 2: 0.48646666666666666
globalattack | INFO flwr 2024-11-09 15:43:45,281 | server.py:501 | 
globalattack | INFO flwr 2024-11-09 15:43:45,281 | globalattack.py:139 | No bias differences to analyze in `all_bias_diffs`.
federated | INFO flwr 2024-11-11 15:18:42,251 | app.py:219 | Starting Flower simulation, config: num_rounds=10, no round_timeout
federated | INFO flwr 2024-11-11 15:18:44,570 | app.py:242 | Flower VCE: Ray initialized with resources: {'node:127.0.0.1': 1.0, 'GPU': 1.0, 'memory': 7831040820.0, 'node:__internal_head__': 1.0, 'object_store_memory': 2147483648.0, 'CPU': 8.0}
federated | INFO flwr 2024-11-11 15:18:44,570 | app.py:248 | Optimize your simulation with Flower VCE: https://flower.ai/docs/framework/how-to-run-simulations.html
federated | INFO flwr 2024-11-11 15:18:44,570 | app.py:271 | Flower VCE: Resources for each Virtual Client: {'num_cpus': 1, 'num_gpus': 0.2}
federated | INFO flwr 2024-11-11 15:18:44,581 | app.py:317 | Flower VCE: Creating VirtualClientEngineActorPool with 5 actors
federated | INFO flwr 2024-11-11 15:18:44,581 | server.py:92 | [INIT]
federated | INFO flwr 2024-11-11 15:18:44,582 | server.py:281 | Requesting initial parameters from one random client
federated | INFO flwr 2024-11-11 15:19:11,675 | app.py:219 | Starting Flower simulation, config: num_rounds=10, no round_timeout
federated | INFO flwr 2024-11-11 15:19:14,837 | app.py:242 | Flower VCE: Ray initialized with resources: {'node:__internal_head__': 1.0, 'GPU': 1.0, 'memory': 7931163444.0, 'node:127.0.0.1': 1.0, 'CPU': 8.0, 'object_store_memory': 2147483648.0}
federated | INFO flwr 2024-11-11 15:19:14,837 | app.py:248 | Optimize your simulation with Flower VCE: https://flower.ai/docs/framework/how-to-run-simulations.html
federated | INFO flwr 2024-11-11 15:19:14,837 | app.py:271 | Flower VCE: Resources for each Virtual Client: {'num_cpus': 1, 'num_gpus': 0.2}
federated | INFO flwr 2024-11-11 15:19:14,845 | app.py:317 | Flower VCE: Creating VirtualClientEngineActorPool with 5 actors
federated | INFO flwr 2024-11-11 15:19:14,846 | server.py:92 | [INIT]
federated | INFO flwr 2024-11-11 15:19:14,846 | server.py:281 | Requesting initial parameters from one random client
federated | INFO flwr 2024-11-11 15:19:42,438 | server.py:288 | Received initial parameters from one random client
federated | INFO flwr 2024-11-11 15:19:42,438 | server.py:94 | Starting evaluation of initial global parameters
federated | INFO flwr 2024-11-11 15:19:46,042 | target_train.py:200 | Round 0 - Centralized evaluation accuracy: 0.0326, loss: 4.605174877929688
federated | INFO flwr 2024-11-11 15:19:46,044 | server.py:97 | initial parameters (loss, other metrics): 4.605174877929688, {'accuracy': 0.0326}
federated | INFO flwr 2024-11-11 15:19:46,044 | server.py:112 | 
federated | INFO flwr 2024-11-11 15:19:46,044 | server.py:113 | [ROUND 1]
federated | INFO flwr 2024-11-11 15:19:46,044 | server.py:226 | configure_fit: strategy sampled 5 clients (out of 5)
federated | INFO flwr 2024-11-11 15:24:26,837 | app.py:219 | Starting Flower simulation, config: num_rounds=10, no round_timeout
federated | INFO flwr 2024-11-11 15:24:29,057 | app.py:242 | Flower VCE: Ray initialized with resources: {'memory': 6147697869.0, 'GPU': 1.0, 'node:127.0.0.1': 1.0, 'CPU': 8.0, 'object_store_memory': 2147483648.0, 'node:__internal_head__': 1.0}
federated | INFO flwr 2024-11-11 15:24:29,057 | app.py:248 | Optimize your simulation with Flower VCE: https://flower.ai/docs/framework/how-to-run-simulations.html
federated | INFO flwr 2024-11-11 15:24:29,057 | app.py:271 | Flower VCE: Resources for each Virtual Client: {'num_cpus': 1, 'num_gpus': 0.2}
federated | INFO flwr 2024-11-11 15:24:29,065 | app.py:317 | Flower VCE: Creating VirtualClientEngineActorPool with 5 actors
federated | INFO flwr 2024-11-11 15:24:29,065 | server.py:92 | [INIT]
federated | INFO flwr 2024-11-11 15:24:29,065 | server.py:281 | Requesting initial parameters from one random client
federated | INFO flwr 2024-11-11 15:24:54,216 | server.py:288 | Received initial parameters from one random client
federated | INFO flwr 2024-11-11 15:24:54,217 | server.py:94 | Starting evaluation of initial global parameters
federated | INFO flwr 2024-11-11 15:24:57,509 | target_train.py:199 | Round 0 - Centralized evaluation accuracy: 0.007366666666666666, loss: 4.605174496459961
federated | INFO flwr 2024-11-11 15:24:57,510 | server.py:97 | initial parameters (loss, other metrics): 4.605174496459961, {'accuracy': 0.007366666666666666}
federated | INFO flwr 2024-11-11 15:24:57,511 | server.py:112 | 
federated | INFO flwr 2024-11-11 15:24:57,511 | server.py:113 | [ROUND 1]
federated | INFO flwr 2024-11-11 15:24:57,511 | server.py:226 | configure_fit: strategy sampled 5 clients (out of 5)
federated | INFO flwr 2024-11-11 15:25:43,218 | app.py:219 | Starting Flower simulation, config: num_rounds=10, no round_timeout
federated | INFO flwr 2024-11-11 15:25:45,371 | app.py:242 | Flower VCE: Ray initialized with resources: {'node:__internal_head__': 1.0, 'node:127.0.0.1': 1.0, 'CPU': 8.0, 'object_store_memory': 2147483648.0, 'memory': 6950433588.0, 'GPU': 1.0}
federated | INFO flwr 2024-11-11 15:25:45,371 | app.py:248 | Optimize your simulation with Flower VCE: https://flower.ai/docs/framework/how-to-run-simulations.html
federated | INFO flwr 2024-11-11 15:25:45,371 | app.py:271 | Flower VCE: Resources for each Virtual Client: {'num_cpus': 1, 'num_gpus': 0.2}
federated | INFO flwr 2024-11-11 15:25:45,380 | app.py:317 | Flower VCE: Creating VirtualClientEngineActorPool with 5 actors
federated | INFO flwr 2024-11-11 15:25:45,380 | server.py:92 | [INIT]
federated | INFO flwr 2024-11-11 15:25:45,380 | server.py:281 | Requesting initial parameters from one random client
federated | INFO flwr 2024-11-11 15:26:10,610 | server.py:288 | Received initial parameters from one random client
federated | INFO flwr 2024-11-11 15:26:10,610 | server.py:94 | Starting evaluation of initial global parameters
federated | INFO flwr 2024-11-11 15:26:14,457 | target_train.py:198 | Round 0 - Centralized evaluation accuracy: 0.004333333333333333, loss: 4.605159247589111
federated | INFO flwr 2024-11-11 15:26:14,459 | server.py:97 | initial parameters (loss, other metrics): 4.605159247589111, {'accuracy': 0.004333333333333333}
federated | INFO flwr 2024-11-11 15:26:14,459 | server.py:112 | 
federated | INFO flwr 2024-11-11 15:26:14,459 | server.py:113 | [ROUND 1]
federated | INFO flwr 2024-11-11 15:26:14,459 | server.py:226 | configure_fit: strategy sampled 5 clients (out of 5)
federated | INFO flwr 2024-11-11 15:41:43,954 | app.py:219 | Starting Flower simulation, config: num_rounds=2, no round_timeout
federated | INFO flwr 2024-11-11 15:41:50,976 | app.py:219 | Starting Flower simulation, config: num_rounds=2, no round_timeout
federated | INFO flwr 2024-11-11 15:41:53,052 | app.py:242 | Flower VCE: Ray initialized with resources: {'memory': 6605519258.0, 'GPU': 1.0, 'CPU': 8.0, 'node:__internal_head__': 1.0, 'node:127.0.0.1': 1.0, 'object_store_memory': 2147483648.0}
federated | INFO flwr 2024-11-11 15:41:53,052 | app.py:248 | Optimize your simulation with Flower VCE: https://flower.ai/docs/framework/how-to-run-simulations.html
federated | INFO flwr 2024-11-11 15:41:53,052 | app.py:271 | Flower VCE: Resources for each Virtual Client: {'num_cpus': 1, 'num_gpus': 0.2}
federated | INFO flwr 2024-11-11 15:41:53,062 | app.py:317 | Flower VCE: Creating VirtualClientEngineActorPool with 5 actors
federated | INFO flwr 2024-11-11 15:41:53,062 | server.py:92 | [INIT]
federated | INFO flwr 2024-11-11 15:41:53,062 | server.py:281 | Requesting initial parameters from one random client
federated | INFO flwr 2024-11-11 15:42:10,222 | server.py:288 | Received initial parameters from one random client
federated | INFO flwr 2024-11-11 15:42:10,222 | server.py:94 | Starting evaluation of initial global parameters
federated | INFO flwr 2024-11-11 15:42:11,169 | target_train.py:198 | Round 0 - Centralized evaluation accuracy: 0.013666666666666667, loss: 4.605201985677083
federated | INFO flwr 2024-11-11 15:42:11,170 | server.py:97 | initial parameters (loss, other metrics): 4.605201985677083, {'accuracy': 0.013666666666666667}
federated | INFO flwr 2024-11-11 15:42:11,170 | server.py:112 | 
federated | INFO flwr 2024-11-11 15:42:11,170 | server.py:113 | [ROUND 1]
federated | INFO flwr 2024-11-11 15:42:11,170 | server.py:226 | configure_fit: strategy sampled 5 clients (out of 5)
federated | ERROR flwr 2024-11-11 15:43:51,042 | ray_client_proxy.py:106 | Traceback (most recent call last):
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 94, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 398, in get_client_result
    return self._fetch_future_result(cid)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 279, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
                                         ^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=35413, ip=127.0.0.1, actor_id=fe027926a08284f9f435a31701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x102ef2410>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/message_handler/message_handler.py", line 129, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
              ^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client.py", line 255, in maybe_call_fit
    return client.fit(fit_ins)
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 259, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/texas100/target_train.py", line 167, in fit
    torch.save(self.global_model_snapshots, f"client_{self.client_id}_global_snapshots_round_{config['round_number']}.pth")
                                                                                              ~~~~~~^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/common/record/typeddict.py", line 50, in __getitem__
    return cast(dict[K, V], self.__dict__["_data"])[item]
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
KeyError: 'round_number'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=35413, ip=127.0.0.1, actor_id=fe027926a08284f9f435a31701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x102ef2410>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'round_number'

federated | ERROR flwr 2024-11-11 15:43:51,042 | ray_client_proxy.py:107 | [36mray::ClientAppActor.run()[39m (pid=35413, ip=127.0.0.1, actor_id=fe027926a08284f9f435a31701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x102ef2410>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/message_handler/message_handler.py", line 129, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
              ^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client.py", line 255, in maybe_call_fit
    return client.fit(fit_ins)
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 259, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/texas100/target_train.py", line 167, in fit
    torch.save(self.global_model_snapshots, f"client_{self.client_id}_global_snapshots_round_{config['round_number']}.pth")
                                                                                              ~~~~~~^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/common/record/typeddict.py", line 50, in __getitem__
    return cast(dict[K, V], self.__dict__["_data"])[item]
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
KeyError: 'round_number'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=35413, ip=127.0.0.1, actor_id=fe027926a08284f9f435a31701000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x102ef2410>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'round_number'
federated | INFO flwr 2024-11-11 15:43:51,043 | server.py:240 | aggregate_fit: received 4 results and 1 failures
federated | WARNING flwr 2024-11-11 15:43:51,112 | fedavg.py:252 | No fit_metrics_aggregation_fn provided
federated | INFO flwr 2024-11-11 15:43:51,510 | target_train.py:198 | Round 1 - Centralized evaluation accuracy: 0.22, loss: 4.427281817118327
federated | INFO flwr 2024-11-11 15:43:51,510 | server.py:131 | fit progress: (1, 4.427281817118327, {'accuracy': 0.22}, 100.33959437499288)
federated | INFO flwr 2024-11-11 15:43:51,510 | server.py:178 | configure_evaluate: strategy sampled 5 clients (out of 5)
federated | INFO flwr 2024-11-11 15:45:42,708 | server.py:192 | aggregate_evaluate: received 5 results and 0 failures
federated | WARNING flwr 2024-11-11 15:45:42,709 | fedavg.py:283 | No evaluate_metrics_aggregation_fn provided
federated | INFO flwr 2024-11-11 15:45:42,709 | server.py:112 | 
federated | INFO flwr 2024-11-11 15:45:42,709 | server.py:113 | [ROUND 2]
federated | INFO flwr 2024-11-11 15:45:42,709 | server.py:226 | configure_fit: strategy sampled 5 clients (out of 5)
federated | ERROR flwr 2024-11-11 15:48:00,576 | ray_client_proxy.py:106 | Traceback (most recent call last):
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 94, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 398, in get_client_result
    return self._fetch_future_result(cid)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 279, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
                                         ^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=35412, ip=127.0.0.1, actor_id=cc061994585e7cb4459e906001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x105343d50>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/message_handler/message_handler.py", line 129, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
              ^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client.py", line 255, in maybe_call_fit
    return client.fit(fit_ins)
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 259, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/texas100/target_train.py", line 167, in fit
    torch.save(self.global_model_snapshots, f"client_{self.client_id}_global_snapshots_round_{config['round_number']}.pth")
                                                                                              ~~~~~~^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/common/record/typeddict.py", line 50, in __getitem__
    return cast(dict[K, V], self.__dict__["_data"])[item]
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
KeyError: 'round_number'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=35412, ip=127.0.0.1, actor_id=cc061994585e7cb4459e906001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x105343d50>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'round_number'

federated | ERROR flwr 2024-11-11 15:48:00,577 | ray_client_proxy.py:107 | [36mray::ClientAppActor.run()[39m (pid=35412, ip=127.0.0.1, actor_id=cc061994585e7cb4459e906001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x105343d50>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/message_handler/message_handler.py", line 129, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
              ^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client.py", line 255, in maybe_call_fit
    return client.fit(fit_ins)
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 259, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/texas100/target_train.py", line 167, in fit
    torch.save(self.global_model_snapshots, f"client_{self.client_id}_global_snapshots_round_{config['round_number']}.pth")
                                                                                              ~~~~~~^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/common/record/typeddict.py", line 50, in __getitem__
    return cast(dict[K, V], self.__dict__["_data"])[item]
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
KeyError: 'round_number'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=35412, ip=127.0.0.1, actor_id=cc061994585e7cb4459e906001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x105343d50>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'round_number'
federated | INFO flwr 2024-11-11 15:48:00,578 | server.py:240 | aggregate_fit: received 4 results and 1 failures
federated | INFO flwr 2024-11-11 15:48:01,263 | target_train.py:198 | Round 2 - Centralized evaluation accuracy: 0.337, loss: 4.28977084350586
federated | INFO flwr 2024-11-11 15:48:01,264 | server.py:131 | fit progress: (2, 4.28977084350586, {'accuracy': 0.337}, 350.0912394169718)
federated | INFO flwr 2024-11-11 15:48:01,264 | server.py:178 | configure_evaluate: strategy sampled 5 clients (out of 5)
federated | INFO flwr 2024-11-11 15:52:40,766 | app.py:219 | Starting Flower simulation, config: num_rounds=2, no round_timeout
federated | INFO flwr 2024-11-11 15:52:42,927 | app.py:242 | Flower VCE: Ray initialized with resources: {'object_store_memory': 2147483648.0, 'GPU': 1.0, 'memory': 5097000141.0, 'node:127.0.0.1': 1.0, 'node:__internal_head__': 1.0, 'CPU': 8.0}
federated | INFO flwr 2024-11-11 15:52:42,927 | app.py:248 | Optimize your simulation with Flower VCE: https://flower.ai/docs/framework/how-to-run-simulations.html
federated | INFO flwr 2024-11-11 15:52:42,927 | app.py:271 | Flower VCE: Resources for each Virtual Client: {'num_cpus': 1, 'num_gpus': 0.2}
federated | INFO flwr 2024-11-11 15:52:42,936 | app.py:317 | Flower VCE: Creating VirtualClientEngineActorPool with 5 actors
federated | INFO flwr 2024-11-11 15:52:42,936 | server.py:92 | [INIT]
federated | INFO flwr 2024-11-11 15:52:42,936 | server.py:281 | Requesting initial parameters from one random client
federated | INFO flwr 2024-11-11 15:53:24,429 | app.py:219 | Starting Flower simulation, config: num_rounds=2, no round_timeout
federated | INFO flwr 2024-11-11 15:53:26,519 | app.py:242 | Flower VCE: Ray initialized with resources: {'memory': 5986690663.0, 'GPU': 1.0, 'CPU': 8.0, 'object_store_memory': 2147483648.0, 'node:__internal_head__': 1.0, 'node:127.0.0.1': 1.0}
federated | INFO flwr 2024-11-11 15:53:26,519 | app.py:248 | Optimize your simulation with Flower VCE: https://flower.ai/docs/framework/how-to-run-simulations.html
federated | INFO flwr 2024-11-11 15:53:26,519 | app.py:271 | Flower VCE: Resources for each Virtual Client: {'num_cpus': 1, 'num_gpus': 0.2}
federated | INFO flwr 2024-11-11 15:53:26,527 | app.py:317 | Flower VCE: Creating VirtualClientEngineActorPool with 5 actors
federated | INFO flwr 2024-11-11 15:53:26,527 | server.py:92 | [INIT]
federated | INFO flwr 2024-11-11 15:53:26,527 | server.py:281 | Requesting initial parameters from one random client
federated | INFO flwr 2024-11-11 15:53:44,474 | server.py:288 | Received initial parameters from one random client
federated | INFO flwr 2024-11-11 15:53:44,475 | server.py:94 | Starting evaluation of initial global parameters
federated | INFO flwr 2024-11-11 15:53:45,074 | target_train.py:198 | Round 0 - Centralized evaluation accuracy: 0.0033333333333333335, loss: 4.605226389567057
federated | INFO flwr 2024-11-11 15:53:45,075 | server.py:97 | initial parameters (loss, other metrics): 4.605226389567057, {'accuracy': 0.0033333333333333335}
federated | INFO flwr 2024-11-11 15:53:45,075 | server.py:112 | 
federated | INFO flwr 2024-11-11 15:53:45,075 | server.py:113 | [ROUND 1]
federated | INFO flwr 2024-11-11 15:53:45,075 | server.py:226 | configure_fit: strategy sampled 5 clients (out of 5)
federated | ERROR flwr 2024-11-11 15:55:15,326 | ray_client_proxy.py:106 | Traceback (most recent call last):
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 94, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 398, in get_client_result
    return self._fetch_future_result(cid)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 279, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
                                         ^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=35768, ip=127.0.0.1, actor_id=0b3c0f5f4ac9ab9e225a1cd801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x10510c490>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/message_handler/message_handler.py", line 129, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
              ^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client.py", line 255, in maybe_call_fit
    return client.fit(fit_ins)
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 259, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/texas100/target_train.py", line 167, in fit
    torch.save(self.global_model_snapshots, f"client_{self.client_id}_global_snapshots_round_{config['server_round']}.pth")
                                                                                              ~~~~~~^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/common/record/typeddict.py", line 50, in __getitem__
    return cast(dict[K, V], self.__dict__["_data"])[item]
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
KeyError: 'server_round'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=35768, ip=127.0.0.1, actor_id=0b3c0f5f4ac9ab9e225a1cd801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x10510c490>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'server_round'

federated | ERROR flwr 2024-11-11 15:55:15,327 | ray_client_proxy.py:107 | [36mray::ClientAppActor.run()[39m (pid=35768, ip=127.0.0.1, actor_id=0b3c0f5f4ac9ab9e225a1cd801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x10510c490>)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/message_handler/message_handler.py", line 129, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
              ^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/client.py", line 255, in maybe_call_fit
    return client.fit(fit_ins)
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/client/numpy_client.py", line 259, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/texas100/target_train.py", line 167, in fit
    torch.save(self.global_model_snapshots, f"client_{self.client_id}_global_snapshots_round_{config['server_round']}.pth")
                                                                                              ~~~~~~^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/common/record/typeddict.py", line 50, in __getitem__
    return cast(dict[K, V], self.__dict__["_data"])[item]
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
KeyError: 'server_round'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=35768, ip=127.0.0.1, actor_id=0b3c0f5f4ac9ab9e225a1cd801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x10510c490>)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'server_round'
federated | INFO flwr 2024-11-11 15:55:22,015 | server.py:240 | aggregate_fit: received 4 results and 1 failures
federated | WARNING flwr 2024-11-11 15:55:22,069 | fedavg.py:252 | No fit_metrics_aggregation_fn provided
federated | INFO flwr 2024-11-11 15:55:22,397 | target_train.py:198 | Round 1 - Centralized evaluation accuracy: 0.05, loss: 4.571363004048665
federated | INFO flwr 2024-11-11 15:55:22,567 | server.py:131 | fit progress: (1, 4.571363004048665, {'accuracy': 0.05}, 97.49264262500219)
federated | INFO flwr 2024-11-11 15:55:22,569 | server.py:178 | configure_evaluate: strategy sampled 5 clients (out of 5)
federated | INFO flwr 2024-11-11 15:55:42,121 | app.py:219 | Starting Flower simulation, config: num_rounds=2, no round_timeout
federated | INFO flwr 2024-11-11 15:55:44,280 | app.py:242 | Flower VCE: Ray initialized with resources: {'node:__internal_head__': 1.0, 'memory': 6952512717.0, 'GPU': 1.0, 'node:127.0.0.1': 1.0, 'object_store_memory': 2147483648.0, 'CPU': 8.0}
federated | INFO flwr 2024-11-11 15:55:44,280 | app.py:248 | Optimize your simulation with Flower VCE: https://flower.ai/docs/framework/how-to-run-simulations.html
federated | INFO flwr 2024-11-11 15:55:44,280 | app.py:271 | Flower VCE: Resources for each Virtual Client: {'num_cpus': 1, 'num_gpus': 0.2}
federated | INFO flwr 2024-11-11 15:55:44,288 | app.py:317 | Flower VCE: Creating VirtualClientEngineActorPool with 5 actors
federated | INFO flwr 2024-11-11 15:55:44,288 | server.py:92 | [INIT]
federated | INFO flwr 2024-11-11 15:55:44,288 | server.py:281 | Requesting initial parameters from one random client
federated | INFO flwr 2024-11-11 15:56:02,676 | server.py:288 | Received initial parameters from one random client
federated | INFO flwr 2024-11-11 15:56:02,676 | server.py:94 | Starting evaluation of initial global parameters
federated | INFO flwr 2024-11-11 15:56:03,066 | target_train.py:198 | Round 0 - Centralized evaluation accuracy: 0.0, loss: 4.605151189168295
federated | INFO flwr 2024-11-11 15:56:03,067 | server.py:97 | initial parameters (loss, other metrics): 4.605151189168295, {'accuracy': 0.0}
federated | INFO flwr 2024-11-11 15:56:03,067 | server.py:112 | 
federated | INFO flwr 2024-11-11 15:56:03,067 | server.py:113 | [ROUND 1]
federated | ERROR flwr 2024-11-11 15:56:03,067 | app.py:344 | FedAvg.configure_fit() takes 4 positional arguments but 5 were given
federated | ERROR flwr 2024-11-11 15:56:03,069 | app.py:345 | Traceback (most recent call last):
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/simulation/app.py", line 339, in start_simulation
    hist = run_fl(
           ^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/server/server.py", line 492, in run_fl
    hist, elapsed_time = server.fit(
                         ^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/server/server.py", line 115, in fit
    res_fit = self.fit_round(
              ^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/.venv/lib/python3.11/site-packages/flwr/server/server.py", line 217, in fit_round
    client_instructions = self.strategy.configure_fit(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kmcnulty/Documents/SeniorProject/MembershipInference/texas100/target_train.py", line 217, in configure_fit
    return super().configure_fit(server_round, parameters, client_manager, config)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: FedAvg.configure_fit() takes 4 positional arguments but 5 were given

federated | ERROR flwr 2024-11-11 15:56:03,069 | app.py:346 | Your simulation crashed :(. This could be because of several reasons. The most common are: 
	 > Sometimes, issues in the simulation code itself can cause crashes. It's always a good idea to double-check your code for any potential bugs or inconsistencies that might be contributing to the problem. For example: 
		 - You might be using a class attribute in your clients that hasn't been defined.
		 - There could be an incorrect method call to a 3rd party library (e.g., PyTorch).
		 - The return types of methods in your clients/strategies might be incorrect.
	 > Your system couldn't fit a single VirtualClient: try lowering `client_resources`.
	 > All the actors in your pool crashed. This could be because: 
		 - You clients hit an out-of-memory (OOM) error and actors couldn't recover from it. Try launching your simulation with more generous `client_resources` setting (i.e. it seems {'num_cpus': 1, 'num_gpus': 0.2} is not enough for your run). Use fewer concurrent actors. 
		 - You were running a multi-node simulation and all worker nodes disconnected. The head node might still be alive but cannot accommodate any actor with resources: {'num_cpus': 1, 'num_gpus': 0.2}.
Take a look at the Flower simulation examples for guidance <https://flower.ai/docs/framework/how-to-run-simulations.html>.
federated | INFO flwr 2024-11-11 15:59:22,794 | app.py:219 | Starting Flower simulation, config: num_rounds=2, no round_timeout
federated | INFO flwr 2024-11-11 15:59:24,905 | app.py:242 | Flower VCE: Ray initialized with resources: {'node:127.0.0.1': 1.0, 'CPU': 8.0, 'object_store_memory': 2147483648.0, 'node:__internal_head__': 1.0, 'memory': 5484470272.0, 'GPU': 1.0}
federated | INFO flwr 2024-11-11 15:59:24,905 | app.py:248 | Optimize your simulation with Flower VCE: https://flower.ai/docs/framework/how-to-run-simulations.html
federated | INFO flwr 2024-11-11 15:59:24,905 | app.py:271 | Flower VCE: Resources for each Virtual Client: {'num_cpus': 1, 'num_gpus': 0.2}
federated | INFO flwr 2024-11-11 15:59:24,913 | app.py:317 | Flower VCE: Creating VirtualClientEngineActorPool with 5 actors
federated | INFO flwr 2024-11-11 15:59:24,913 | server.py:92 | [INIT]
federated | INFO flwr 2024-11-11 15:59:24,913 | server.py:281 | Requesting initial parameters from one random client
federated | INFO flwr 2024-11-11 15:59:43,361 | server.py:288 | Received initial parameters from one random client
federated | INFO flwr 2024-11-11 15:59:43,364 | server.py:94 | Starting evaluation of initial global parameters
federated | INFO flwr 2024-11-11 15:59:43,751 | target_train.py:198 | Round 0 - Centralized evaluation accuracy: 0.0033333333333333335, loss: 4.605165990193685
federated | INFO flwr 2024-11-11 15:59:43,751 | server.py:97 | initial parameters (loss, other metrics): 4.605165990193685, {'accuracy': 0.0033333333333333335}
federated | INFO flwr 2024-11-11 15:59:43,751 | server.py:112 | 
federated | INFO flwr 2024-11-11 15:59:43,751 | server.py:113 | [ROUND 1]
federated | INFO flwr 2024-11-11 15:59:43,751 | server.py:226 | configure_fit: strategy sampled 5 clients (out of 5)
federated | INFO flwr 2024-11-11 16:01:17,844 | server.py:240 | aggregate_fit: received 5 results and 0 failures
federated | WARNING flwr 2024-11-11 16:01:17,908 | fedavg.py:252 | No fit_metrics_aggregation_fn provided
federated | INFO flwr 2024-11-11 16:01:18,132 | target_train.py:198 | Round 1 - Centralized evaluation accuracy: 0.02666666666666667, loss: 4.595189743041992
federated | INFO flwr 2024-11-11 16:01:18,134 | server.py:131 | fit progress: (1, 4.595189743041992, {'accuracy': 0.02666666666666667}, 94.38261741597671)
federated | INFO flwr 2024-11-11 16:01:18,135 | server.py:178 | configure_evaluate: strategy sampled 5 clients (out of 5)
federated | INFO flwr 2024-11-11 16:02:09,719 | app.py:219 | Starting Flower simulation, config: num_rounds=10, no round_timeout
federated | INFO flwr 2024-11-11 16:02:12,150 | app.py:242 | Flower VCE: Ray initialized with resources: {'object_store_memory': 2147483648.0, 'node:127.0.0.1': 1.0, 'CPU': 8.0, 'node:__internal_head__': 1.0, 'GPU': 1.0, 'memory': 6452518912.0}
federated | INFO flwr 2024-11-11 16:02:12,150 | app.py:248 | Optimize your simulation with Flower VCE: https://flower.ai/docs/framework/how-to-run-simulations.html
federated | INFO flwr 2024-11-11 16:02:12,150 | app.py:271 | Flower VCE: Resources for each Virtual Client: {'num_cpus': 1, 'num_gpus': 0.2}
federated | INFO flwr 2024-11-11 16:02:12,158 | app.py:317 | Flower VCE: Creating VirtualClientEngineActorPool with 5 actors
federated | INFO flwr 2024-11-11 16:02:12,158 | server.py:92 | [INIT]
federated | INFO flwr 2024-11-11 16:02:12,158 | server.py:281 | Requesting initial parameters from one random client
federated | INFO flwr 2024-11-11 16:02:26,621 | app.py:219 | Starting Flower simulation, config: num_rounds=10, no round_timeout
federated | INFO flwr 2024-11-11 16:02:28,703 | app.py:242 | Flower VCE: Ray initialized with resources: {'node:__internal_head__': 1.0, 'GPU': 1.0, 'memory': 6418309120.0, 'node:127.0.0.1': 1.0, 'object_store_memory': 2147483648.0, 'CPU': 8.0}
federated | INFO flwr 2024-11-11 16:02:28,704 | app.py:248 | Optimize your simulation with Flower VCE: https://flower.ai/docs/framework/how-to-run-simulations.html
federated | INFO flwr 2024-11-11 16:02:28,704 | app.py:271 | Flower VCE: Resources for each Virtual Client: {'num_cpus': 1, 'num_gpus': 0.2}
federated | INFO flwr 2024-11-11 16:02:28,711 | app.py:317 | Flower VCE: Creating VirtualClientEngineActorPool with 5 actors
federated | INFO flwr 2024-11-11 16:02:28,711 | server.py:92 | [INIT]
federated | INFO flwr 2024-11-11 16:02:28,711 | server.py:281 | Requesting initial parameters from one random client
federated | INFO flwr 2024-11-11 16:02:50,502 | server.py:288 | Received initial parameters from one random client
federated | INFO flwr 2024-11-11 16:02:50,503 | server.py:94 | Starting evaluation of initial global parameters
federated | INFO flwr 2024-11-11 16:02:54,104 | target_train.py:198 | Round 0 - Centralized evaluation accuracy: 0.006333333333333333, loss: 4.605220440928141
federated | INFO flwr 2024-11-11 16:02:54,106 | server.py:97 | initial parameters (loss, other metrics): 4.605220440928141, {'accuracy': 0.006333333333333333}
federated | INFO flwr 2024-11-11 16:02:54,106 | server.py:112 | 
federated | INFO flwr 2024-11-11 16:02:54,106 | server.py:113 | [ROUND 1]
federated | INFO flwr 2024-11-11 16:02:54,106 | server.py:226 | configure_fit: strategy sampled 5 clients (out of 5)
federated | INFO flwr 2024-11-11 16:35:35,148 | server.py:240 | aggregate_fit: received 5 results and 0 failures
federated | WARNING flwr 2024-11-11 16:35:35,247 | fedavg.py:252 | No fit_metrics_aggregation_fn provided
federated | INFO flwr 2024-11-11 16:35:39,055 | target_train.py:198 | Round 1 - Centralized evaluation accuracy: 0.26003333333333334, loss: 4.470098215484619
federated | INFO flwr 2024-11-11 16:35:39,057 | server.py:131 | fit progress: (1, 4.470098215484619, {'accuracy': 0.26003333333333334}, 1938.7307769589825)
federated | INFO flwr 2024-11-11 16:35:39,057 | server.py:178 | configure_evaluate: strategy sampled 5 clients (out of 5)
federated | INFO flwr 2024-11-11 16:37:09,122 | server.py:192 | aggregate_evaluate: received 5 results and 0 failures
federated | WARNING flwr 2024-11-11 16:37:09,123 | fedavg.py:283 | No evaluate_metrics_aggregation_fn provided
federated | INFO flwr 2024-11-11 16:37:09,123 | server.py:112 | 
federated | INFO flwr 2024-11-11 16:37:09,123 | server.py:113 | [ROUND 2]
federated | INFO flwr 2024-11-11 16:37:09,123 | server.py:226 | configure_fit: strategy sampled 5 clients (out of 5)
federated | INFO flwr 2024-11-11 17:09:32,285 | server.py:240 | aggregate_fit: received 5 results and 0 failures
federated | INFO flwr 2024-11-11 17:09:36,482 | target_train.py:198 | Round 2 - Centralized evaluation accuracy: 0.5836666666666667, loss: 4.0385602193196615
federated | INFO flwr 2024-11-11 17:09:36,483 | server.py:131 | fit progress: (2, 4.0385602193196615, {'accuracy': 0.5836666666666667}, 3976.1228946249466)
federated | INFO flwr 2024-11-11 17:09:36,484 | server.py:178 | configure_evaluate: strategy sampled 5 clients (out of 5)
federated | INFO flwr 2024-11-11 17:11:01,790 | server.py:192 | aggregate_evaluate: received 5 results and 0 failures
federated | INFO flwr 2024-11-11 17:11:01,791 | server.py:112 | 
federated | INFO flwr 2024-11-11 17:11:01,791 | server.py:113 | [ROUND 3]
federated | INFO flwr 2024-11-11 17:11:01,791 | server.py:226 | configure_fit: strategy sampled 5 clients (out of 5)
federated | INFO flwr 2024-11-11 17:43:41,677 | server.py:240 | aggregate_fit: received 5 results and 0 failures
federated | INFO flwr 2024-11-11 17:43:45,852 | target_train.py:198 | Round 3 - Centralized evaluation accuracy: 0.6005333333333334, loss: 4.021826607767741
federated | INFO flwr 2024-11-11 17:43:45,854 | server.py:131 | fit progress: (3, 4.021826607767741, {'accuracy': 0.6005333333333334}, 6025.468072958989)
federated | INFO flwr 2024-11-11 17:43:45,854 | server.py:178 | configure_evaluate: strategy sampled 5 clients (out of 5)
federated | INFO flwr 2024-11-11 17:45:17,915 | server.py:192 | aggregate_evaluate: received 5 results and 0 failures
federated | INFO flwr 2024-11-11 17:45:17,916 | server.py:112 | 
federated | INFO flwr 2024-11-11 17:45:17,916 | server.py:113 | [ROUND 4]
federated | INFO flwr 2024-11-11 17:45:17,916 | server.py:226 | configure_fit: strategy sampled 5 clients (out of 5)
federated | INFO flwr 2024-11-11 18:20:45,722 | server.py:240 | aggregate_fit: received 5 results and 0 failures
federated | INFO flwr 2024-11-11 18:20:50,158 | target_train.py:198 | Round 4 - Centralized evaluation accuracy: 0.6013666666666667, loss: 4.020782340240478
federated | INFO flwr 2024-11-11 18:20:50,159 | server.py:131 | fit progress: (4, 4.020782340240478, {'accuracy': 0.6013666666666667}, 8249.782870125026)
federated | INFO flwr 2024-11-11 18:20:50,160 | server.py:178 | configure_evaluate: strategy sampled 5 clients (out of 5)
federated | INFO flwr 2024-11-11 18:23:18,078 | server.py:192 | aggregate_evaluate: received 5 results and 0 failures
federated | INFO flwr 2024-11-11 18:23:18,080 | server.py:112 | 
federated | INFO flwr 2024-11-11 18:23:18,080 | server.py:113 | [ROUND 5]
federated | INFO flwr 2024-11-11 18:23:18,081 | server.py:226 | configure_fit: strategy sampled 5 clients (out of 5)
federated | INFO flwr 2024-11-11 19:02:23,768 | server.py:240 | aggregate_fit: received 5 results and 0 failures
federated | INFO flwr 2024-11-11 19:02:28,419 | target_train.py:198 | Round 5 - Centralized evaluation accuracy: 0.6014666666666667, loss: 4.020674761454265
federated | INFO flwr 2024-11-11 19:02:28,420 | server.py:131 | fit progress: (5, 4.020674761454265, {'accuracy': 0.6014666666666667}, 10748.03307616699)
federated | INFO flwr 2024-11-11 19:02:28,420 | server.py:178 | configure_evaluate: strategy sampled 5 clients (out of 5)
federated | INFO flwr 2024-11-11 19:04:10,625 | server.py:192 | aggregate_evaluate: received 5 results and 0 failures
federated | INFO flwr 2024-11-11 19:04:10,629 | server.py:112 | 
federated | INFO flwr 2024-11-11 19:04:10,629 | server.py:113 | [ROUND 6]
federated | INFO flwr 2024-11-11 19:04:10,629 | server.py:226 | configure_fit: strategy sampled 5 clients (out of 5)
federated | INFO flwr 2024-11-11 19:42:54,597 | server.py:240 | aggregate_fit: received 5 results and 0 failures
federated | INFO flwr 2024-11-11 19:42:59,139 | target_train.py:198 | Round 6 - Centralized evaluation accuracy: 0.6011666666666666, loss: 4.021105730056763
federated | INFO flwr 2024-11-11 19:42:59,139 | server.py:131 | fit progress: (6, 4.021105730056763, {'accuracy': 0.6011666666666666}, 13178.72203079192)
federated | INFO flwr 2024-11-11 19:42:59,139 | server.py:178 | configure_evaluate: strategy sampled 5 clients (out of 5)
federated | INFO flwr 2024-11-11 19:44:41,460 | server.py:192 | aggregate_evaluate: received 5 results and 0 failures
federated | INFO flwr 2024-11-11 19:44:41,463 | server.py:112 | 
federated | INFO flwr 2024-11-11 19:44:41,463 | server.py:113 | [ROUND 7]
federated | INFO flwr 2024-11-11 19:44:41,463 | server.py:226 | configure_fit: strategy sampled 5 clients (out of 5)
federated | INFO flwr 2024-11-11 20:22:59,017 | server.py:240 | aggregate_fit: received 5 results and 0 failures
federated | INFO flwr 2024-11-11 20:23:03,444 | target_train.py:198 | Round 7 - Centralized evaluation accuracy: 0.599, loss: 4.023191471862793
federated | INFO flwr 2024-11-11 20:23:03,444 | server.py:131 | fit progress: (7, 4.023191471862793, {'accuracy': 0.599}, 15582.975094542024)
federated | INFO flwr 2024-11-11 20:23:03,444 | server.py:178 | configure_evaluate: strategy sampled 5 clients (out of 5)
federated | INFO flwr 2024-11-11 20:24:40,133 | server.py:192 | aggregate_evaluate: received 5 results and 0 failures
federated | INFO flwr 2024-11-11 20:24:40,134 | server.py:112 | 
federated | INFO flwr 2024-11-11 20:24:40,134 | server.py:113 | [ROUND 8]
federated | INFO flwr 2024-11-11 20:24:40,135 | server.py:226 | configure_fit: strategy sampled 5 clients (out of 5)
federated | INFO flwr 2024-11-11 21:03:07,069 | server.py:240 | aggregate_fit: received 5 results and 0 failures
federated | INFO flwr 2024-11-11 21:03:11,401 | target_train.py:198 | Round 8 - Centralized evaluation accuracy: 0.5982, loss: 4.024043323008219
federated | INFO flwr 2024-11-11 21:03:11,402 | server.py:131 | fit progress: (8, 4.024043323008219, {'accuracy': 0.5982}, 17990.936694209)
federated | INFO flwr 2024-11-11 21:03:11,403 | server.py:178 | configure_evaluate: strategy sampled 5 clients (out of 5)
federated | INFO flwr 2024-11-11 21:04:49,043 | server.py:192 | aggregate_evaluate: received 5 results and 0 failures
federated | INFO flwr 2024-11-11 21:04:49,045 | server.py:112 | 
federated | INFO flwr 2024-11-11 21:04:49,045 | server.py:113 | [ROUND 9]
federated | INFO flwr 2024-11-11 21:04:49,045 | server.py:226 | configure_fit: strategy sampled 5 clients (out of 5)
federated | INFO flwr 2024-11-11 22:38:36,219 | server.py:240 | aggregate_fit: received 5 results and 0 failures
federated | INFO flwr 2024-11-11 22:38:40,903 | target_train.py:198 | Round 9 - Centralized evaluation accuracy: 0.5988666666666667, loss: 4.023265685780843
federated | INFO flwr 2024-11-11 22:38:40,904 | server.py:131 | fit progress: (9, 4.023265685780843, {'accuracy': 0.5988666666666667}, 23720.410916124936)
federated | INFO flwr 2024-11-11 22:38:40,904 | server.py:178 | configure_evaluate: strategy sampled 5 clients (out of 5)
federated | INFO flwr 2024-11-11 22:40:17,477 | server.py:192 | aggregate_evaluate: received 5 results and 0 failures
federated | INFO flwr 2024-11-11 22:40:17,478 | server.py:112 | 
federated | INFO flwr 2024-11-11 22:40:17,478 | server.py:113 | [ROUND 10]
federated | INFO flwr 2024-11-11 22:40:17,478 | server.py:226 | configure_fit: strategy sampled 5 clients (out of 5)
federated | INFO flwr 2024-11-12 00:00:57,164 | server.py:240 | aggregate_fit: received 5 results and 0 failures
federated | INFO flwr 2024-11-12 00:01:02,007 | target_train.py:198 | Round 10 - Centralized evaluation accuracy: 0.5978333333333333, loss: 4.024308870697022
federated | INFO flwr 2024-11-12 00:01:02,008 | server.py:131 | fit progress: (10, 4.024308870697022, {'accuracy': 0.5978333333333333}, 28661.460026292014)
federated | INFO flwr 2024-11-12 00:01:02,008 | server.py:178 | configure_evaluate: strategy sampled 5 clients (out of 5)
federated | INFO flwr 2024-11-12 00:02:55,344 | server.py:192 | aggregate_evaluate: received 5 results and 0 failures
federated | INFO flwr 2024-11-12 00:02:55,360 | server.py:496 | 
federated | INFO flwr 2024-11-12 00:02:55,360 | server.py:497 | [SUMMARY]
federated | INFO flwr 2024-11-12 00:02:55,360 | server.py:498 | Run finished 10 round(s) in 28774.80s
federated | INFO flwr 2024-11-12 00:02:55,361 | server.py:500 | 	History (loss, distributed):
federated | INFO flwr 2024-11-12 00:02:55,361 | server.py:500 | 		round 1: 0.29186666666666666
federated | INFO flwr 2024-11-12 00:02:55,361 | server.py:500 | 		round 2: 0.8115
federated | INFO flwr 2024-11-12 00:02:55,361 | server.py:500 | 		round 3: 0.8673
federated | INFO flwr 2024-11-12 00:02:55,361 | server.py:500 | 		round 4: 0.8775
federated | INFO flwr 2024-11-12 00:02:55,361 | server.py:500 | 		round 5: 0.881
federated | INFO flwr 2024-11-12 00:02:55,361 | server.py:500 | 		round 6: 0.8827
federated | INFO flwr 2024-11-12 00:02:55,361 | server.py:500 | 		round 7: 0.8834
federated | INFO flwr 2024-11-12 00:02:55,361 | server.py:500 | 		round 8: 0.8839
federated | INFO flwr 2024-11-12 00:02:55,361 | server.py:500 | 		round 9: 0.8841333333333333
federated | INFO flwr 2024-11-12 00:02:55,361 | server.py:500 | 		round 10: 0.8844
federated | INFO flwr 2024-11-12 00:02:55,361 | server.py:500 | 	History (loss, centralized):
federated | INFO flwr 2024-11-12 00:02:55,361 | server.py:500 | 		round 0: 4.605220440928141
federated | INFO flwr 2024-11-12 00:02:55,361 | server.py:500 | 		round 1: 4.470098215484619
federated | INFO flwr 2024-11-12 00:02:55,361 | server.py:500 | 		round 2: 4.0385602193196615
federated | INFO flwr 2024-11-12 00:02:55,361 | server.py:500 | 		round 3: 4.021826607767741
federated | INFO flwr 2024-11-12 00:02:55,361 | server.py:500 | 		round 4: 4.020782340240478
federated | INFO flwr 2024-11-12 00:02:55,361 | server.py:500 | 		round 5: 4.020674761454265
federated | INFO flwr 2024-11-12 00:02:55,362 | server.py:500 | 		round 6: 4.021105730056763
federated | INFO flwr 2024-11-12 00:02:55,362 | server.py:500 | 		round 7: 4.023191471862793
federated | INFO flwr 2024-11-12 00:02:55,362 | server.py:500 | 		round 8: 4.024043323008219
federated | INFO flwr 2024-11-12 00:02:55,362 | server.py:500 | 		round 9: 4.023265685780843
federated | INFO flwr 2024-11-12 00:02:55,362 | server.py:500 | 		round 10: 4.024308870697022
federated | INFO flwr 2024-11-12 00:02:55,362 | server.py:500 | 	History (metrics, centralized):
federated | INFO flwr 2024-11-12 00:02:55,362 | server.py:500 | 	{'accuracy': [(0, 0.006333333333333333),
federated | INFO flwr 2024-11-12 00:02:55,362 | server.py:500 | 	              (1, 0.26003333333333334),
federated | INFO flwr 2024-11-12 00:02:55,362 | server.py:500 | 	              (2, 0.5836666666666667),
federated | INFO flwr 2024-11-12 00:02:55,362 | server.py:500 | 	              (3, 0.6005333333333334),
federated | INFO flwr 2024-11-12 00:02:55,362 | server.py:500 | 	              (4, 0.6013666666666667),
federated | INFO flwr 2024-11-12 00:02:55,362 | server.py:500 | 	              (5, 0.6014666666666667),
federated | INFO flwr 2024-11-12 00:02:55,362 | server.py:500 | 	              (6, 0.6011666666666666),
federated | INFO flwr 2024-11-12 00:02:55,362 | server.py:500 | 	              (7, 0.599),
federated | INFO flwr 2024-11-12 00:02:55,362 | server.py:500 | 	              (8, 0.5982),
federated | INFO flwr 2024-11-12 00:02:55,363 | server.py:500 | 	              (9, 0.5988666666666667),
federated | INFO flwr 2024-11-12 00:02:55,363 | server.py:500 | 	              (10, 0.5978333333333333)]}
federated | INFO flwr 2024-11-12 00:02:55,363 | server.py:501 | 
